{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to FastAPI-Template","text":"<p>A Configurable template for a FastAPI application, with Authentication and User integration plus a CLI to manage the project.</p> <p>It uses FastAPI, SQLAlchemy, Pydantic, Typer, and a few other libraries to provide a ready-to-use boilerplate for a FastAPI project, with Async database access.</p> <p>Getting Started</p> <p>New to this template? Check out the Quick Start Guide to get up and running in under 5 minutes!</p> <p>Breaking Changes</p> <p>If you are upgrading from a previous version of this template, please read the Breaking Changes page for details of any breaking changes that may affect your project.</p> <p>Version Refactor</p> <p>This template versioning has been refactored to start from Verison 0.4.0 . The original template was written for my own use and probably promoted to V 1.0.0 before it should have been, and there have been many updates and fixes since then.</p> <p>The old releases (up to v1.5.0) can still be found in the GitHub releases section, but I suspect I will delete them and merge into a single release at some point, especially if/when the template is promoted to a 1.0.0 release.</p>"},{"location":"#features","title":"Features","text":"<p>This template is a ready-to-use boilerplate for a FastAPI project. It has the following advantages to starting your own from scratch :</p> <ul> <li>Baked-in User database and management. Routes are provided to add/edit/delete   or ban (and unban) Users.</li> <li>Postgresql Integration, using SQLAlchemy ORM, no need for raw SQL queries   (unless you want to!). All database usage is Asynchronous.   Alembic is used to   control database migrations.</li> <li>Register and Login routes provided, both of which return a JWT token to be   used in all future requests. JWT Token expires 120 minutes after issue.</li> <li>JWT-based security as a Bearer Token to control access to all your routes.</li> <li>Password Recovery system with secure token-based reset flow. Users can   request a password reset via email, receiving a time-limited (30 minute)   token to securely reset their password. Features built-in HTML forms for   standalone use, or optional <code>FRONTEND_URL</code> configuration to redirect to   custom frontends. Supports both JSON API and form-based submissions. The   system protects against email enumeration attacks and includes URL encoding   and token validation for security.</li> <li>API Keys are fully implemented and can be used by registered users instead   of the JWT. These will not expire at present though adding expiry is a   future plan. API keys are passed using the <code>X-API-Key</code> header.</li> <li>A <code>Refresh Token</code> with 30 day expiry is sent at time of register or login   (never again). This will enable easy re-authentication when the JWT expires   without needing to send username or password again, and should be done   automatically by the Front-End.</li> <li>Full test coverage using <code>Pytest</code>.</li> <li>A clean layout to help structure your project.</li> <li>An optional Admin site to manage users and API keys. This uses the   <code>sqladmin</code> package to give you an easy way to manage your database.</li> <li>Category-based logging using loguru   with configurable log levels, rotation, retention, and compression. Control   what gets logged via <code>LOG_CATEGORIES</code> (requests, auth, database, errors,   etc.).</li> <li>Prometheus metrics for production observability. Optional metrics   collection tracks HTTP performance (requests, latency, in-flight), business   metrics (auth failures, API key usage, login attempts), and custom   application metrics. Exposed via <code>/metrics</code> endpoint when enabled.</li> <li>A command-line admin tool. This allows to configure the project metadata   very easily, add users (and make admin), and run a development server. This   can easily be modified to add your own functionality (for example bulk add   data) since it is based on the excellent   Typer library.</li> <li>Built-in pagination support for user listing and search endpoints, using   <code>fastapi-pagination</code>.</li> <li>Easily batch-add random test users to the database for testing/development   purposes using the CLI or seed the database with pre-set users from a CSV   file.</li> <li>Database and Secrets are automatically read from Environment variables or a   <code>.env</code> file if that is provided. The CLI can generate and set the JWT Secret   and Admin pages encryption keys.</li> <li>User email is validated for correct format on creation (however no checks are   performed to ensure the email or domain actually exists).</li> <li>Control permitted CORS Origin through Environment variables.</li> <li>Manager class set up to send emails to users, and by default an email is sent   when new users register. The content is set by a template (currently a basic   placeholder). This email has a link for the user to confirm their email   address - until this is done, the user cannot user the API.</li> <li>A lightweight <code>/heartbeat</code> endpoint for uptime/health checks.</li> <li>Docker and Compose file set up to develop and test this API using Docker</li> </ul> <p>The template Requires Python 3.10+</p>"},{"location":"#versioning","title":"Versioning","text":"<p>Beta Software!</p> <p>This template is still in active development and may not yet ready for full production use. However, I am currently using it to develop my own projects, which include some production API's without issues. I will update the template as I find bugs or add new features. I will also be adding more documentation as I go.</p> <p>This project uses Semantic Versioning 2.0.0</p> <p>Given a version number <code>MAJOR</code>.<code>MINOR</code>.<code>PATCH</code>, increment the:</p> <ol> <li><code>MAJOR</code> version when you make incompatible API changes</li> <li><code>MINOR</code> version when you add functionality in a backward compatible manner</li> <li><code>PATCH</code> version when you make backward compatible bug fixes</li> </ol> <p>Additional labels for pre-release and build metadata are available as extensions to the MAJOR.MINOR.PATCH format.</p>"},{"location":"#github-discussions","title":"GitHub Discussions","text":"<p>Discussions are enabled on this repository, so if you have any problems, questions, suggestions or just want to chat about this template, please feel free to start a discussion.</p>"},{"location":"#follow-the-repository","title":"Follow the Repository","text":"<p>If you use this code in your own projects, I'd recommend at least to 'star' or follow the repository on GitHub. In this way you would be informed of any updates, bug fixes or new functionality </p>"},{"location":"#accreditation","title":"Accreditation","text":"<p>This template is free to use but I would request some accreditation. If you do use it in one of your applications, or even some of the unique code from the template, or you learn something from it, please put a small note in your readme or blog post/whatever stating that you used this Template or code therein, with a link back to this repository. Thank You \ud83d\ude0a</p> <p>For those who let me know they are using this Template, I'll add links back to your project in this documentation.</p> <p>If this template saves you time/effort/money, or you just wish to show your appreciation for my work, why not Buy me a Coffee! \ud83d\ude03</p>"},{"location":"#funding-link","title":"Funding Link","text":"<p>The template does include a <code>.github/FUNDING.yml</code> file which contains a link to some sponsor pages. You can edit or delete this as you will or replace with your own details. If you really appreciate the Template, feel free to leave my details there in addition to your own, though this is entirely optional \ud83d\ude0a</p> <p>The funding file allows your GitHub visitors to sponsor or tip you as a thanks for your work.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#changelog","title":"Changelog","text":"<p>This is an auto-generated log of all the changes that have been made to the project since the first release, with the latest changes at the top.</p> <p>This project adheres to Semantic Versioning.</p>"},{"location":"changelog/#unreleased","title":"Unreleased","text":"<p>These are the changes that have been merged to the repository since the last release.</p> <p>Everything in this section will be included in the next official release.</p> <p>Closed Issues</p> <ul> <li>Metrics and Observability endpoints (#114) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Feat: add optional Prometheus metrics endpoint (#799) by seapagan</li> <li>Feat: include query parameters in request logs (#797) by seapagan</li> <li>Paginate users list endpoint (#796) by seapagan</li> <li>Add heartbeat endpoint and tests (#795) by seapagan</li> <li>Feat(logging): implement comprehensive logging infrastructure with loguru (#794) by seapagan</li> <li>Prevent last admin from deleting themselves (#792) by seapagan</li> <li>Extend JWT format validation to verify and refresh endpoints (#790) by seapagan</li> <li>Add password recovery feature (#788) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Test: add unit tests for metrics and OpenAPI modules (#801) by seapagan</li> </ul> <p>Security</p> <ul> <li>Fix(security): validate credentials and prevent weak defaults (#793) by seapagan</li> </ul> <p>Bug Fixes</p> <ul> <li>Fix CLI crash when database not initialized (#791) by seapagan</li> </ul> <p>Refactoring</p> <ul> <li>Fix deprecated HTTP_422_UNPROCESSABLE_ENTITY status code (#798) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Docs: comprehensive documentation improvements (#800) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Update postgres Docker tag to v18 (#789) by renovate[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v080-december-25-2025","title":"v0.8.0 (December 25, 2025)","text":"<p>Closed Issues</p> <ul> <li>Can commit only once with session per route (otherwise sqlalchemy.exc.InvalidRequestError) (#768) by seapagan</li> </ul> <p>Breaking Changes</p> <ul> <li>Feat: implement HMAC-SHA256 for API key hashing (#769) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Update docker to use Python 3.14 and Postgres 18.1. fix resulting issues (#786) by seapagan</li> <li>Migrate to <code>prek</code> from <code>pre-commit</code> (#783) by seapagan</li> <li>Update for Python 3.14 compatibility and drop support for Python 3.9 (#782) by seapagan</li> <li>December update and refresh (#781) by seapagan</li> <li>Feat: add manual database session handling with rollback on exception (#770) by seapagan</li> </ul> <p>Bug Fixes</p> <ul> <li>Fix/deleted user 500 error (#785) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Chore(deps): update actions/checkout action to v6 (#784) by renovate[bot]</li> <li>Chore(deps): update actions/checkout action to v6 (#778) by renovate[bot]</li> <li>Chore(deps): update astral-sh/setup-uv action to v7 (#776) by renovate[bot]</li> <li>Chore(deps): update github/codeql-action action to v4 (#775) by renovate[bot]</li> <li>Chore(deps): update actions/checkout action to v5 (#771) by renovate[bot]</li> <li>Chore(deps): update mkdocs-swagger-ui-tag digest to fad9a89 (#765) by renovate[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v070-july-05-2025","title":"v0.7.0 (July 05, 2025)","text":"<p>Closed Issues</p> <ul> <li>Package psycopg2 is not needed (#759) by teschmitt</li> </ul> <p>Breaking Changes</p> <ul> <li>Breaking - Refactor <code>UserManager.set_ban_status</code> signature. (#760) by seapagan</li> <li>Integrate 'sqladmin' as a backend admin panel (#738) by seapagan</li> <li>Implement API Keys. (#734) by seapagan</li> </ul> <p>New Features</p> <ul> <li>CLI: add commands to create the secret and admin keys (#746) by seapagan</li> <li>CLI: add a 'seed' command to the 'db' group to populate the User table (#743) by seapagan</li> <li>CLI: add a command to batch-populate random test users into the database (#742) by seapagan</li> <li>Add user search endpoint with pagination and CLI command for same (#741) by seapagan</li> <li>CLI: add command to add or remove admin status for a user (#740) by seapagan</li> <li>Add a favicon for when the API is viewed through a web browser (#736) by seapagan</li> <li>Allow Admin users to list/edit/delete other users API keys (#735) by seapagan</li> </ul> <p>Security</p> <ul> <li>Update libraries as required to fix security alerts (#762) by seapagan</li> </ul> <p>Bug Fixes</p> <ul> <li>Fix crash when running 'db init' from the CLI (#737) by seapagan</li> </ul> <p>Refactoring</p> <ul> <li>Remove unused psycopg2 library (#763) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Replace the mkdocs swagger plugin with my own fork (#747) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump urllib3 from 2.3.0 to 2.5.0 (#758) by dependabot[bot]</li> <li>Bump requests from 2.32.3 to 2.32.4 (#757) by dependabot[bot]</li> <li>Bump h11 from 0.14.0 to 0.16.0 (#754) by dependabot[bot]</li> <li>Update astral-sh/setup-uv action to v6 (#753) by renovate[bot]</li> <li>Bump h11 from 0.14.0 to 0.16.0 (#752) by dependabot[bot]</li> <li>Bump jinja2 from 3.1.5 to 3.1.6 (#748) by dependabot[bot]</li> <li>Bump jinja2 from 3.1.5 to 3.1.6 (#745) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v060-february-18-2025","title":"v0.6.0 (February 18, 2025)","text":"<p>Breaking Changes</p> <ul> <li>Use latest versions of postgresql and python in docker (#728) by seapagan</li> <li>Migrate from poetry to uv (#703) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Migrate from <code>passlib</code> to <code>libpass</code> (#730) by seapagan</li> <li>Fix deprecation warning in tests due to httpx (#727) by seapagan</li> <li>Use the python logger in the API instead of print statements (#726) by seapagan</li> <li>Update 'Ruff' to latest version and fix any linting issues (#713) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Get test coverage up to 100% by testing the last uncovered blocks (#732) by seapagan</li> </ul> <p>Bug Fixes</p> <ul> <li>Fix deprecation warning in docs build d/t mkdocs swagger plugin (#731) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Clarify docs (#595) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump the project dependencies across the board (#729) by seapagan</li> <li>Bump cryptography from 44.0.0 to 44.0.1 (#725) by dependabot[bot]</li> <li>Update dependencies and fix issues caused by new package versions (#722) by seapagan</li> <li>Bump python-multipart from 0.0.17 to 0.0.18 (#720) by dependabot[bot]</li> <li>Bump jinja2 from 3.1.4 to 3.1.5 (#719) by dependabot[bot]</li> <li>Update astral-sh/ruff-action action to v3 (#717) by renovate[bot]</li> <li>Update astral-sh/setup-uv action to v5 (#716) by renovate[bot]</li> <li>Bump python-multipart from 0.0.17 to 0.0.18 (#715) by dependabot[bot]</li> <li>Update postgres Docker tag to v17 (#706) by renovate[bot]</li> <li>Bump sqlalchemy from 2.0.32 to 2.0.35 (#679) by dependabot[bot]</li> <li>and 65 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v054-june-18-2024","title":"v0.5.4 (June 18, 2024)","text":"<p>V0.5.4</p> <p>Security Update</p> <ul> <li>Updates <code>urllib3</code> to fix a MODERATE severity security issue.</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump urllib3 from 2.2.1 to 2.2.2 (#576) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.5.25 to 9.5.27 (#575) by dependabot[bot]</li> <li>Bump email-validator from 2.1.1 to 2.1.2 (#574) by dependabot[bot]</li> <li>Bump ruff from 0.4.7 to 0.4.9 (#573) by dependabot[bot]</li> <li>Bump pydantic-settings from 2.3.0 to 2.3.3 (#572) by dependabot[bot]</li> <li>Bump pydantic from 2.7.3 to 2.7.4 (#571) by dependabot[bot]</li> <li>Bump openapi-readme from 0.2.5 to 0.3.0 (#569) by dependabot[bot]</li> <li>Bump pytest from 8.2.1 to 8.2.2 (#568) by dependabot[bot]</li> <li>Bump faker from 25.4.0 to 25.8.0 (#565) by dependabot[bot]</li> <li>Bump pydantic-settings from 2.2.1 to 2.3.0 (#563) by dependabot[bot]</li> <li>and 3 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v053-june-03-2024","title":"v0.5.3 (June 03, 2024)","text":"<p>Closed Issues</p> <ul> <li>Poetry install broken under Docker (#534) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Add a Redis server to the docker compose file (#475) by seapagan</li> </ul> <p>Bug Fixes</p> <ul> <li>Fix Poetry install broken under Docker (#537) by seapagan</li> </ul> <p>Refactoring</p> <ul> <li>Migrate to rtoml (#523) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump requests from 2.31.0 to 2.32.2 (#557) by dependabot[bot]</li> <li>Bump ruff from 0.4.4 to 0.4.7 (#556) by dependabot[bot]</li> <li>Bump mkdocs-git-revision-date-localized-plugin from 1.2.5 to 1.2.6 (#555) by dependabot[bot]</li> <li>Bump pymarkdownlnt from 0.9.19 to 0.9.20 (#554) by dependabot[bot]</li> <li>Bump pydantic from 2.7.1 to 2.7.2 (#552) by dependabot[bot]</li> <li>Bump faker from 25.2.0 to 25.3.0 (#551) by dependabot[bot]</li> <li>Bump uvicorn from 0.29.0 to 0.30.0 (#550) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.5.23 to 9.5.25 (#549) by dependabot[bot]</li> <li>Bump anyio from 4.3.0 to 4.4.0 (#548) by dependabot[bot]</li> <li>Bump aiosmtpd from 1.4.5 to 1.4.6 (#543) by dependabot[bot]</li> <li>and 59 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v052-march-18-2024","title":"v0.5.2 (March 18, 2024)","text":"<p>Closed Issues</p> <ul> <li>Projects generated from template fail tests d/t codacy key (#448) by seapagan</li> <li>DB Connection / release error (#331) by seapagan</li> </ul> <p>Merged Pull Requests</p> <ul> <li>Re-enable codacy coverage reports (#419) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Update the coverage action (#454) by seapagan</li> </ul> <p>Refactoring</p> <ul> <li>Ensure docker config explicitly uses port 8001 (#453) by seapagan</li> <li>Update formatting to match Ruff 3.0 and remove pyright. (#432) by seapagan</li> <li>Migrate validations to Pydantic v2 syntax (#427) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Fix some wording and typos in the web docs (#425) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump ruff from 0.3.2 to 0.3.3 (#452) by dependabot[bot]</li> <li>Bump faker from 24.1.0 to 24.2.0 (#451) by dependabot[bot]</li> <li>Bump pydantic from 2.6.3 to 2.6.4 (#450) by dependabot[bot]</li> <li>Bump types-passlib from 1.7.7.20240106 to 1.7.7.20240311 (#447) by dependabot[bot]</li> <li>Bump asyncclick from 8.1.7.1 to 8.1.7.2 (#446) by dependabot[bot]</li> <li>Bump pytest from 8.0.2 to 8.1.1 (#445) by dependabot[bot]</li> <li>Bump uvicorn from 0.27.1 to 0.28.0 (#444) by dependabot[bot]</li> <li>Bump ruff from 0.3.0 to 0.3.2 (#443) by dependabot[bot]</li> <li>Bump mypy from 1.8.0 to 1.9.0 (#442) by dependabot[bot]</li> <li>Bump faker from 24.0.0 to 24.1.0 (#441) by dependabot[bot]</li> <li>and 22 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v051-february-26-2024","title":"v0.5.1 (February 26, 2024)","text":"<p>Closed Issues</p> <ul> <li>Run Tests against Postgres database (#102) by seapagan</li> </ul> <p>Breaking Changes</p> <ul> <li>Upgrade docker config to use version 15. Change some ports and env variable usage (#410) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Add option to disable the '/' route if required (#388) by seapagan</li> <li>Allow setting a custom API root path e.g. \"/api/v1\" to prepend to all routes (#386) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Fix the Docker config so tests pass (#409) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Update <code>.env.example</code>, and remove references to old 'api-admin' script from docs (#407) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Update the requirements files to match pyproject.toml (#408) by seapagan</li> <li>Bump mkdocs-material from 9.5.9 to 9.5.11 (#406) by dependabot[bot]</li> <li>Bump cryptography from 42.0.2 to 42.0.4 (#405) by dependabot[bot]</li> <li>Bump aiosqlite from 0.19.0 to 0.20.0 (#404) by dependabot[bot]</li> <li>Bump pyright from 1.1.350 to 1.1.351 (#403) by dependabot[bot]</li> <li>Bump anyio from 4.2.0 to 4.3.0 (#402) by dependabot[bot]</li> <li>Bump pytest from 8.0.0 to 8.0.1 (#401) by dependabot[bot]</li> <li>Bump ruff from 0.2.1 to 0.2.2 (#400) by dependabot[bot]</li> <li>Bump pydantic-settings from 2.1.0 to 2.2.1 (#399) by dependabot[bot]</li> <li>Bump pre-commit from 3.6.1 to 3.6.2 (#397) by dependabot[bot]</li> <li>and 12 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v050-february-07-2024","title":"v0.5.0 (February 07, 2024)","text":"<p>A New Hope</p> <p>This is the long-delayed release of <code>0.5.0</code> </p> <p>There are many breaking changes; check the documentation, discussions and all the 0.5.0 alpha and beta releases for information.</p> <ul> <li>Make the API an installable package and CLI command (#276) by seapagan</li> <li>Convert db to sqlalchemy 2 (#140) by seapagan</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v042-february-07-2024","title":"v0.4.2 (February 07, 2024)","text":"<p>The Old Guard</p> <p>Breaking Changes</p> <ul> <li>Ensure user reads the release notes for the current breaking changes (#377) by seapagan</li> <li>Merge version 0.5.0 (#281) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump ruff from 0.1.15 to 0.2.0 (#375) by dependabot[bot]</li> <li>Bump pyright from 1.1.349 to 1.1.350 (#374) by dependabot[bot]</li> <li>Bump pytest-sugar from 0.9.7 to 1.0.0 (#373) by dependabot[bot]</li> <li>Bump mkdocs-git-revision-date-localized-plugin from 1.2.2 to 1.2.4 (#372) by dependabot[bot]</li> <li>Bump fastapi from 0.109.0 to 0.109.2 (#371) by dependabot[bot]</li> <li>Bump pydantic from 2.6.0 to 2.6.1 (#370) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.5.6 to 9.5.7 (#369) by dependabot[bot]</li> <li>Bump pyfakefs from 5.3.4 to 5.3.5 (#368) by dependabot[bot]</li> <li>Bump faker from 22.6.0 to 22.7.0 (#367) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v050-beta1-february-01-2024","title":"v0.5.0-beta1 (February 01, 2024)","text":"<p>Closed Issues</p> <ul> <li>Intermittent test failures with 3.9 and 3.10 (#321) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Continue writing missing tests (#341) by seapagan</li> <li>Continue testing on the <code>api-admin custom</code> CLI command (#313) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump ruff from 0.1.13 to 0.1.15 (#364) by dependabot[bot]</li> <li>Bump pydantic from 2.5.3 to 2.6.0 (#363) by dependabot[bot]</li> <li>Bump mkdocs-minify-plugin from 0.7.2 to 0.8.0 (#361) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.5.3 to 9.5.6 (#360) by dependabot[bot]</li> <li>Bump pyright from 1.1.348 to 1.1.349 (#358) by dependabot[bot]</li> <li>Bump pytest from 7.4.4 to 8.0.0 (#357) by dependabot[bot]</li> <li>Bump uvicorn from 0.27.0 to 0.27.0.post1 (#356) by dependabot[bot]</li> <li>Bump pytest-watcher from 0.3.4 to 0.3.5 (#355) by dependabot[bot]</li> <li>Bump faker from 21.0.1 to 22.6.0 (#354) by dependabot[bot]</li> <li>Bump pyright from 1.1.346 to 1.1.348 (#351) by dependabot[bot]</li> <li>and 24 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v050-alpha3-december-12-2023","title":"v0.5.0-alpha3 (December 12, 2023)","text":"<p>This version contains minor breaking changes to the way you will run the CLI tool. See the documentation for more information.</p> <p>Breaking Changes</p> <ul> <li>Make the API an installable package and CLI command (#276) by seapagan</li> </ul> <p>Merged Pull Requests</p> <ul> <li>Add 'pyright' tool to check out functionality (#279) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Update docker config to the more recent image and postgres versions (#282) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Add tests for the CLI functionality (#285) by seapagan</li> <li>Continue improving test coverage (#284) by seapagan</li> <li>Fix integration tests (#283) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Update and freshen the docs (#275) by seapagan</li> <li>Add a changelog to the project (#274) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump actions/setup-python from 4 to 5 (#311) by dependabot[bot]</li> <li>Bump ruff from 0.1.5 to 0.1.7 (#300) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.4.8 to 9.5.1 (#299) by dependabot[bot]</li> <li>Bump cryptography from 41.0.4 to 41.0.6 (#298) by dependabot[bot]</li> <li>Bump pydantic from 2.5.0 to 2.5.2 (#296) by dependabot[bot]</li> <li>Bump rich from 13.6.0 to 13.7.0 (#295) by dependabot[bot]</li> <li>Bump pydantic-settings from 2.0.3 to 2.1.0 (#294) by dependabot[bot]</li> <li>Bump mkdocs-swagger-ui-tag from 0.6.6 to 0.6.7 (#292) by dependabot[bot]</li> <li>Bump mkdocstrings from 0.23.0 to 0.24.0 (#291) by dependabot[bot]</li> <li>Bump github-changelog-md from 0.7.2 to 0.8.0 (#290) by dependabot[bot]</li> <li>and 5 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v050-alpha2-november-13-2023","title":"v0.5.0-alpha2 (November 13, 2023)","text":"<p>Refactoring</p> <ul> <li>Update Linting and Formatting to use <code>Ruff</code> instead (#273) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump uvicorn from 0.23.2 to 0.24.0.post1 (#272) by dependabot[bot]</li> <li>Bump sqlalchemy from 2.0.22 to 2.0.23 (#271) by dependabot[bot]</li> <li>Bump poethepoet from 0.24.1 to 0.24.2 (#270) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.4.7 to 9.4.8 (#269) by dependabot[bot]</li> <li>Bump poetry from 1.6.1 to 1.7.0 (#268) by dependabot[bot]</li> <li>Bump asyncpg from 0.28.0 to 0.29.0 (#267) by dependabot[bot]</li> <li>Bump faker from 19.11.0 to 19.13.0 (#265) by dependabot[bot]</li> <li>Bump pytest from 7.4.2 to 7.4.3 (#264) by dependabot[bot]</li> <li>Bump mkdocs-swagger-ui-tag from 0.6.5 to 0.6.6 (#263) by dependabot[bot]</li> <li>Bump alembic from 1.12.0 to 1.12.1 (#261) by dependabot[bot]</li> <li>and 19 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v050-alpha1-september-22-2023","title":"v0.5.0-alpha1 (September 22, 2023)","text":"<p>Testing</p> <ul> <li>Re-enable gh actions (#223) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump cryptography from 41.0.3 to 41.0.4 (#222) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.2.8 to 9.3.2 (#221) by dependabot[bot]</li> <li>Bump gitpython from 3.1.32 to 3.1.35 (#220) by dependabot[bot]</li> <li>Bump mkdocs-swagger-ui-tag from 0.6.4 to 0.6.5 (#219) by dependabot[bot]</li> <li>Bump rich from 13.5.2 to 13.5.3 (#218) by dependabot[bot]</li> <li>Bump faker from 19.3.1 to 19.6.1 (#217) by dependabot[bot]</li> <li>Bump black from 23.7.0 to 23.9.1 (#216) by dependabot[bot]</li> <li>Bump pytest from 7.4.1 to 7.4.2 (#214) by dependabot[bot]</li> <li>Bump pre-commit from 3.3.3 to 3.4.0 (#211) by dependabot[bot]</li> <li>Bump pymdown-extensions from 10.1 to 10.3 (#210) by dependabot[bot]</li> <li>and 7 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v050-alpha0-august-27-2023","title":"v0.5.0-alpha0 (August 27, 2023)","text":"<p>Breaking Changes</p> <ul> <li>Convert db to sqlalchemy 2 (#140) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Update fastapi to latest version (#197) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Start re-adding tests (#161) by seapagan</li> </ul> <p>Refactoring</p> <ul> <li>Update fastapi to latest version (#197) by seapagan</li> <li>Start re-adding tests (#161) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump cryptography from 41.0.1 to 41.0.3 (#196) by dependabot[bot]</li> <li>Bump certifi from 2023.5.7 to 2023.7.22 (#195) by dependabot[bot]</li> <li>Bump gitpython from 3.1.31 to 3.1.32 (#194) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.1.21 to 9.2.3 (#193) by dependabot[bot]</li> <li>Bump sqlalchemy from 2.0.19 to 2.0.20 (#192) by dependabot[bot]</li> <li>Bump pytest-randomly from 3.13.0 to 3.15.0 (#191) by dependabot[bot]</li> <li>Bump poetry from 1.5.1 to 1.6.1 (#190) by dependabot[bot]</li> <li>Bump mypy from 1.4.1 to 1.5.1 (#189) by dependabot[bot]</li> <li>Bump alembic from 1.11.2 to 1.11.3 (#187) by dependabot[bot]</li> <li>Bump mkdocs-swagger-ui-tag from 0.6.3 to 0.6.4 (#185) by dependabot[bot]</li> <li>and 22 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v041-july-11-2023","title":"v0.4.1 (July 11, 2023)","text":"<p>Breaking Changes</p> <ul> <li>Refactor application layout (potential BREAKING CHANGE) (#127) by seapagan</li> <li>Refactor versioning (#126) by seapagan</li> </ul> <p>Refactoring</p> <ul> <li>Migrate startup to lifespan (#131) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Add release version to docs (#130) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump sqlalchemy from 1.4.48 to 1.4.49 (#151) by dependabot[bot]</li> <li>Bump pytest-randomly from 3.12.0 to 3.13.0 (#150) by dependabot[bot]</li> <li>Bump anyio from 3.7.0 to 3.7.1 (#149) by dependabot[bot]</li> <li>Bump faker from 18.11.2 to 18.13.0 (#148) by dependabot[bot]</li> <li>Bump pytest-reverse from 1.6.0 to 1.7.0 (#146) by dependabot[bot]</li> <li>Bump poethepoet from 0.20.0 to 0.21.0 (#145) by dependabot[bot]</li> <li>Bump asyncpg from 0.27.0 to 0.28.0 (#144) by dependabot[bot]</li> <li>Bump fastapi-mail from 1.3.0 to 1.3.1 (#143) by dependabot[bot]</li> <li>Bump fastapi from 0.98.0 to 0.99.1 (#142) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.1.17 to 9.1.18 (#141) by dependabot[bot]</li> <li>and 7 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v040-june-19-2023","title":"v0.4.0 (June 19, 2023)","text":"<p>Version refactor</p> <p>Closed Issues</p> <ul> <li>Key Management secrets engine (#115)</li> <li>Internal Links on the web documentation site are broken. (#110) by seapagan</li> <li>Docker Support (#99) by seapagan</li> <li>Add unit tests (#72) by seapagan</li> </ul> <p>Merged Pull Requests</p> <ul> <li>Fix missing openapi schema for Docs (#119) by seapagan</li> <li>Fix documentation (#112) by pdrivom</li> <li>Improve CLI user functions (#109) by seapagan</li> <li>Clarify docs (#108) by seapagan</li> <li>Update .env.example file (#104) by seapagan</li> <li>Disable the Codacy coverage upload. (#97) by seapagan</li> <li>Further work on testing (#93) by seapagan</li> <li>Clear Pylint warnings (#89) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Docker Support (#101) by pdrivom</li> </ul> <p>Testing</p> <ul> <li>Continue to improve test coverage (#92) by seapagan</li> </ul> <p>Bug Fixes</p> <ul> <li>Fix local link errors in Web Docs (#111) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Add custom domain for docs (#120) by seapagan</li> <li>Fix local link errors in Web Docs (#111) by seapagan</li> <li>Add development information to Docs website (#103) by seapagan</li> <li>Minimal tidying of documentation (#96) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump mkdocs-material from 9.1.15 to 9.1.16 (#124) by dependabot[bot]</li> <li>Bump pytest-mock from 3.10.0 to 3.11.1 (#123) by dependabot[bot]</li> <li>Bump pre-commit from 3.3.2 to 3.3.3 (#122) by dependabot[bot]</li> <li>Bump mkdocs-swagger-ui-tag from 0.6.1 to 0.6.2 (#121) by dependabot[bot]</li> <li>Bump pytest from 7.3.1 to 7.3.2 (#107) by dependabot[bot]</li> <li>Bump fastapi from 0.96.0 to 0.97.0 (#106) by dependabot[bot]</li> <li>Bump rich from 13.4.1 to 13.4.2 (#105) by dependabot[bot]</li> <li>Bump fastapi from 0.95.2 to 0.96.0 (#91) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p> <p>Version Numbering Change</p> <p>At this point, the version numbering for this project was refactored since it was not ready for a 1.0 release. The versioning will still follow Semantic Versioning, but the next release will be <code>0.4.0</code>.</p> <p>See this discussion for more of the reasoning behind this change.</p>"},{"location":"changelog/#v150-june-02-2023","title":"v1.5.0 (June 02, 2023)","text":"<p>New Features</p> <ul> <li>Setup Testing (#84) by seapagan</li> <li>Backport database changes (#83) by seapagan</li> </ul> <p>Testing</p> <ul> <li>Setup Testing (#84) by seapagan</li> </ul> <p>Documentation</p> <ul> <li>Add documentation site (#79) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump mkdocstrings from 0.21.2 to 0.22.0 (#87) by dependabot[bot]</li> <li>Bump mkdocs-material from 9.1.14 to 9.1.15 (#86) by dependabot[bot]</li> <li>Bump poetry from 1.5.0 to 1.5.1 (#85) by dependabot[bot]</li> <li>Bump requests from 2.30.0 to 2.31.0 (#82) by dependabot[bot]</li> <li>Bump poethepoet from 0.19.0 to 0.20.0 (#81) by dependabot[bot]</li> <li>Bump alembic from 1.10.4 to 1.11.1 (#78) by dependabot[bot]</li> <li>Bump pyjwt from 2.6.0 to 2.7.0 (#76) by dependabot[bot]</li> <li>Bump rich from 12.6.0 to 13.3.5 (#75) by dependabot[bot]</li> <li>Bump pylint from 2.17.3 to 2.17.4 (#74) by dependabot[bot]</li> <li>Bump pre-commit from 3.2.2 to 3.3.1 (#73) by dependabot[bot]</li> <li>and 4 more dependency updates</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v141-april-26-2023","title":"v1.4.1 (April 26, 2023)","text":"<p>New Features</p> <ul> <li>Add db methods to the CLI (#65) by seapagan</li> <li>Add Git pre commit hook (#64) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump pylint from 2.17.2 to 2.17.3 (#62) by dependabot[bot]</li> <li>Bump alembic from 1.10.3 to 1.10.4 (#61) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v140-april-20-2023","title":"v1.4.0 (April 20, 2023)","text":"<p>New Features</p> <ul> <li>Migrate to Typer for the CLI (#60) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump fastapi from 0.95.0 to 0.95.1 (#59) by dependabot[bot]</li> <li>Bump alembic from 1.10.2 to 1.10.3 (#58) by dependabot[bot]</li> <li>Bump pylint from 2.17.1 to 2.17.2 (#57) by dependabot[bot]</li> <li>Bump fastapi-mail from 1.2.6 to 1.2.7 (#56) by dependabot[bot]</li> <li>Bump black from 23.1.0 to 23.3.0 (#55) by dependabot[bot]</li> <li>Bump psycopg2 from 2.9.5 to 2.9.6 (#54) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v133-march-23-2023","title":"v1.3.3 (March 23, 2023)","text":"<p>Dependency Updates</p> <ul> <li>Bump fastapi from 0.92.0 to 0.95.0 (#53) by dependabot[bot]</li> <li>Bump uvicorn from 0.20.0 to 0.21.1 (#52) by dependabot[bot]</li> <li>Bump sqlalchemy from 1.4.46 to 1.4.47 (#51) by dependabot[bot]</li> <li>Bump alembic from 1.9.3 to 1.10.2 (#49) by dependabot[bot]</li> <li>Bump fastapi-mail from 1.2.5 to 1.2.6 (#47) by dependabot[bot]</li> <li>Bump python-decouple from 3.7 to 3.8 (#46) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v132-february-16-2023","title":"v1.3.2 (February 16, 2023)","text":"<p>Closed Issues</p> <ul> <li>Improvements to the CLI metadata setup (#41) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump alembic from 1.9.2 to 1.9.3 (#43) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v131-january-25-2023","title":"v1.3.1 (January 25, 2023)","text":"<p>New Features</p> <ul> <li>Add improvements to the CLI metadata generation. (#42) by seapagan</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v130-january-25-2023","title":"v1.3.0 (January 25, 2023)","text":"<p>Closed Issues</p> <ul> <li>Error when creating user from CLI (#39) by seapagan</li> </ul> <p>Merged Pull Requests</p> <ul> <li>Fix Bug when creating user from CLI (#40) by seapagan</li> <li>Verify registration by Email (#28) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump aiosmtpd from 1.4.3 to 1.4.4.post2 (#38) by dependabot[bot]</li> <li>Bump email-validator from 1.3.0 to 1.3.1 (#37) by dependabot[bot]</li> <li>Bump alembic from 1.9.1 to 1.9.2 (#36) by dependabot[bot]</li> <li>Bump python-decouple from 3.6 to 3.7 (#35) by dependabot[bot]</li> <li>Bump sqlalchemy from 1.4.45 to 1.4.46 (#34) by dependabot[bot]</li> <li>Bump alembic from 1.9.0 to 1.9.1 (#33) by dependabot[bot]</li> <li>Bump alembic from 1.8.1 to 1.9.0 (#32) by dependabot[bot]</li> <li>Bump databases from 0.6.1 to 0.7.0 (#31) by dependabot[bot]</li> <li>Bump sqlalchemy from 1.4.44 to 1.4.45 (#30) by dependabot[bot]</li> <li>Bump certifi from 2022.9.24 to 2022.12.7 (#29) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v120-december-01-2022","title":"v1.2.0 (December 01, 2022)","text":"<p>Merged Pull Requests</p> <ul> <li>Implement Refresh Token functionality (#27) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Send Emails on certain actions (#21) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump fastapi from 0.87.0 to 0.88.0 (#25) by dependabot[bot]</li> <li>Bump fastapi from 0.86.0 to 0.87.0 (#24) by dependabot[bot]</li> <li>Bump sqlalchemy from 1.4.43 to 1.4.44 (#23) by dependabot[bot]</li> <li>Bump actions/dependency-review-action from 2 to 3 (#22) by dependabot[bot]</li> <li>Bump fastapi from 0.85.1 to 0.86.0 (#20) by dependabot[bot]</li> <li>Bump sqlalchemy from 1.4.42 to 1.4.43 (#19) by dependabot[bot]</li> <li>Bump asyncpg from 0.26.0 to 0.27.0 (#17) by dependabot[bot]</li> <li>Bump psycopg2 from 2.9.4 to 2.9.5 (#16) by dependabot[bot]</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v111-october-30-2022","title":"v1.1.1 (October 30, 2022)","text":"<p>Merged Pull Requests</p> <ul> <li>Move database code into a module (#15) by seapagan</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v110-october-30-2022","title":"v1.1.0 (October 30, 2022)","text":"<p>Merged Pull Requests</p> <ul> <li>Run a development Server (#14) by seapagan</li> <li>Set CORS origin or default to open (#12) by seapagan</li> </ul> <p>New Features</p> <ul> <li>Customize the API metadata from the command line (#13) by seapagan</li> </ul> <p><code>Full Changelog</code> | <code>Diff</code> | <code>Patch</code></p>"},{"location":"changelog/#v100-october-26-2022","title":"v1.0.0 (October 26, 2022)","text":"<p>Merged Pull Requests</p> <ul> <li>Validate email (#11) by seapagan</li> <li>Implement cli to add  a new user (#10) by seapagan</li> <li>Document the App. (#5) by seapagan</li> <li>Handle bad DB settings more gracefully (#4) by seapagan</li> <li>Allow user to read their own profile data (#3) by seapagan</li> <li>Admins can Ban a user (#2) by seapagan</li> <li>Settings module (#1) by seapagan</li> </ul> <p>Dependency Updates</p> <ul> <li>Bump uvicorn from 0.18.3 to 0.19.0 (#9) by dependabot[bot]</li> <li>Bump pyjwt from 2.5.0 to 2.6.0 (#8) by dependabot[bot]</li> <li>Bump sqlalchemy from 1.4.41 to 1.4.42 (#7) by dependabot[bot]</li> <li>Bump fastapi from 0.85.0 to 0.85.1 (#6) by dependabot[bot]</li> </ul> <p>This changelog was generated using github-changelog-md by Seapagan</p>"},{"location":"contributing/","title":"Contributing","text":""},{"location":"contributing/#contributing-to-the-fastapi-template","title":"Contributing to the FastAPI Template","text":"<p>Thank you for your interest in contributing to <code>fastapi-template</code>! We welcome all contributions, big or small.</p> <p>If you are not sure where to start, please take a look at the open issues. If you have an idea for a new feature or would like to report a bug, please open a new issue. You can also check the TODO List for ideas.</p> <p>I also welcome contributions to the documentation. If you find any errors or would like to suggest improvements, please open a new issue or submit a Pull Request.</p> <p>I you would like to contribute to the code, but find the requirements below a bit daunting, please feel free to open a discussion and I can help you get started, or even pair on a PR.</p> <p>Currently, development is done primary on Linux, but I will also try to test on Windows and Mac OS X when possible. If you are using a different platform and find any issues, please let me know. I welcome any contributions, on any platform!</p> <p>If you have any issues developing on a particular platform, please let me know and I will try to help you out. I am also open to suggestions for improving the development process and documentation.</p>"},{"location":"contributing/#prerequisites","title":"Prerequisites","text":"<p>Since this is a Python project, you will need to have Python installed on your machine. You can download the latest version of Python from the official website or using your Operating system's package manager. This project requires Python 3.10 or higher.</p> <p>I'd recommend using pyenv to manage your Python installations, the pyenv-installer works for Linux and Mac OS X. For Windows, you can use the pyenv-win port. See here for installation instructions. Of course you can also (and probably the best way) use <code>uv</code> to install a python version much easier, though <code>pyenv</code> works with <code>uv</code> also.</p> <ul> <li>We use uv to manage our dependencies. You should have this installed as well. You can install <code>uv</code> by following the instructions on their website.</li> </ul> <p><code>uv</code> can be used to actually install Python, even if you do not have it installed locally (either by system, pyenv or similar).</p> <p>For example, to install Python 3.12 using <code>uv</code>, you can run the following command:</p> <pre><code>uv python install 3.12\n</code></pre> <p>If you already have a Python version installed, uv will use this.</p> <p>Tip</p> <p>If you don't want to have <code>uv</code> installed globally for any reason, there is an auto-generated <code>requirements-dev.txt</code> file in the root of the project. You can use this to install the dependencies using <code>pip</code>:</p> <pre><code>$ pip install -r requirements-dev.txt\n</code></pre> <p>However, if you are going to be contributing to the project, <code>uv</code> is strongly recommended as this is what we use internally and in the CI.</p>"},{"location":"contributing/#getting-started","title":"Getting Started","text":"<p>Before you start contributing, please make sure you have read and understood our Code of Conduct and License.</p> <p>To get started, follow these steps:</p> <ol> <li>Fork the repository and clone it to your local machine.</li> <li>Install the required dependencies (see next section).</li> <li>Create a new branch for your changes: <code>git checkout -b my-new-feature</code>.</li> <li>Make your changes and commit them: <code>git commit -am 'Add some feature'</code>.</li> <li>Push your changes to your fork: <code>git push origin my-new-feature</code>.</li> <li>Create a new pull request.</li> </ol>"},{"location":"contributing/#install-dependencies","title":"Install Dependencies","text":"<p>Run the following command to install the required dependencies:</p> <pre><code>uv sync\n</code></pre> <p>You then need to activate the virtual environment:</p> <pre><code>source .venv/bin/activate\n</code></pre> <p>If you are using Windows, you can activate the virtual environment using the following command instead:</p> <pre><code>.venv\\Scripts\\activate\n</code></pre> <p>From here you can start working on the project. If you are using an IDE such as VSCode or PyCharm, you can set the use their Python interpreter setting to use the virtual environment that has just been created.</p>"},{"location":"contributing/#linting","title":"Linting","text":"<p>I am quite strict about linting and code formatting and have set up a number of pre-commit hooks and tasks to ensure that the code meets the required standards.</p>"},{"location":"contributing/#code-linting-and-formatting","title":"Code linting and formatting","text":"<p>We are using Ruff for linting and formatting. These are set up as pre-commit hooks and can be run as below. You can also use the <code>poe ruff</code> and <code>poe format</code> commands to run these manually.</p>"},{"location":"contributing/#type-hinting","title":"Type hinting","text":"<p>All code must pass <code>mypy</code> checks. This can be run manually using the <code>poe mypy</code> and is part of the pre-commit hooks.</p>"},{"location":"contributing/#install-git-pre-commit-hooks","title":"Install Git Pre-Commit hooks","text":"<p>Please install this if you are intending to submit a PR. It will check commits locally before they are pushed up to the Repo. The GitHub CI runs the linting and mypy checks, and will fail if there are any errors. We use prek to control the git hooks:</p> <pre><code>$ prek install\nprek installed at .git/hooks/pre-commit\n</code></pre> <p>This will ensure that all code meets the required linting standard before being committed. It will also automatically generate updated <code>requirements.txt</code> and <code>requirements-dev.txt</code> files if required. Note that generating these files will cause the commit to fail, so you can add the new files to your git stage.</p> <p>Important</p> <p>Previously we used <code>pre-commit</code> for this. However, <code>prek</code> is a more modern and much faster drop-in equivalent written in Rust, If you have the <code>pre-commit</code> hooks already set up, you must force <code>prek</code> to overwrite them:</p> <pre><code>$ prek install -f\n</code></pre>"},{"location":"contributing/#run-prek-manually","title":"Run prek manually","text":"<p>You can run these checks manually on all files in the project using the below command :</p> <pre><code>poe pre\n</code></pre> <p>As before, this will generate updated <code>requirements.txt</code> and <code>requirements-dev.txt</code> files if required.</p> <p>Tip</p> <p>It's actually a good idea (and heavily recommended!) to run the above command regularly to ensure the dependency files are updated and that the linters all pass.</p>"},{"location":"contributing/#github-ci-action","title":"GitHub CI Action","text":"<p>The checks in this pre-commit hook are also automatically run for each commit pushed to GitHub and for Pull Requests. This is controlled by the <code>~/.github/workflows/prek.yml</code> configuration file.</p>"},{"location":"contributing/#testing","title":"Testing","text":"<p>We are using pytest for testing.</p> <p>If you add any new features, please add tests for them. This will help us to ensure that the code is working as expected and will prevent any regressions.</p> <p>GitHub Actions will run the tests on every commit and PR, failing tests will block the PR from being merged, as will any major drop in test coverage.</p>"},{"location":"contributing/#prerequisites-for-running-tests-locally","title":"Prerequisites for Running Tests Locally","text":"<p>IMPORTANT: Before running tests locally, you must have a valid <code>.env</code> file configured with the following required settings:</p> <ul> <li><code>SECRET_KEY</code> - Must be at least 32 characters long</li> <li><code>DB_USER</code> - Your PostgreSQL database username</li> <li><code>DB_PASSWORD</code> - Your PostgreSQL database password</li> <li><code>DB_ADDRESS</code> - Database host (usually <code>localhost</code>)</li> <li><code>DB_PORT</code> - Database port (usually <code>5432</code>)</li> <li><code>DB_NAME</code> - Your production database name</li> <li><code>TEST_DB_NAME</code> - Your test database name (defaults to <code>api-template-test</code>,   recommended to set explicitly)</li> </ul> <p>Tests will use the same database credentials (DB_USER/DB_PASSWORD) but connect to the TEST_DB_NAME database instead.</p> <p>See the Configuration section in the documentation for full setup instructions, or copy <code>.env.example</code> to <code>.env</code> and update the values.</p> <p>Tests require these credentials to pass validation checks and connect to your local PostgreSQL database. Tests will fail without a properly configured <code>.env</code> file.</p>"},{"location":"contributing/#running-tests","title":"Running Tests","text":"<p>There is a task set up to run tests:</p> <pre><code>$ poe test\n</code></pre> <p>You can also run the tests manually using the following command:</p> <pre><code>$ pytest\n</code></pre> <p>The task is set up so we can automatically add other options in the future. Notice that both these commands will run the tests with the <code>--cov</code> option and show the coverage report at the end.</p>"},{"location":"contributing/#changelog","title":"Changelog","text":"<p>The changelog is automatically generated, using this project, so please do not edit it manually.</p> <p>For maintainers, there is a POE task that will run this and update the changelog file.</p> <pre><code>$ poe changelog\n</code></pre> <p>You would also need to add a GitHub Personal Access Token to a local config file as usual. See the section in the Documentation for information.</p> <p>However, you should NOT include a change to the <code>CHANGELOG.md</code> file in any Pull Requests. This will be handled by the maintainers when a new release is made. Your GitHub username will be added to the changelog automatically beside your PR.</p>"},{"location":"contributing/#convenience-tasks","title":"Convenience Tasks","text":"<p>There are a few other convenience tasks that can be run using the <code>poe</code> command. These are defined in the <code>pyproject.toml</code> file.</p> <p>Each of these tasks can have extra options added which will be passed to the underlying tool.</p> <p>Run <code>mypy</code> on the code base in strict mode:</p> <pre><code>$ poe mypy\n</code></pre> <p>Format the code using <code>ruff format</code>:</p> <pre><code>$ poe format\n</code></pre> <p>Lint the code using <code>ruff</code>:</p> <pre><code>$ poe ruff\n</code></pre> <p>Check the Markdown:</p> <pre><code>$ poe markdown\n</code></pre> <p>Run <code>ruff</code>, <code>mypy</code>, <code>format</code> and <code>markdown</code> at the same time:</p> <pre><code>$ poe lint\n</code></pre>"},{"location":"contributing/#documentation-tasks","title":"Documentation Tasks","text":"<p>These are to help with developing and updating the documentation.</p> <ul> <li><code>poe docs:serve</code> - Serve the MkDocs locally for testing and development</li> <li><code>poe docs:serve:all</code> - Same as above, but opens to all interfaces so you can   view it on other devices on your network</li> <li><code>poe docs:build</code> - Build the MkDocs site into the <code>dist</code> folder</li> <li><code>poe docs:publish</code> - Publish the docs to your GitHub pages. Note that only   those with write-access to this repo can do this.</li> </ul>"},{"location":"contributing/#guidelines","title":"Guidelines","text":"<p>Here are some guidelines to follow when contributing to <code>fastapi-template</code>:</p> <ul> <li>Do not update the version number in the <code>pyproject.toml</code> file. This will be   done by the maintainers when a new release is made.</li> <li>Follow the PEP 8 style guide. The   pre-commit hooks will check for this. We are using the Ruff   Formatter.</li> <li>Fix any linting errors or warnings. The pre-commit hooks will check for   this also. Ruff is installed and set to pretty   strict settings. Ruff now replaces all the original linters that were   installed. There is also a Markdown linter.</li> <li>MyPy is installed and we are using   type hints. Please try to add type hints to your code. If you see any areas of   the code that are missing type hints, please feel free to open a PR and add   them \ud83d\ude01!</li> <li>Write clear and concise commit messages.</li> <li>Write tests for your code.</li> <li>Make sure your code passes all existing and new tests before submitting a pull   request.</li> <li>Document your code using   docstrings. This project uses the   Google Docstring   Spec though   at this time is a bit slack on listing the Args and Returns. I will be adding   these in as I go along so feel free to add them in if you are contributing   .</li> <li>If you add or change any functionality, please update the documentation   accordingly.</li> <li>Use GitHub issues to   report bugs or suggest new features.</li> </ul> <p>If you are using VSCode, there is a config file in the <code>.vscode</code> folder that will help you to follow these guidelines. You may need to install some extensions to get the most out of it. I'll add a list of recommended extensions here soon. The <code>Python</code> and <code>Ruff</code> ones are very helpful (the included <code>.vscode</code> folder helps configure these).</p>"},{"location":"contributing/#contact","title":"Contact","text":"<p>If you have any questions or need help with contributing, please contact me @seapagan on GitHub. You can also use the GitHub Discussions feature.</p> <p>Happy contributing!</p>"},{"location":"future/","title":"Future Plans and Bugs","text":""},{"location":"future/#todo-list","title":"TODO List","text":""},{"location":"future/#general","title":"General","text":"<ul> <li>allow to tag endpoints as belonging to a group so can then have similar auth   etc.</li> <li>add time-limited bans (configurable)</li> <li>Add certain users that will not time-expire (or much longer time) for eg for   owner or premium access.</li> <li>Allow to re-send a registration email (part of the code is already there for   this, but was not functioning properly so disabled).</li> <li>Send an email to the User when they change their password or update their   profile, are Banned/Unbanned and to Admins when important events happen.</li> <li>Update current and future email templates with actual content, and change   their markup to latest best practices.</li> <li>Add an option to the command line to bump the version number in API docs and   the TOML file.</li> <li>Implement rate-limiting - auto block abusers - would help if <code>quotas</code>   implemented first (see below).</li> <li>Users should be able to get others (limited) profile data in some cases -   public data should be ok (eg in a front-end profile page). Think about how   this should be implemented. This may just need to be in derived projects   though, not this template.</li> <li>Allow the option of using auto-incerement integers for the User ID (as it is   now) or UUID's which is more secure and common these days. This should be   configurable in the settings, and (for now) the default should be the current   auto-incrementing integer.</li> <li>Refactor code with suppressed complexity warnings: The following files   have complexity warnings (C901, PLR0911, PLR0912) suppressed to enable   granular business metrics tracking. Consider refactoring to reduce complexity   while maintaining metric granularity:</li> <li><code>app/managers/api_key.py</code> - <code>ApiKeyAuth.__call__()</code> method (line 155)</li> </ul>"},{"location":"future/#bugsannoyances","title":"Bugs/Annoyances","text":"<ul> <li>None known at this time.</li> </ul>"},{"location":"future/#auth","title":"Auth","text":"<ul> <li>Add a <code>logout</code> route to immediately invalidate the users token and refresh   token. This will need a database to be kept of invalidated tokens (which can   periodically be auto-purged of tokens that would be time-expired anyway.)   Redis would be a good choice for this.</li> <li>Once the above is done, if a user deletes themselves (or is deleted), their   tokens should be invalidated immediately.</li> <li>Implement user groups and permissions, make it configurable.</li> <li>Allow social login (eg Google, Facebook, Twitter, etc), check out   fastsapi-sso for this.</li> <li>Add API key management to the CLI too, working on both user and global scope.</li> </ul>"},{"location":"future/#testing","title":"Testing","text":"<ul> <li>Speed up tests generally</li> <li>Allow choice of Postgresql or SQLite for testing (currently only Postgresql)</li> <li>check 'test_admin_pages_disabled' test since there is potentally a bug in   the test using the <code>path</code> of a BaseRoute which does not exist, and the test   may be invalid.</li> </ul>"},{"location":"future/#cli","title":"CLI","text":"<ul> <li>Option to remove the customization functionality from the CLI. Useful once you   have customized the template and don't want to give the end-user the ability   to change it easily.</li> <li>Ctrl-c on the <code>custom metadata</code> command should not bring up a Rich   stack-trace, but exit cleanly.</li> </ul>"},{"location":"future/#documentation","title":"Documentation","text":"<ul> <li>Add proper documentation with examples showing how to use the User &amp; Auth   system in custom code, link to example projects and perhaps create a YouTube   video showing an example custom project based on this template?</li> <li>Add info how to create a temporary database for testing (eg using Docker)</li> <li>Update return status codes and examples in the API documentation to be more   accurate and useful, some of them have wrong status codes and/or examples. For   example, the <code>GET /verify/</code> endpoint should return a 204 status code, not 200.</li> </ul>"},{"location":"future/#quotas","title":"Quotas","text":"<p>Add Quota functionality.</p> <ul> <li>Limit number of API calls per user per day/hour</li> <li>Different user groups have different quotas (configurable)</li> <li>Allow endpoint with no Quota</li> <li>Option to block altogether or seriously slow users access to the API for a   period of time</li> </ul>"},{"location":"future/#caching","title":"Caching","text":"<ul> <li>Add a Redis cache to the endpoints.   fastapi-redis-cache should   make this reasonably painless. Note that project seems to be abandoned with a   lot of un-merged PRs so I have forked and updated the project to fix a few   existing bugs, merge some PRs and add some new features. I'm still putting the   finishing touches on it but it should be ready soon.</li> </ul>"},{"location":"future/#frontend","title":"Frontend","text":"<ul> <li>Add integration for a proper Frontend (ie React, Vue, etc) by having a config   value to point the the location of this instead of using the default   <code>templates/index.html</code>. Look at how to integrate API configuration values with   this front end.</li> <li>Also worth looking at FastUI which is a   newer system my the author of <code>Pydantic</code> that integrates React with FastAPI   without writing any JavaScript.</li> </ul>"},{"location":"important/","title":"Breaking Changes","text":"<p>This page contains information about breaking changes in the API. It is important to read this page if you are upgrading from a previous version of the API.</p>"},{"location":"important/#breaking-changes-in-head","title":"Breaking Changes in <code>HEAD</code>","text":"<p>None.</p>"},{"location":"important/#breaking-changes-in-080","title":"Breaking Changes in <code>0.8.0</code>","text":""},{"location":"important/#drop-support-for-python-39","title":"Drop support for Python 3.9","text":"<p>While FastAPI does support 3.9, that version is past end-of-life. Pytest for example now only supports 3.10+. I decided for easier maintenance to drop 3.9.#</p>"},{"location":"important/#supports-python-314","title":"Supports Python 3.14","text":"<p>This is now officially supported, with a good few changes made to dependencies and tests to make it work.</p>"},{"location":"important/#modified-the-api-key-hashing-method","title":"Modified the API Key Hashing method","text":"<p>The API key is NEVER stored in the database, however a hashed version of this is so that we can authenticate. Previously it used a plain SHA256 algorythm, and has now been switched to using <code>HMAC</code> in conjunction with SHA256 instead. This allows using the <code>SECRET_KEY</code> already set to make the API keys more secure. As a result, any existing API Keys are now invalid and will need to be deleted and regenerated.</p>"},{"location":"important/#breaking-changes-in-070","title":"Breaking Changes in 0.7.0","text":""},{"location":"important/#modified-the-authentication-backend","title":"Modified the Authentication backend","text":"<p>This version introduces API Keys that can be created and used by a registered user to avoid having to keep refreshing the JWT. They are sent using the <code>X-API-Key</code> header.</p> <p>As a result of this, the authentication backend needed to be refactored quite a bit. Specifically, the <code>CustomHTTPBearer</code> was renamed to simply <code>HTTPBearer</code> and the usage changes slightly, though you should have been using the <code>oauth2_schema</code> helper instead of this class directly anyway.</p> <ol> <li>If you do NOT want to use the API key functionality, keep using the    <code>Depends(oauth2_schema)</code> in your route dependencies as before. These routes    will not be able to be accessed by an API Key.</li> <li>To migrate to use BOTH JWT and/or API Keys, change this to    <code>Depends(get_current_user)</code>.</li> </ol> <p>This change simplifies testing and allowed to test the Admin pages easier. Otherwise, it should be transparent unless you were accessing the <code>DATABASE_URL</code> directly.</p>"},{"location":"important/#refactor-set_ban_status-signature-in-usermanager","title":"Refactor <code>set_ban_status()</code> signature in <code>UserManager</code>","text":"<p>Several function signatures have changed, generally to fix boolean inconsistencies. Boolean parameters should be passed as named parameters instead of positional parameters. This is to make the code more readable and maintainable. The <code>UserManager.set_ban_status</code> function is one of these changes that causes a breaking change. However, this method is only called from an API endpoint for the moment, so it should not affect any existing code that depends on it unless you are using it directly in your code.</p> <p>The signature has changed to:</p> <pre><code>async def set_ban_status(\n        user_id: int,\n        my_id: int,\n        session: AsyncSession,\n        *,\n        banned: Optional[bool],\n    ) -&gt; None:\n</code></pre> <p>Note that the optional <code>state</code> parameter has ben renamed to the more descriptive <code>banned</code>. This is to make it clearer what the parameter is for. It has also been changed to a positional-only parameter and moved to the end of the signature.</p>"},{"location":"important/#removed-the-database_url-constant","title":"Removed the DATABASE_URL constant","text":"<p>The <code>DATABASE_URL</code> constant has been removed from the <code>app.database.db</code> module. The URL can now be accessed using the <code>get_database_url()</code> function from the same module. This also has an optional parameter flag of <code>use_test_db</code> (defaults to <code>False</code>) that can be set to <code>True</code> to use the test database URL instead of the production database URL.</p>"},{"location":"important/#breaking-changes-in-060","title":"Breaking Changes in 0.6.0","text":""},{"location":"important/#migrated-to-uv-for-virtual-environment-management","title":"Migrated to <code>uv</code> for virtual environment management","text":"<p>Really more of a minor one but I have migrated from <code>Poetry</code> to <code>uv</code> for the virtual environment management. This means that the <code>poetry.lock</code> file is now <code>uv.lock</code>. This speeds up the virtual environment creation and management by an order of magnitude. Instructions updated to reflect this change.</p>"},{"location":"important/#breaking-changes-in-051","title":"Breaking Changes in  0.5.1","text":"<p>There is a minor potentially breaking change in this release.</p>"},{"location":"important/#docker-port-change","title":"Docker Port Change","text":"<p>Under docker only, the API will now run on port <code>8001</code> instead of <code>8000</code>. This is to avoid conflicts with a local server or other services that may be running on the host machine.</p>"},{"location":"important/#breaking-changes-from-04x","title":"Breaking Changes from 0.4.x","text":"<p>From version 0.5.0, there have been some major breaking changes to the API.</p> <p>0.4.x Branch</p> <p>If you prefer to continue using the 0.4.x branch, you can find it here.</p> <p>To use this branch you will need to clone the repository and checkout the <code>0.4.2</code> branch.</p> <pre><code>git clone -b 0.4.2 https://github.com/seapagan/fastapi-template.git\n</code></pre> <p>Be aware that this branch will not be maintained and will not receive any updates or bug fixes.</p>"},{"location":"important/#migrated-to-async-sqlalchemy-20-for-database-access","title":"Migrated to Async SQLAlchemy 2.0 for database access","text":"<p>Previously, we used encode/databases for the database access. Now we have switched to SQLAlchemy 2.0. This means that you will need to update your database access code to use the new API for any new routes or models. Look at how the <code>User</code> model has been updated for an example.</p> <p>See also the SQLAlchemy Async ORM documentation for more information</p>"},{"location":"important/#the-cli-is-an-installable-package","title":"The CLI is an installable package","text":"<p>This means that the <code>api-admin</code> command is now a package and installed in your local virtual environment when you run <code>uv sync</code>. With this you can run the <code>api-admin</code> command from the command line anywhere inside the virtual environment.</p> <pre><code>api-admin --help\n</code></pre> <p>Pip users</p> <p>If you are not using <code>uv</code>, but the requirements.txt file, you will need to run the <code>api-admin</code> command as a Python module. For example, <code>python -m api-admin</code>.</p>"},{"location":"important/#full-test-coverage","title":"Full Test coverage","text":"<p>The API now has full test coverage (using Pytest). This means that testing will be enforced on all PR's and that the test suite will be run by GitHub Actions on every commit and PR. This is to ensure that the API is stable and reliable.</p>"},{"location":"important/#linting-changes","title":"Linting Changes","text":"<p>The project has moved completely over to using Ruff for Linting and Formatting.</p> <p>This relaces <code>Flake8</code>, <code>Black</code>, <code>isort</code> and many other tools with a single tool. I have set the rules quite strict also! All existing code passes these checks, or is whitelisted for a very good reason. This will be enforced for all PR's also. All tools are configured in the <code>pyproject.toml</code> file.</p>"},{"location":"important/#type-hints","title":"Type Hints","text":"<p>All code now has full type hinting. This means that you can use the <code>mypy</code> tool to check for type errors in the code. This will be enforced for all PR's.</p>"},{"location":"important/#dependency-updates","title":"Dependency Updates","text":"<p>All dependencies used are updated to the latest versions as of the <code>0.5.0</code> release and will be kept up to date automatically using the <code>Renovate</code> tool.</p>"},{"location":"important/#update-the-env-file","title":"Update the <code>.env</code> file","text":"<p>Did you Read all this?</p> <p>Since these are quite major changes, the API will not run unless you have read these instructions and noted this by adding the following environment variable to your <code>.env</code> file:</p> <pre><code>I_READ_THE_DAMN_DOCS=True\n</code></pre>"},{"location":"license/","title":"License","text":"<p>MIT License</p> <p>Copyright (c) 2022 - 2025 Grant Ramsay</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>"},{"location":"project-organization/","title":"Project Organization","text":"<p>This project has been deliberately laid out in a specific way. To avoid long complicated files which are difficult to debug, functionality is separated out in files and modules depending on the specific functionality.</p>"},{"location":"project-organization/#application-structure-app","title":"Application Structure (app/)","text":""},{"location":"project-organization/#files","title":"Files","text":"<p>app/main.py - The main controlling file for the FastAPI application. This should be as clean and short as possible with all functionality moved out to modules. Contains the FastAPI app instance, middleware registration, and route setup.</p> <p>app/api_admin.py - The CLI entry point for administrative tasks using Typer. Aggregates all command groups (db, user, custom, etc.) and provides the main CLI interface. Accessible via the <code>api-admin</code> command (or <code>python -m app.api_admin</code>).</p> <p>app/logs.py - Application logging setup using loguru with category-based control. Configures log formatting, handlers, and category filtering based on the <code>LOG_CATEGORIES</code> setting.</p>"},{"location":"project-organization/#directories","title":"Directories","text":"<p>app/admin/ - This directory contains the Admin interface setup. You can add more models here, or modify the existing ones. The Admin interface is used to manage the database content, and is available at the <code>/admin</code> route.</p> <p>app/commands/ - This directory can hold any CLI commands you need to write, for example populating a database, create a superuser or other housekeeping tasks.</p> <p>app/config/ - Handles the API settings and defaults, also the Metadata customization. If you add more settings (for example in the <code>.env</code> file) you should also add them to the <code>config/settings.py</code> or <code>config/metadata.py</code> with suitable defaults. Non-secret (or depoloyment independent) settings should go in the <code>metadata</code> file, while secrets (or deployment specific) should go in the <code>settings</code> and <code>.env</code> files</p> <p>app/database/ - This module controls database setup and configuration, and should generally not need to be touched.</p> <p>app/managers/ - This directory contains individual files for each 'group' of functionality. They contain a Class that should take care of the actual work needed for the routes. Check out the <code>managers/auth.py</code> and <code>managers/user.py</code></p> <p>app/metrics/ - Contains Prometheus metrics implementation for application observability. This module provides opt-in metrics collection via the <code>METRICS_ENABLED</code> setting. Includes:</p> <ul> <li><code>instrumentator.py</code> - Configures HTTP performance metrics (requests, latency,   size)</li> <li><code>custom.py</code> - Business metrics for auth failures, API keys, and login attempts</li> <li><code>namespace.py</code> - Centralized metric namespace computation from <code>api_title</code>   setting</li> </ul> <p>All metrics are prefixed with <code>{api_title}_</code> (e.g., <code>api_template_auth_failures_total</code>) to prevent naming collisions in multi-service deployments. The <code>/metrics</code> endpoint exposes these metrics in Prometheus format when enabled.</p> <p>app/middleware/ - Contains custom middleware components that process requests/responses. Currently includes <code>LoggingMiddleware</code> which logs HTTP requests in uvicorn format when the <code>REQUESTS</code> log category is enabled (controlled via <code>LOG_CATEGORIES</code> in settings). To add custom middleware, create a new file in this directory and register it in <code>main.py</code> using <code>app.add_middleware()</code>. See the FastAPI middleware docs for details.</p> <p>app/migrations/ - We use Alembic to handle the database migrations. Check out their pages for more info. See instructions under Development for more info.</p> <p>app/models/ - Any database models used should be defined here along with supporting files (eq the <code>models/enums.py</code>) used here. Models are specified using the SQLAlchemy format, see <code>models/user.py</code> for an example.</p> <p>app/resources/ - Contains the actual Route resources used by your API. Basically, each grouped set of routes should have its own file, which then should be imported into the <code>resources/routes.py</code> file. That file is automatically imported into the main application, so there are no more changes needed. Check out the routes in <code>resources/user.py</code> for a good example. Note that the routes contain minimal actual logic, instead they call the required functionality from the Manager (UserManager in <code>managers/user.py</code> in this case).</p> <p>app/schemas/ - Contains all <code>request</code> and <code>response</code> schemas used in the application, as usual with a separate file for each group. The Schemas are defined as Pydantic Classes.</p> <p>app/templates/ - Any HTML templates. We have one by default - used only when the root of the API is accessed using a Web Browser (otherwise a simple informational JSON response is returned). You can edit the template in <code>templates/index.html</code> for your own API.</p>"},{"location":"project-organization/#project-root","title":"Project Root","text":""},{"location":"project-organization/#directories_1","title":"Directories","text":"<p>docs/ - Contains the project documentation in Markdown format. This includes user guides, development documentation, and API reference materials. Documentation is built using MkDocs and can be viewed locally with <code>mkdocs serve</code>.</p> <p>tests/ - Contains the complete test suite organized into subdirectories:</p> <ul> <li><code>tests/unit/</code> - Unit tests for individual components and managers</li> <li><code>tests/integration/</code> - Integration tests for API endpoints and workflows</li> <li><code>tests/cli/</code> - Tests for CLI commands</li> </ul> <p>All tests use pytest and can be run with <code>pytest</code> or <code>poe test</code>.</p> <p>static/ - Any static files used by HTML templates for example CSS or JS files.</p> <p>prometheus-test/ - Optional Docker Compose setup for local Prometheus server testing. This directory is not part of the application but provides developer convenience for testing metrics collection locally. Contains <code>docker-compose.yml</code> and <code>prometheus.yml</code> configuration files. Run <code>docker-compose up</code> in this directory to start a Prometheus instance that scrapes the application's <code>/metrics</code> endpoint.</p>"},{"location":"quick-start/","title":"Quick Start","text":"<p>Get the FastAPI Template running locally in just a few minutes.</p>"},{"location":"quick-start/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.10 or higher</li> <li>uv package manager (recommended)</li> <li>PostgreSQL 17+ running locally</li> </ul> <p>Don't have PostgreSQL?</p> <p>You can use Docker to run PostgreSQL quickly: <pre><code>docker run --name fastapi-postgres -e POSTGRES_PASSWORD=postgres \\\n  -p 5432:5432 -d postgres:18\n</code></pre></p>"},{"location":"quick-start/#1-clone-and-setup-1-minute","title":"1. Clone and Setup (1 minute)","text":"<pre><code># Clone the repository\ngit clone https://github.com/seapagan/fastapi-template.git\ncd fastapi-template\n\n# Install dependencies using uv (recommended)\nuv sync\n\n# Activate the virtual environment\nsource .venv/bin/activate  # Linux/Mac\n# or\n.venv\\Scripts\\activate  # Windows\n</code></pre> <p>Alternative: Using pip</p> <p>If you prefer pip and requirements.txt: <pre><code>python -m venv venv\nsource venv/bin/activate  # Linux/Mac\n# or\nvenv\\Scripts\\activate  # Windows\n\npip install -r requirements.txt\n</code></pre></p>"},{"location":"quick-start/#2-environment-configuration-1-minute","title":"2. Environment Configuration (1 minute)","text":"<pre><code># Copy the example environment file\ncp .env.example .env\n\n# Edit .env and set these required variables:\n# - SECRET_KEY (generate with: openssl rand -hex 32)\n# - DB_USER (your PostgreSQL username, default: postgres)\n# - DB_PASSWORD (your PostgreSQL password)\n# - DB_ADDRESS (default: localhost)\n# - DB_PORT (default: 5432)\n# - DB_NAME (default: fastapi_template)\n</code></pre> <p>Minimum required <code>.env</code> configuration: <pre><code>SECRET_KEY=your-secret-key-here-use-openssl-rand-hex-32\nDB_USER=postgres\nDB_PASSWORD=postgres\nDB_NAME=fastapi_template\n</code></pre></p>"},{"location":"quick-start/#3-database-setup-30-seconds","title":"3. Database Setup (30 seconds)","text":"<pre><code># Initialize the database with Alembic migrations\napi-admin db init --force\n</code></pre> <p>Database Initialized</p> <p>All tables are now created and ready for use.</p>"},{"location":"quick-start/#4-create-your-first-user-1-minute","title":"4. Create Your First User (1 minute)","text":"<p>Create an admin user account to access admin-only features:</p> <pre><code># Create an admin user interactively\napi-admin user create --admin\n\n# You'll be prompted for:\n# - Email address\n# - Password (minimum 8 characters)\n# - First name\n# - Last name\n</code></pre> <p>Remember Your Credentials</p> <p>Save the email and password you just created - you'll need them to:</p> <ul> <li>Access the admin panel at <code>/admin</code></li> <li>Use admin-only API endpoints</li> <li>Authenticate in the Swagger docs</li> </ul>"},{"location":"quick-start/#5-run-the-server-30-seconds","title":"5. Run the Server (30 seconds)","text":"<pre><code># Start the FastAPI development server\napi-admin serve\n</code></pre> <p>You should see output like: <pre><code>INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)\nINFO:     Started reloader process\nINFO:     Started server process\nINFO:     Waiting for application startup.\nINFO:     Application startup complete.\n</code></pre></p> <p>The server is now running at:</p> <ul> <li>API: http://localhost:8000</li> <li>Interactive Docs (Swagger): http://localhost:8000/docs</li> <li>Alternative Docs (ReDoc): http://localhost:8000/redoc</li> </ul>"},{"location":"quick-start/#6-authenticate-to-access-protected-endpoints","title":"6. Authenticate to Access Protected Endpoints","text":"<p>Most endpoints require authentication. Here's how to login and use your JWT token:</p>"},{"location":"quick-start/#login-via-console-curl","title":"Login via Console (curl)","text":"<pre><code># Login with your admin credentials from step 4\ncurl -X POST http://localhost:8000/login/ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"email\": \"your-email@example.com\",\n    \"password\": \"your-password\"\n  }'\n</code></pre> <p>This returns a JSON response with your tokens: <pre><code>{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"refresh\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}\n</code></pre></p> <p>Using the JWT token:</p> <pre><code># Save your token to a variable\nTOKEN=\"your-token-here\"\n\n# Access protected endpoints with the Authorization header\ncurl http://localhost:8000/users/me \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre> <p>Token Expiry</p> <p>Tokens expire after 2 hours (configurable via <code>ACCESS_TOKEN_EXPIRE_MINUTES</code>). Use the refresh token to get a new token without re-entering credentials.</p>"},{"location":"quick-start/#login-via-swagger-ui","title":"Login via Swagger UI","text":"<ol> <li>Open http://localhost:8000/docs</li> <li>Find the <code>POST /login/</code> endpoint and expand it</li> <li>Click \"Try it out\"</li> <li>Enter your credentials in the request body:    <pre><code>{\n  \"email\": \"your-email@example.com\",\n  \"password\": \"your-password\"\n}\n</code></pre></li> <li>Click \"Execute\"</li> <li>Copy the <code>token</code> from the response (the long string starting with <code>eyJ...</code>)</li> <li>Click the \"Authorize\" button at the top right of the page</li> <li>In the \"HTTPBearer\" field, paste your token</li> <li>Click \"Authorize\", then \"Close\"</li> </ol> <p>Now you can test any protected endpoint directly from the Swagger UI! The authentication token will be automatically included in all requests.</p> <p>You're Authenticated!</p> <p>The lock icons next to endpoints will now show as locked/closed, indicating you're authenticated. You can now test protected endpoints like:</p> <ul> <li><code>GET /users/me</code> - Get your user profile</li> <li><code>GET /users/</code> - List all users (admin only)</li> <li><code>POST /api-keys/</code> - Create API keys</li> <li>And more!</li> </ul>"},{"location":"quick-start/#7-test-it-30-seconds","title":"7. Test It (30 seconds)","text":"<p>Now that you're authenticated, you can test the protected endpoints:</p>"},{"location":"quick-start/#test-via-curl","title":"Test via curl","text":"<pre><code># Get the root endpoint (returns welcome message - no auth required)\ncurl http://localhost:8000/\n\n# Get all users (requires authentication)\ncurl http://localhost:8000/users/ \\\n  -H \"Authorization: Bearer $TOKEN\"\n\n# Get your own profile (requires authentication)\ncurl http://localhost:8000/users/me \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"quick-start/#test-via-browser","title":"Test via Browser","text":"<p>Open http://localhost:8000/docs in your browser to explore the interactive API documentation. Since you've already authenticated in Section 6, you can now:</p> <ul> <li>View all available endpoints</li> <li>Test protected API calls directly from the browser</li> <li>See request/response schemas</li> <li>Try different endpoints with your authenticated session</li> </ul>"},{"location":"quick-start/#optional-populate-with-sample-data","title":"Optional: Populate with Sample Data","text":"<p>If you want to test with multiple users without creating them manually, you can populate the database with sample data:</p> <pre><code># Create 10 random test users (2-3 will be admins)\napi-admin db populate --count 10\n</code></pre> <p>This is useful for:</p> <ul> <li>Testing user management features</li> <li>Exploring the admin panel with multiple users</li> <li>Performance testing with realistic data</li> </ul> <p>Note</p> <p>Sample users will have randomly generated credentials. Use <code>api-admin user list</code> to view all users and their details (passwords are hashed and not shown).</p>"},{"location":"quick-start/#next-steps","title":"Next Steps","text":""},{"location":"quick-start/#learn-the-basics","title":"Learn the Basics","text":"<ul> <li>Configuration Guide - Understand all environment variables</li> <li>User Management - Manage users via CLI and API</li> <li>API Keys - Create and use API keys for authentication</li> <li>Admin Panel - Access the web-based admin interface</li> </ul>"},{"location":"quick-start/#customize-your-api","title":"Customize Your API","text":"<ul> <li>Project Organization - Understand the codebase structure</li> <li>Adding Custom Endpoints - Build your first custom endpoint</li> <li>Customization - Customize API metadata and templates</li> </ul>"},{"location":"quick-start/#deploy-to-production","title":"Deploy to Production","text":"<ul> <li>Deployment Guide - Deploy to various platforms</li> <li>Metrics &amp; Monitoring - Set up observability</li> </ul>"},{"location":"quick-start/#troubleshooting","title":"Troubleshooting","text":""},{"location":"quick-start/#database-connection-errors","title":"Database Connection Errors","text":"<p>If you see database connection errors:</p> <ol> <li> <p>Check PostgreSQL is running:    <pre><code># On Linux/Mac\nsudo systemctl status postgresql\n\n# Using Docker\ndocker ps | grep postgres\n</code></pre></p> </li> <li> <p>Verify your <code>.env</code> database settings match your PostgreSQL configuration</p> </li> <li> <p>Ensure the database exists:    <pre><code># Connect to PostgreSQL and create database if needed\npsql -U postgres\nCREATE DATABASE fastapi_template;\n</code></pre></p> </li> </ol>"},{"location":"quick-start/#port-already-in-use","title":"Port Already in Use","text":"<p>If port 8000 is already in use, you can specify a different port:</p> <pre><code>api-admin serve --port 8080\n</code></pre>"},{"location":"quick-start/#module-not-found-errors","title":"Module Not Found Errors","text":"<p>If you see import errors, ensure you've activated your virtual environment:</p> <pre><code># Using uv\nsource .venv/bin/activate  # Linux/Mac\n.venv\\Scripts\\activate     # Windows\n\n# Using pip/venv\nsource venv/bin/activate  # Linux/Mac\nvenv\\Scripts\\activate     # Windows\n</code></pre>"},{"location":"quick-start/#need-help","title":"Need Help?","text":"<ul> <li>Check the full documentation</li> <li>Review configuration options</li> <li>Open an issue on GitHub</li> </ul>"},{"location":"quick-start/#whats-next","title":"What's Next?","text":"<p>You now have a fully functional FastAPI application running! Here are some suggestions:</p> <ol> <li>Explore the API docs at http://localhost:8000/docs</li> <li>Create your first custom endpoint by following the tutorials</li> <li>Set up your IDE with linting and type checking</li> <li>Read the architecture guide to understand how everything works together</li> <li>Start building your own API features!</li> </ol> <p>Happy coding! \ud83d\ude80</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and their solutions when working with the FastAPI Template.</p>"},{"location":"troubleshooting/#database-issues","title":"Database Issues","text":""},{"location":"troubleshooting/#database-connection-refused","title":"Database Connection Refused","text":"<p>Error: <pre><code>sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not connect to server: Connection refused\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Check PostgreSQL is running: <pre><code># Linux/Mac\nsudo systemctl status postgresql\n\n# Using Docker\ndocker ps | grep postgres\n</code></pre></p> </li> <li> <p>Verify database exists: <pre><code>psql -U postgres -l\n# If missing, create it:\npsql -U postgres\nCREATE DATABASE fastapi_template;\n</code></pre></p> </li> <li> <p>Check <code>.env</code> settings match your database:</p> </li> <li><code>DB_USER</code>, <code>DB_PASSWORD</code> must match PostgreSQL credentials</li> <li><code>DB_ADDRESS</code> should be <code>localhost</code> for local dev</li> <li><code>DB_PORT</code> should be <code>5432</code> (default PostgreSQL port)</li> </ol>"},{"location":"troubleshooting/#migration-errors","title":"Migration Errors","text":"<p>Error: <pre><code>alembic.util.exc.CommandError: Can't locate revision identified by 'xxxxx'\n</code></pre></p> <p>Solution: Your migration history is out of sync. For development: <pre><code># Clear and reinitialize (WARNING: Deletes all data)\napi-admin db init --force\n</code></pre></p> <p>For production, see Database Migration Strategy.</p>"},{"location":"troubleshooting/#application-startup-issues","title":"Application Startup Issues","text":""},{"location":"troubleshooting/#port-already-in-use","title":"Port Already in Use","text":"<p>Error: <pre><code>OSError: [Errno 48] Address already in use\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Find process using port 8000: <pre><code># Linux/Mac\nlsof -i :8000\n\n# Kill the process\nkill -9 &lt;PID&gt;\n</code></pre></p> </li> <li> <p>Use a different port: <pre><code>api-admin serve --port 8080\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#module-not-found-errors","title":"Module Not Found Errors","text":"<p>Error: <pre><code>ModuleNotFoundError: No module named 'app'\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Activate virtual environment: <pre><code># Using uv\nsource .venv/bin/activate  # Linux/Mac\n.venv\\Scripts\\activate     # Windows\n\n# Using pip/venv\nsource venv/bin/activate   # Linux/Mac\nvenv\\Scripts\\activate      # Windows\n</code></pre></p> </li> <li> <p>Reinstall dependencies: <pre><code>uv sync  # or pip install -r requirements.txt\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#email-issues","title":"Email Issues","text":""},{"location":"troubleshooting/#password-reset-not-sending-emails","title":"Password Reset Not Sending Emails","text":"<p>Problem: Clicked \"forgot password\" but no email arrives.</p> <p>Solutions:</p> <ol> <li>Check email is configured in <code>.env</code>:</li> <li>All <code>MAIL_*</code> variables must be set</li> <li> <p>Test with: <code>MAIL_SERVER</code>, <code>MAIL_PORT</code>, <code>MAIL_USERNAME</code>, <code>MAIL_PASSWORD</code></p> </li> <li> <p>Check spam folder - emails may be flagged as spam</p> </li> <li> <p>Verify SMTP credentials: <pre><code># Test connection manually\ntelnet smtp.gmail.com 587\n</code></pre></p> </li> <li> <p>For development: Check application logs at <code>LOG_PATH</code> for email errors</p> </li> </ol>"},{"location":"troubleshooting/#email-settings-valid-but-still-not-working","title":"Email Settings Valid But Still Not Working","text":"<p>Common issues:</p> <ul> <li>Gmail: Requires \"App Password\" not your regular password</li> <li>Office365: May require OAuth2 instead of SMTP</li> <li>2FA enabled: Need app-specific password</li> <li>Check <code>MAIL_STARTTLS</code> and <code>MAIL_SSL_TLS</code> settings match your provider</li> </ul>"},{"location":"troubleshooting/#authentication-issues","title":"Authentication Issues","text":""},{"location":"troubleshooting/#that-token-is-invalid-on-every-request","title":"\"That token is Invalid\" on Every Request","text":"<p>Causes:</p> <ol> <li>SECRET_KEY changed - All existing tokens invalidated</li> <li>Expected after changing SECRET_KEY</li> <li> <p>Users must login again</p> </li> <li> <p>Clock skew - Server time incorrect    <pre><code># Check server time\ndate\n</code></pre></p> </li> <li> <p>Token expired - Default 2 hours</p> </li> <li>Use refresh token to get new access token</li> <li>See Authentication Flow</li> </ol>"},{"location":"troubleshooting/#cannot-access-admin-panel","title":"Cannot Access Admin Panel","text":"<p>Error: 404 Not Found on <code>/admin</code></p> <p>Solutions:</p> <ol> <li> <p>Check admin panel is enabled in <code>.env</code>: <pre><code>ADMIN_PAGES_ENABLED=True\n</code></pre></p> </li> <li> <p>Verify route in settings (if customized):    <pre><code>ADMIN_PAGES_ROUTE=/admin\n</code></pre></p> </li> <li> <p>Restart application after changing settings</p> </li> </ol>"},{"location":"troubleshooting/#metrics-issues","title":"Metrics Issues","text":""},{"location":"troubleshooting/#metrics-returns-404","title":"<code>/metrics</code> Returns 404","text":"<p>Cause: Metrics not enabled.</p> <p>Solution: Add to <code>.env</code>: <pre><code>METRICS_ENABLED=true\n</code></pre></p> <p>Restart the application.</p>"},{"location":"troubleshooting/#prometheus-not-scraping-metrics","title":"Prometheus Not Scraping Metrics","text":"<p>Solutions:</p> <ol> <li> <p>Check <code>/metrics</code> endpoint is accessible: <pre><code>curl http://localhost:8000/metrics\n</code></pre></p> </li> <li> <p>Verify Prometheus configuration has correct target:    <pre><code>scrape_configs:\n  - job_name: 'fastapi-template'\n    static_configs:\n      - targets: ['localhost:8000']\n</code></pre></p> </li> <li> <p>Check firewall isn't blocking Prometheus</p> </li> </ol>"},{"location":"troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"troubleshooting/#application-running-slowly","title":"Application Running Slowly","text":"<p>Common causes:</p> <ol> <li> <p>DEBUG logging in production: <pre><code>LOG_LEVEL=INFO  # or WARNING, not DEBUG\n</code></pre></p> </li> <li> <p>Database not indexed - Check slow query logs</p> </li> <li> <p>No connection pooling - Consider adding pgbouncer for production</p> </li> </ol>"},{"location":"troubleshooting/#high-memory-usage","title":"High Memory Usage","text":"<p>Solutions:</p> <ol> <li> <p>Check log retention: <pre><code>LOG_RETENTION=7 days  # Don't keep logs forever\nLOG_COMPRESSION=zip   # Compress rotated logs\n</code></pre></p> </li> <li> <p>Review metrics collection - May need sampling for high-traffic apps</p> </li> </ol>"},{"location":"troubleshooting/#development-issues","title":"Development Issues","text":""},{"location":"troubleshooting/#tests-failing","title":"Tests Failing","text":"<p>Error: Database connection errors in tests</p> <p>Solutions:</p> <ol> <li> <p>Ensure test database exists: <pre><code>psql -U postgres\nCREATE DATABASE fastapi_template_tests;\n</code></pre></p> </li> <li> <p>Check <code>TEST_DB_NAME</code> in <code>.env</code> matches test database</p> </li> <li> <p>Run tests with pytest: <pre><code>pytest\n# or\npoe test\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#pre-commit-hooks-failing","title":"Pre-commit Hooks Failing","text":"<p>Solutions:</p> <ol> <li> <p>Install prek hooks: <pre><code>prek install\n</code></pre></p> </li> <li> <p>Update hooks: <pre><code>prek autoupdate\n</code></pre></p> </li> <li> <p>Skip hooks temporarily (not recommended):    <pre><code>git commit --no-verify\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#still-having-issues","title":"Still Having Issues?","text":"<p>If your problem isn't listed here:</p> <ol> <li>Check application logs at <code>LOG_PATH</code> (default: <code>./logs/api.log</code>)</li> <li>Enable DEBUG logging temporarily:    <pre><code>LOG_LEVEL=DEBUG\nLOG_CATEGORIES=ALL\n</code></pre></li> <li>Review the configuration guide for all settings</li> <li>Open an issue on GitHub with:</li> <li>Error message (full traceback)</li> <li>Relevant log entries</li> <li>Your environment (OS, Python version)</li> <li>Steps to reproduce</li> </ol>"},{"location":"tutorials/","title":"Tutorials","text":"<p>Tutorials</p> <p>To be Written</p>"},{"location":"customization/meta/","title":"Metadata","text":""},{"location":"customization/meta/#customize-the-metadata","title":"Customize the Metadata","text":"<p>By default the Template Title, Description, Author and similar is set to my details. Changing this is very easy though, and there are 2 ways you can do.</p>"},{"location":"customization/meta/#manually","title":"Manually","text":"<p>Metadata is stored in the <code>app/config/metadata.py</code> file and this can be edited by hand if desired:</p> <pre><code>from app.config.helpers import MetadataBase\n\ncustom_metadata = MetadataBase(\n    title=\"API Template\",\n    name=\"api-template\",\n    description=\"Run 'api-admin custom metadata' to change this information.\",\n    repository=\"https://github.com/seapagan/fastapi-template\",\n    license_info={\n        \"name\": \"MIT\",\n        \"url\": \"https://opensource.org/licenses/MIT\",\n    },\n    contact={\n        \"name\": \"Grant Ramsay (seapagan)\",\n        \"url\": \"https://www.gnramsay.com\",\n    },\n    email=\"seapagan@gmail.com\",\n    year=\"2024\",\n)\n</code></pre> <p>You can change the values in this dictionary as needed. You should also change the name, description and authors in the <code>pyproject.toml</code> file.</p> <p>For the License URL, you can find a list in the <code>config/helpers.py</code></p>"},{"location":"customization/meta/#using-the-provided-configuration-tool","title":"Using the provided configuration tool","text":"<p>The <code>api-admin</code> command can also do this for you, asking for the values at the command line and automatically updating both files:</p> <pre><code>$ api-admin custom metadata\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 api-template configuration tool 0.6.0 \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nEnter your API title [API Template]:\nEnter the project Name [api-template]:\nEnter the description [Run 'api-admin custom metadata' to change this information.]:\nVersion Number (use * to reset to '0.0.1') [0.5.4]:\nURL to your Repository [https://github.com/seapagan/fastapi-template]:\n\nChoose a license from the following options:\nApache2, BSD3, BSD2, GPL, LGPL, MIT, MPL2, CDDL, EPL\nYour Choice of License? [MIT]:\n\nAuthor name or handle [Grant Ramsay (seapagan)]:\nContact Email address [seapagan@gmail.com]:\nAuthor Website [https://www.gnramsay.com]:\n\nYou have entered the following data:\nTitle       : API Template\nName        : api-template\nDescription : Run 'api-admin custom metadata' to change this information.\nVersion     : 0.5.4\nRepository  : https://github.com/seapagan/fastapi-template\nLicense     : MIT\nAuthor      : Grant Ramsay (seapagan)\nEmail       : seapagan@gmail.com\nWebsite     : https://www.gnramsay.com\n(C) Year    : 2024\n\nIs this Correct? [Y/n]:\n\n-&gt; Writing out Metadata .... Done!\n\n-&gt; Remember to RESTART the API if it is running.\n</code></pre> <p>This will also put in the correct License URL link automatically.</p>"},{"location":"customization/templates/","title":"Customize the Templates","text":"<p>There are several HTML templates used at this time, all are stored in the <code>templates/</code> folder or a subfolder of this.</p> <ul> <li><code>app/templates/index.html</code> - This template is shown when the root of the API is visited using a web browser instead of an API call. Use it to display vasic details about your API and usage instructions, point to the documentation etc. The default output is below for an example:</li> </ul> <p></p> <ul> <li><code>app/templates/email</code> - this folder contains HTML Email templates, currently only basic placeholders.</li> <li><code>welcome.html</code>. This is sent to a new User when they sign up</li> </ul>"},{"location":"deployment/deployment/","title":"Deployment","text":""},{"location":"deployment/deployment/#production-environment-checklist","title":"Production Environment Checklist","text":"<p>Before deploying to production, ensure you've configured all critical settings properly. Missing or incorrect configuration can lead to security vulnerabilities or broken functionality.</p>"},{"location":"deployment/deployment/#critical-security-settings","title":"Critical Security Settings","text":"<p>Required - Security Risk if Skipped</p> <p>These settings are critical for security. Never deploy without configuring them.</p> <ul> <li>SECRET_KEY \u26a0\ufe0f MUST CHANGE</li> <li>Generate a new secret key: <code>openssl rand -hex 32</code></li> <li>Never use the default or example value</li> <li>Keep this secret - don't commit to version control</li> <li> <p>Used for JWT token signing and session security</p> </li> <li> <p>CORS_ORIGINS</p> </li> <li>Don't leave as <code>*</code> in production</li> <li>Set to your actual frontend domain(s)</li> <li>Example: <code>CORS_ORIGINS=https://app.example.com,https://www.example.com</code></li> <li>Multiple origins separated by commas</li> </ul>"},{"location":"deployment/deployment/#database-configuration","title":"Database Configuration","text":"<ul> <li>DB_USER, DB_PASSWORD, DB_NAME - Must match your production database</li> <li>DB_ADDRESS, DB_PORT - Point to your production database server</li> <li>Database must exist - Create it before running migrations</li> <li>Run migrations - <code>api-admin db init --force</code> (see Database Migration Strategy below)</li> <li>Consider using connection pooling for better performance</li> <li>Enable SSL/TLS for database connections if available</li> </ul>"},{"location":"deployment/deployment/#email-settings-required-for-password-reset","title":"Email Settings (Required for Password Reset)","text":"<p>Email Required in Production</p> <p>Password reset and verification emails won't work without proper email configuration.</p> <ul> <li>MAIL_USERNAME, MAIL_PASSWORD - SMTP credentials</li> <li>MAIL_FROM - Sender email address (e.g., <code>noreply@yourdomain.com</code>)</li> <li>MAIL_SERVER, MAIL_PORT - SMTP server details (usually port 587 for TLS)</li> <li>MAIL_FROM_NAME - Friendly sender name</li> <li>Test email functionality before going live</li> </ul>"},{"location":"deployment/deployment/#admin-panel-configuration","title":"Admin Panel Configuration","text":"<ul> <li>ADMIN_PAGES_ENABLED - Set to <code>True</code> if using admin panel</li> <li>ADMIN_PAGES_ENCRYPTION_KEY - Generate with:   <pre><code>python -c 'from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())'\n</code></pre></li> <li>Leave empty to auto-generate (regenerates on each restart - sessions lost)</li> <li>Set explicitly for persistent sessions across restarts</li> <li>ADMIN_PAGES_TIMEOUT - Session timeout in seconds (default: 86400 = 24 hours)</li> </ul>"},{"location":"deployment/deployment/#observability-monitoring","title":"Observability &amp; Monitoring","text":"<ul> <li>METRICS_ENABLED - Set to <code>true</code> for production monitoring</li> <li>Enables <code>/metrics</code> endpoint for Prometheus scraping</li> <li>Essential for tracking performance and errors</li> <li>See Metrics Documentation</li> <li>Configure your monitoring system to scrape <code>/metrics</code></li> <li>Set up health check monitoring on <code>/heartbeat</code></li> </ul>"},{"location":"deployment/deployment/#logging-configuration","title":"Logging Configuration","text":"<ul> <li>LOG_LEVEL - Set to <code>INFO</code> or <code>WARNING</code> in production (not <code>DEBUG</code>)</li> <li>LOG_PATH - Ensure path exists and is writable</li> <li>LOG_ROTATION - Consider <code>1 day</code> or <code>500 MB</code> for production</li> <li>LOG_RETENTION - Balance between disk space and audit requirements</li> <li>LOG_COMPRESSION - Use <code>zip</code> or <code>gz</code> to save disk space</li> <li>LOG_CATEGORIES - Recommend <code>ERRORS,AUTH,DATABASE,REQUESTS</code> for production</li> </ul>"},{"location":"deployment/deployment/#optional-settings","title":"Optional Settings","text":"<ul> <li>BASE_URL - Your production API URL (e.g., <code>https://api.example.com</code>)</li> <li>FRONTEND_URL - If using custom frontend for password reset</li> <li>API_ROOT - If serving API from subpath (e.g., <code>/api/v1</code>)</li> <li>ACCESS_TOKEN_EXPIRE_MINUTES - Default 120 (2 hours), adjust as needed</li> </ul>"},{"location":"deployment/deployment/#pre-deployment-verification","title":"Pre-Deployment Verification","text":"<p>Before going live, verify:</p> <ul> <li>[ ] SECRET_KEY is unique and secure</li> <li>[ ] Database is accessible and migrated</li> <li>[ ] Email sending works (test password reset)</li> <li>[ ] CORS is configured for your frontend domain(s)</li> <li>[ ] Admin panel accessible (if enabled)</li> <li>[ ] Metrics endpoint returns data (if enabled)</li> <li>[ ] Logs are being written correctly</li> <li>[ ] At least one admin user exists</li> <li>[ ] SSL/TLS certificate is valid</li> <li>[ ] Health check endpoint (<code>/heartbeat</code>) responding</li> <li>[ ] All external dependencies (database, SMTP) are accessible</li> </ul>"},{"location":"deployment/deployment/#deploying-to-production","title":"Deploying to Production","text":"<p>There are quite a few ways to deploy a FastAPI app to production. There is a very good discussion about this on the FastAPI Deployment Guide which covers using Uvicorn, Gunicorn and Containers.</p> <p>Environment Setup</p> <p>Whichever method you choose, you still need to set up a virtual environment, install all the dependencies, setup your <code>.env</code> file (or use Environment variables if your hosting provider uses these - for example Railway or Heroku) and set up and migrate your Database.</p>"},{"location":"deployment/deployment/#database-migration-strategy","title":"Database Migration Strategy","text":"<p>Proper database migration management is crucial for production deployments.</p>"},{"location":"deployment/deployment/#initial-deployment","title":"Initial Deployment","text":"<ol> <li> <p>Create the database on your production server:    <pre><code>psql -U postgres\nCREATE DATABASE your_production_db;\n</code></pre></p> </li> <li> <p>Run migrations to create tables:    <pre><code>api-admin db init --force\n</code></pre></p> </li> <li> <p>Create your first admin user:    <pre><code>api-admin user create --admin\n</code></pre></p> </li> </ol>"},{"location":"deployment/deployment/#updating-an-existing-deployment","title":"Updating an Existing Deployment","text":"<p>When deploying code changes that include new migrations:</p> <p>Critical - Do NOT use 'db init' on existing databases</p> <p>Never run <code>api-admin db init --force</code> on an existing production database - it will clear all data! Use <code>api-admin db upgrade</code> instead.</p> <ol> <li> <p>Backup your database first (critical!):    <pre><code>pg_dump -U postgres your_production_db &gt; backup_$(date +%Y%m%d_%H%M%S).sql\n</code></pre></p> </li> <li> <p>Test migrations locally on a copy of production data if possible</p> </li> <li> <p>Put application in maintenance mode (if zero-downtime is not required)</p> </li> <li> <p>Pull latest code and install dependencies:    <pre><code>git pull origin main\nuv sync  # or pip install -r requirements.txt\n</code></pre></p> </li> <li> <p>Run migrations (applies new migrations only):    <pre><code>api-admin db upgrade\n</code></pre></p> </li> <li> <p>Restart the application</p> </li> <li> <p>Verify the application is working correctly</p> </li> </ol>"},{"location":"deployment/deployment/#rollback-procedure","title":"Rollback Procedure","text":"<p>If a migration fails or causes issues:</p> <ol> <li> <p>Restore from backup:    <pre><code>psql -U postgres your_production_db &lt; backup_YYYYMMDD_HHMMSS.sql\n</code></pre></p> </li> <li> <p>Revert to previous code version:    <pre><code>git checkout &lt;previous-commit&gt;\nuv sync\n</code></pre></p> </li> <li> <p>Restart the application</p> </li> </ol>"},{"location":"deployment/deployment/#best-practices","title":"Best Practices","text":"<ul> <li>Always backup before running migrations</li> <li>Test migrations on a staging environment first</li> <li>Review migration files generated by Alembic before deployment</li> <li>Plan for rollback - have a tested rollback procedure ready</li> <li>Monitor logs during and after migration</li> <li>Consider scheduled maintenance windows for complex migrations</li> </ul>"},{"location":"deployment/deployment/#managed-platform-options","title":"Managed Platform Options","text":"<p>These platforms offer straightforward FastAPI deployment with managed infrastructure:</p> <ul> <li>Railway - Simple deploys from GitHub, generous free tier, automatic HTTPS</li> <li>Fly.io - Edge deployment, global distribution, Dockerfile-based</li> <li>Render - Auto-deploy from Git, managed PostgreSQL, free tier available</li> <li>DigitalOcean App Platform - Managed platform with databases and scaling</li> <li>Heroku - Classic PaaS, easy deployment, many add-ons available</li> <li>Vercel - Serverless deployment, edge functions (requires ASGI adapter)</li> </ul> <p>All support PostgreSQL databases and environment variables. Refer to their documentation for FastAPI-specific deployment instructions.</p>"},{"location":"deployment/deployment/#self-hosted-deployment","title":"Self-Hosted Deployment","text":""},{"location":"deployment/deployment/#nginx","title":"Nginx","text":"<p>My Personal preference is to serve with Gunicorn, using uvicorn workers behind an Nginx proxy, though this does require you having your own server. There is a pretty decent tutorial on this at Vultr.</p>"},{"location":"deployment/deployment/#aws-lambda","title":"AWS Lambda","text":"<p>For deploying to AWS Lambda with API Gateway, there is a really excellent Medium post (and it's followup) Here</p>"},{"location":"deployment/deployment/#aws-elastic-beanstalk","title":"AWS Elastic Beanstalk","text":"<p>For AWS Elastic Beanstalk there is a very comprehensive tutorial at testdriven.io</p>"},{"location":"deployment/deployment/#docker-container","title":"Docker Container","text":"<p>Deploy a Docker container or Kubernetes cluster. There are many services which allow this including AWS, Google Cloud and more. See Develop with Docker in this documentation for how to containerize this project, and the Offical FastAPI docs section for more information.</p>"},{"location":"development/docker/","title":"Develop with Docker","text":"<p>PostgreSQL 18 Upgrade (Release 0.8.0)</p> <p>As of release <code>0.8.0</code>, we have upgraded PostgreSQL from version 17 to 18.1. This version is not compatible with existing PostgreSQL 17 databases.</p> <p>You will need to either:</p> <ol> <li>Delete and recreate the database volume:    <pre><code>docker compose down\ndocker volume rm api-db-data\ndocker compose up\n</code></pre></li> <li>Dump and reload your existing data before upgrading (see PostgreSQL    documentation for migration guides)</li> </ol>"},{"location":"development/docker/#python-and-postgresql-versions","title":"Python and PostgreSQL versions","text":"<p>Currently, the Docker configuration uses Python version <code>3.14</code> and PostgreSQL version <code>18.1</code> (or the latest patch version of each).</p> <p>Database Version Changes</p> <p>At times we will update the Docker configurations to use a newer version of PostgreSQL. Often, the newer version will be incompatible with the existing database, and you will need to create a new database or migrate the data.</p> <p>For example between releases <code>0.5.4</code> and <code>0.6.0</code> I updated the docker config to use PostgreSQL 17 instead of 15. In this case the existing database was not compatible.</p> <p>You have 3 options in this case:</p> <ol> <li>delete the docker volume <code>api-db-data</code> and just start again. This is fine    if you are only using docker for testing.</li> <li>change the <code>docker-compose.yml</code> to use the previous version of PostgreSQL    instead. In the case of <code>0.6.0</code> you can change back to <code>15.6-bullseye</code>.    This is on line 25 (as of version <code>0.6.0</code> anyway).</li> <li>log into the docker instance and migrate the data to version 17. There    are several guides for this if you search.</li> </ol>"},{"location":"development/docker/#run-a-server","title":"Run a Server","text":"<p>Docker containers can be used for testing the API during development just make sure that Docker is installed and you can use the built-in docker compose file:</p> <pre><code>docker compose up\n</code></pre> <p>This will by default run the server on http://localhost:8001, and reload after any change to the source code.</p> <p>Port Change from <code>8000</code> to <code>8001</code></p> <p>The default API port while running under Docker is <code>8001</code> to avoid conflicts with any other services you may have running or even a local session of this API. If you want to change this, you can do so by editing the <code>Dockerfile</code> and <code>docker-compose.yml</code> files.</p> <p>If you need more control, you can run <code>uvicorn</code> directly :</p> <pre><code>docker compose run --rm --service-ports api uvicorn --host 0.0.0.0 --port 8001 app.main:app --reload\n</code></pre> <p>The above command starts the server running on http://localhost:8001, and it will automatically reload when it detects any changes as you develop.</p> <p>Note: Neither of these are suitable to host a project in production, see the Deployment section for information.</p> <p>This compose file will also start a <code>PostgreSQL</code> database container and a <code>Redis</code> container. The PostgreSQL database port is exposed on <code>5433</code> and the default username and password are those set in your <code>.env</code> file.</p> <p>The <code>Redis</code> container also contains the <code>RedisInsight</code> web interface, which can be accessed at http://localhost:8002 for easy Redis database management.</p> <p>Note</p> <p>The Redis server is not currently used, but will be shortly when I add caching and rate-limiting.</p>"},{"location":"development/docker/#updating-dependencies","title":"Updating Dependencies","text":"<p>Every time a new dependency is installed a new image must be built:</p> <pre><code>docker compose build\n</code></pre>"},{"location":"development/docker/#database-administration","title":"Database Administration","text":"<p>The <code>api-admin</code> CLI tool is fully functional within the Docker container. You can run any <code>api-admin</code> commands using:</p> <pre><code>docker compose run --rm api api-admin &lt;command&gt;\n</code></pre> <p>Alternatively, you can use an external tool such as <code>pgAdmin4</code> to manage the database. Note that the database is exposed on port <code>5433</code> and the default username and password are those set in your <code>.env</code> file.</p>"},{"location":"development/docker/#local-file-changes","title":"Local File Changes","text":"<p>The Docker configuration uses volume mounting to ensure that any changes you make to your local files (including source code and tests) are immediately reflected in the running container. This means you don't need to rebuild the Docker image every time you make a code change.</p> <p>Your local <code>.venv</code> directory is protected and will not be affected by the container's virtual environment, so you can safely develop both locally and within Docker without conflicts.</p>"},{"location":"development/docker/#run-tests","title":"Run Tests","text":"<p>This API contains Unit and Integration tests using 'Pytest'</p> <p>To run these from within the Docker container use the <code>pytest</code> command with <code>docker compose</code>:</p> <pre><code>$ docker compose run --rm api pytest\nTest session starts (platform: linux, Python 3.11.3, pytest 7.3.1, pytest-sugar 0.9.7)\nUsing --randomly-seed=2090593217\n\n...\n\n tests/integration/test_protected_user_routes.py \u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\n tests/integration/test_user_routes.py \u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\n\n...\n\n\n------------------------------------------------------------\nTOTAL                            518     10    98%\nCoverage HTML written to dir htmlcov\n\n\nResults (36.04s):\n     157 passed\n       4 skipped\n</code></pre> <p>if you wish to disable the coverage display temporarily use:</p> <pre><code>$ docker compose run --rm api pytest --no-cov\n</code></pre> <p>You can also run the Unit or Integration tests independently using <code>docker compose run --rm api pytest -m unit</code> or <code>docker compose run --rm api pytest -m integration</code>.</p> <p>See the Pytest how-tos for more information</p>"},{"location":"development/documentation/","title":"Documentation Website","text":""},{"location":"development/documentation/#development","title":"Development","text":"<p>The documentation for this project is created using MkDocs with the Material for MkDocs theme.</p> <p>For this template, the docs website is served using GitHub Pages, though since it is just HTML and CSS you can host it from any provider you choose.</p> <p>Source for this is stored in the <code>docs</code> folder off the root of the project, and consists of Markdown files. The main control file is <code>mkdocs.yml</code> in the root.</p> <p>To help with documentation development you can run a docs server on http://localhost:9000 using the below command :</p> <pre><code>$ poe docs:serve\nPoe =&gt; mkdocs serve -w TODO.md -w CHANGELOG.md -w CONTRIBUTING.md -w BUGS.md\nINFO    -  Building documentation...\nINFO    -  Cleaning site directory\nINFO    -  Documentation built in 1.72 seconds\nINFO    -  [11:09:51] Watching paths for changes: 'docs', 'mkdocs.yml', 'TODO.md', 'CHANGELOG.md', 'CONTRIBUTING.md', 'BUGS.md'\nINFO    -  [11:09:51] Serving on http://127.0.0.1:9000/\n</code></pre> <p>You could run the server directly using <code>mkdocs serve</code>, but the above command will also watch for changes to the <code>TODO.md</code>, <code>CHANGELOG.md</code>, <code>CONTRIBUTING.md</code> and <code>BUGS.md</code> files, and will automatically rebuild the site when they change.</p> <p>Note</p> <p>This command will not auto-generate the OpenAPI schema, so you will need to run the below command first if your schema has changed :</p> <pre><code>$ poe openapi\n</code></pre> <p>The site is still very much a work in progress, and any PR's to add information will be gratefully received. The planned general layout and format can be seen in the <code>mkdocs.yml</code> file.</p> <p>If you want the site to be opened to your local network (ie to test on a mobile or another local device), then you can use the below command :</p> <pre><code>$ poe docs:serve:all\n</code></pre> <p>This will run the <code>mkdocs serve</code> command, but will also open the site on your local network. You can then access the site on your other device using the IP address of your machine, and the port number shown in the output of the command.</p>"},{"location":"development/documentation/#regenerate-the-openapi-documentation","title":"Regenerate the OpenAPI Documentation","text":"<p>The OpenAPI schema is needed for the documentation, and can be generated from the existing routes. To do this, run the below command :</p> <pre><code>$ api-admin docs openapi --prefix=docs/reference\n</code></pre> <p>For ease of use this is also run automatically when the docs are built or published (but not when using the <code>mkdocs serve</code> command above).</p> <p>You can also run the above command easier using the <code>poe</code> command :</p> <pre><code>$ poe openapi\n</code></pre>"},{"location":"development/documentation/#build-the-documentation","title":"Build the Documentation","text":"<p>You can create a production-ready version of the site by using the <code>build</code> command:</p> <pre><code>$ poe docs:build\nINFO     -  Cleaning site directory\nINFO     -  Building documentation to directory: /home/seapagan/data/work/own/fastapi-template/site\nINFO     -  Documentation built in 0.95 seconds\n</code></pre> <p>This will create a static website in the <code>site</code> folder which you can then upload to the hosting provider of your choice. See the next section if you are using GitHub Pages.</p>"},{"location":"development/documentation/#publish-to-github-pages","title":"Publish to GitHub Pages","text":"<p>When you are happy with the docs, they can be published automatically to GitHub Pages using the below command :</p> <pre><code>$ poe docs:publish\n</code></pre> <p>This command will automatically build the docs, and then push the <code>site</code> folder to GitHub. It will also auto-generate the OpenAPI schema as part of the build.</p> <p>Note that only someone with WRITE access to the repository can do this.</p>"},{"location":"development/local/","title":"Local Development","text":""},{"location":"development/local/#run-a-server","title":"Run a Server","text":"<p>The uvicorn ASGI server is automatically installed when you install the project dependencies. This can be used for testing the API during development. There is a built-in command to run this easily :</p> <pre><code>$ api-admin serve\n</code></pre> <p>This will by default run the server on http://localhost:8000, and reload after any change to the source code. You can add options to change this</p> <pre><code>$ api-admin serve --help\n\nUsage: api-admin serve [OPTIONS]\n\n  Run a development server from the command line.\n\n  This will auto-refresh on any changes to the source in real-time.\n\nOptions:\n  --port   -p   INTEGER   Define the port to run the server on  [default: 8000]\n  --host   -h   TEXT      Define the interface to run the server on.  [default:\n                          localhost]\n  --reload --no-reload    Enable auto-reload on code changes [default: True]\n  --help                  Show this message and exit.\n</code></pre> <p>If you need more control, you can run <code>uvicorn</code> directly :</p> <pre><code>uvicorn app.main:app --reload\n</code></pre> <p>The above command starts the server running on http://localhost:8000, and it will automatically reload when it detects any changes as you develop.</p> <p>Note: Neither of these are suitable to host a project in production, see the Deployment section for information.</p>"},{"location":"development/local/#run-tests","title":"Run Tests","text":"<p>This API has Unit and Integration tests using 'Pytest'</p> <p>Database and Environment Setup</p> <p>Before running tests, you MUST have a valid <code>.env</code> file with the following required settings:</p> <ul> <li><code>SECRET_KEY</code> - Must be at least 32 characters long</li> <li><code>DB_USER</code> - Your PostgreSQL database username</li> <li><code>DB_PASSWORD</code> - Your PostgreSQL database password</li> <li><code>DB_ADDRESS</code> - Database host (usually <code>localhost</code>)</li> <li><code>DB_PORT</code> - Database port (usually <code>5432</code>)</li> <li><code>DB_NAME</code> - Your production database name</li> <li><code>TEST_DB_NAME</code> - Your test database name (defaults to <code>api-template-test</code>,   recommended to set explicitly)</li> </ul> <p>Tests will use the same database credentials (DB_USER/DB_PASSWORD) but connect to the TEST_DB_NAME database instead. Do not use a production database for testing as the test database will be cleared before each test run.</p> <p>Copy <code>.env.example</code> to <code>.env</code> and update with your local values. See the Configuration section for full setup instructions.</p> <p>Tests run on GitHub Actions use environment variables set in the CI workflow and a hosted PostgreSQL test database.</p> <p>To run these from within the virtual environment use the <code>pytest</code> command:</p> <pre><code>$ pytest\nTest session starts (platform: linux, Python 3.11.3, pytest 7.3.1, pytest-sugar 0.9.7)\nUsing --randomly-seed=2090593217\n\n...\n\n tests/integration/test_protected_user_routes.py \u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\n tests/integration/test_user_routes.py \u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\n\n...\n\n\n------------------------------------------------------------\nTOTAL                            518     10    98%\nCoverage HTML written to dir htmlcov\n\n\nResults (36.04s):\n     161 passed\n</code></pre> <p>if you wish to disable the coverage display temporarily use :</p> <pre><code>$ pytest --no-cov\n</code></pre> <p>You can also run the Unit or Integration tests independently using <code>pytest -m unit</code> or <code>pytest -m integration</code>.</p> <p>See the Pytest how-tos for more information</p>"},{"location":"reference/api/","title":"API Reference","text":"<p>This page documents all the API endpoints available in the FastAPI template.</p>"},{"location":"reference/api/#authentication-endpoints","title":"Authentication Endpoints","text":"<p>All authentication endpoints are available under the root path <code>/</code>.</p>"},{"location":"reference/api/#register-a-new-user","title":"Register a New User","text":"<p>Endpoint: <code>POST /register/</code></p> <p>Creates a new user account and returns JWT and refresh tokens.</p> <p>Request Body:</p> <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\"\n}\n</code></pre> <p>Response: <code>201 Created</code></p> <pre><code>{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"refresh\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}\n</code></pre> <p>Notes:</p> <ul> <li>Email must be valid format</li> <li>Password must be at least 8 characters</li> <li>A verification email will be sent to the user's email address</li> <li>User must verify their email before accessing protected endpoints</li> <li>JWT token expires after 120 minutes</li> <li>Refresh token expires after 30 days</li> </ul>"},{"location":"reference/api/#login","title":"Login","text":"<p>Endpoint: <code>POST /login/</code></p> <p>Authenticates an existing user and returns JWT and refresh tokens.</p> <p>Request Body:</p> <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword123\"\n}\n</code></pre> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"refresh\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}\n</code></pre> <p>Error Responses:</p> <ul> <li><code>400 Bad Request</code>: Invalid credentials</li> <li><code>401 Unauthorized</code>: User is banned or not verified</li> </ul>"},{"location":"reference/api/#refresh-token","title":"Refresh Token","text":"<p>Endpoint: <code>POST /refresh/</code></p> <p>Generates a new JWT token using a valid refresh token.</p> <p>Request Body:</p> <pre><code>{\n  \"refresh\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}\n</code></pre> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}\n</code></pre> <p>Token Validation:</p> <ul> <li>Maximum token length: 1024 characters</li> <li>Tokens must be valid JWT format (three dot-separated base64url parts)</li> <li>Empty tokens are rejected</li> <li>Malformed tokens are rejected before cryptographic verification</li> </ul> <p>Security Features:</p> <ul> <li>Format Validation: Fast syntactic check before expensive crypto operations</li> <li>Length Validation: Tokens exceeding 1024 chars are rejected to prevent   resource exhaustion</li> <li>Defense-in-depth: Multiple validation layers (format, length,   cryptographic signature, token type)</li> <li>Early Rejection: Invalid formats fail fast with clear error messages</li> <li>Token Verification: Tokens are cryptographically verified (JWT with HS256)</li> <li>Type Checking: Only tokens with <code>typ=\"refresh\"</code> are accepted</li> </ul> <p>Notes:</p> <ul> <li>The refresh token itself is not updated</li> <li>After 30 days, the user must login again with credentials</li> </ul>"},{"location":"reference/api/#verify-email","title":"Verify Email","text":"<p>Endpoint: <code>GET /verify/?code={token}</code></p> <p>Verifies a user's email address using the token sent via email.</p> <p>Query Parameters:</p> <ul> <li><code>code</code> (required): Verification token from email</li> </ul> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"detail\": \"User successfully Verified\"\n}\n</code></pre> <p>Token Validation:</p> <ul> <li>Maximum token length: 1024 characters</li> <li>Tokens must be valid JWT format (three dot-separated base64url parts)</li> <li>Empty tokens are rejected</li> <li>Malformed tokens are rejected before cryptographic verification</li> </ul> <p>Security Features:</p> <ul> <li>Format Validation: Fast syntactic check before expensive crypto operations</li> <li>Length Validation: Tokens exceeding 1024 chars are rejected to prevent   resource exhaustion</li> <li>Defense-in-depth: Multiple validation layers (format, length,   cryptographic signature, token type)</li> <li>Early Rejection: Invalid formats fail fast with clear error messages</li> <li>Token Verification: Tokens are cryptographically verified (JWT with HS256)</li> <li>Type Checking: Only tokens with <code>typ=\"verify\"</code> are accepted</li> <li>URL Parameter Safety: Validation occurs before processing URL parameters</li> </ul> <p>Error Responses:</p> <ul> <li><code>401 Unauthorized</code>: Invalid, expired, or already used token, or malformed JWT</li> <li><code>404 Not Found</code>: User not found</li> </ul>"},{"location":"reference/api/#forgot-password","title":"Forgot Password","text":"<p>Endpoint: <code>POST /forgot-password/</code></p> <p>Initiates a password reset by sending a reset email to the user.</p> <p>Request Body:</p> <pre><code>{\n  \"email\": \"user@example.com\"\n}\n</code></pre> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"message\": \"Password reset email sent if user exists\"\n}\n</code></pre> <p>Notes:</p> <ul> <li>Always returns success to prevent email enumeration attacks</li> <li>If email exists and user is not banned, a reset email is sent</li> <li>Reset token expires after 30 minutes</li> <li>Banned users will not receive reset emails</li> </ul> <p>Security Features:</p> <ul> <li>Email enumeration protection (always returns same response)</li> <li>Time-limited tokens (30 minute expiry)</li> <li>Banned users cannot reset passwords</li> </ul>"},{"location":"reference/api/#reset-password-form","title":"Reset Password Form","text":"<p>Endpoint: <code>GET /reset-password/?code={token}</code></p> <p>Displays an HTML form for resetting password OR redirects to a custom frontend. This is the endpoint linked in password reset emails.</p> <p>Query Parameters:</p> <ul> <li><code>code</code> (required): Password reset token from email</li> </ul> <p>Response:</p> <ul> <li><code>302 Redirect</code> (if <code>FRONTEND_URL</code> is configured) - Redirects to   <code>{FRONTEND_URL}/reset-password?code={token}</code></li> <li><code>200 OK</code> (HTML) (if <code>FRONTEND_URL</code> is not set) - Shows built-in password reset   form</li> </ul> <p>Built-in Form Behavior (no FRONTEND_URL):</p> <p>Returns an HTML page with:</p> <ul> <li>Password reset form (if token is valid)</li> <li>Error message (if token is invalid/expired)</li> </ul> <p>Error Messages:</p> <ul> <li>\"Reset code is required\" - No token provided</li> <li>\"That token is Invalid\" - Invalid token or banned user</li> <li>\"That token has Expired\" - Token expired (30 minutes)</li> </ul> <p>Token Validation:</p> <ul> <li>Maximum token length: 1024 characters</li> <li>Tokens exceeding this limit will be rejected and show an error</li> <li>Empty tokens are rejected</li> <li>Invalid or malformed tokens show appropriate error messages</li> </ul> <p>Security Features:</p> <ul> <li>URL Encoding: Reset tokens are URL-encoded before redirect to prevent   injection attacks</li> <li>Length Validation: Tokens are validated for reasonable size to prevent   resource exhaustion</li> <li>Redirect Safety: When <code>FRONTEND_URL</code> is set, redirects only go to the   configured domain with validated tokens</li> <li>Token Verification: Tokens are cryptographically verified (JWT with HS256)</li> <li>Expiration: Reset tokens expire after 30 minutes</li> </ul> <p>Notes:</p> <ul> <li>With custom frontend: Set <code>FRONTEND_URL</code> in settings/env to redirect users   to your app</li> <li>Without custom frontend: Leave <code>FRONTEND_URL</code> unset to use built-in form</li> <li>Validates token before displaying the form (when using built-in form)</li> <li>Form submits to <code>POST /reset-password/</code></li> <li>Provides seamless integration with custom frontends while maintaining   standalone functionality</li> </ul> <p>Configuration:</p> <p>To use with a custom frontend, set in <code>.env</code>:</p> <pre><code>FRONTEND_URL=https://app.example.com\n</code></pre> <p>Your frontend should:</p> <ol> <li>Handle the route <code>/reset-password</code></li> <li>Extract the <code>code</code> query parameter</li> <li>Display a custom password reset form</li> <li>POST to backend <code>/reset-password/</code> with JSON: <code>{\"code\": \"...\",    \"new_password\": \"...\"}</code></li> </ol>"},{"location":"reference/api/#reset-password-api","title":"Reset Password (API)","text":"<p>Endpoint: <code>POST /reset-password/</code></p> <p>Resets a user's password using the token received via email. Accepts both JSON (for API clients) and form data (from HTML form).</p> <p>Request Body (JSON):</p> <pre><code>{\n  \"code\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"new_password\": \"mynewsecurepassword456\"\n}\n</code></pre> <p>Request Body (Form Data):</p> <pre><code>code=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\nnew_password=mynewsecurepassword456\n</code></pre> <p>Response (JSON): <code>200 OK</code></p> <pre><code>{\n  \"message\": \"Password successfully reset\"\n}\n</code></pre> <p>Response (HTML): <code>200 OK</code></p> <p>Returns an HTML success page when using form data submission.</p> <p>Validation:</p> <ul> <li>New password must be at least 8 characters</li> </ul> <p>Error Responses:</p> <ul> <li><code>401 Unauthorized</code>: Invalid, expired, or wrong token type</li> <li><code>401 Unauthorized</code>: User is banned</li> <li><code>404 Not Found</code>: User not found</li> <li><code>422 Validation Error</code>: Password too short or invalid request data</li> </ul> <p>Notes:</p> <ul> <li>Token must be of type \"reset\" (verification tokens won't work)</li> <li>Banned users cannot reset their password</li> <li>After successful reset, users can login with the new password</li> <li>JSON requests return JSON responses</li> <li>Form data requests return HTML pages</li> </ul>"},{"location":"reference/api/#user-management-endpoints","title":"User Management Endpoints","text":""},{"location":"reference/api/#get-current-user","title":"Get Current User","text":"<p>Endpoint: <code>GET /users/me</code></p> <p>Authentication: Required (JWT or API Key)</p> <p>Returns the currently authenticated user's information.</p> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"email\": \"user@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\"\n}\n</code></pre> <p>Notes:</p> <ul> <li>Non-admin users only see their own basic information</li> <li>Admin users can use <code>/users/</code> to see full details</li> </ul>"},{"location":"reference/api/#get-users","title":"Get User(s)","text":"<p>Endpoint: <code>GET /users/</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Get all users or a specific user by their ID.</p> <p>Query Parameters:</p> <ul> <li><code>user_id</code> (optional): Specific user ID to retrieve</li> </ul> <p>Response: <code>200 OK</code></p> <pre><code>[\n  {\n    \"id\": 1,\n    \"email\": \"user@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"role\": \"user\",\n    \"banned\": false,\n    \"verified\": true\n  }\n]\n</code></pre> <p>Notes:</p> <ul> <li>If <code>user_id</code> is omitted, returns all users</li> <li>If <code>user_id</code> is provided, returns single user object (not array)</li> </ul>"},{"location":"reference/api/#search-users","title":"Search Users","text":"<p>Endpoint: <code>GET /users/search</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Search for users with various criteria.</p> <p>Query Parameters:</p> <ul> <li><code>search_term</code> (required): Search query string</li> <li><code>field</code> (optional): Field to search (\"all\", \"email\", \"first_name\",   \"last_name\") - default: \"all\"</li> <li><code>exact_match</code> (optional): Use exact matching instead of partial - default: false</li> <li><code>page</code> (optional): Page number (min: 1, default: 1)</li> <li><code>size</code> (optional): Items per page (min: 1, max: 100, default: 50)</li> </ul> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"items\": [\n    {\n      \"id\": 1,\n      \"email\": \"user@example.com\",\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\",\n      \"role\": \"user\",\n      \"banned\": false,\n      \"verified\": true\n    }\n  ],\n  \"total\": 25,\n  \"page\": 1,\n  \"size\": 50,\n  \"pages\": 1\n}\n</code></pre>"},{"location":"reference/api/#edit-user","title":"Edit User","text":"<p>Endpoint: <code>PUT /users/{user_id}</code></p> <p>Authentication: Required (User or Admin)</p> <p>Update the specified user's data.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of user to edit</li> </ul> <p>Request Body:</p> <pre><code>{\n  \"email\": \"newemail@example.com\",\n  \"password\": \"newpassword123\",\n  \"first_name\": \"Jane\",\n  \"last_name\": \"Smith\"\n}\n</code></pre> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"email\": \"newemail@example.com\",\n  \"first_name\": \"Jane\",\n  \"last_name\": \"Smith\"\n}\n</code></pre> <p>Notes:</p> <ul> <li>Users can edit their own profile</li> <li>Admins can edit any user's profile</li> </ul>"},{"location":"reference/api/#change-user-password","title":"Change User Password","text":"<p>Endpoint: <code>POST /users/{user_id}/password</code></p> <p>Authentication: Required (User or Admin)</p> <p>Change the password for the specified user.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of user whose password to change</li> </ul> <p>Request Body:</p> <pre><code>{\n  \"password\": \"mynewpassword123\"\n}\n</code></pre> <p>Response: <code>204 No Content</code></p> <p>Notes:</p> <ul> <li>Users can change their own password</li> <li>Admins can change any user's password</li> </ul>"},{"location":"reference/api/#make-user-admin","title":"Make User Admin","text":"<p>Endpoint: <code>POST /users/{user_id}/make-admin</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Grant admin role to the specified user.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of user to make admin</li> </ul> <p>Response: <code>204 No Content</code></p>"},{"location":"reference/api/#ban-user","title":"Ban User","text":"<p>Endpoint: <code>POST /users/{user_id}/ban</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Ban the specified user. Banned users cannot login or access protected routes.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of user to ban</li> </ul> <p>Response: <code>204 No Content</code></p> <p>Notes:</p> <ul> <li>Admins cannot ban themselves</li> <li>Banned users cannot reset passwords or access any authenticated endpoints</li> </ul>"},{"location":"reference/api/#unban-user","title":"Unban User","text":"<p>Endpoint: <code>POST /users/{user_id}/unban</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Remove ban from the specified user.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of user to unban</li> </ul> <p>Response: <code>204 No Content</code></p>"},{"location":"reference/api/#delete-user","title":"Delete User","text":"<p>Endpoint: <code>DELETE /users/{user_id}</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Permanently delete the specified user.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of user to delete</li> </ul> <p>Response: <code>204 No Content</code></p> <p>Error Responses:</p> <ul> <li><code>400 Bad Request</code>: Returned when attempting to delete the last admin user</li> </ul> <pre><code>{\n  \"detail\": \"Cannot delete the last admin user\"\n}\n</code></pre> <p>Notes:</p> <ul> <li>This action is permanent and cannot be undone</li> <li>All associated API keys will also be deleted</li> <li>Admin Protection: The system prevents the last admin from deleting   themselves to avoid system lockout. Admins can delete themselves only when   multiple admin users exist</li> <li>Regular users can always be deleted by admins regardless of admin count</li> </ul>"},{"location":"reference/api/#api-key-endpoints","title":"API Key Endpoints","text":""},{"location":"reference/api/#list-api-keys-own","title":"List API Keys (Own)","text":"<p>Endpoint: <code>GET /users/keys</code></p> <p>Authentication: Required (JWT or API Key)</p> <p>Returns all API keys for the authenticated user.</p> <p>Response: <code>200 OK</code></p> <pre><code>[\n  {\n    \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"name\": \"My API Key\",\n    \"created_at\": \"2024-01-01T12:00:00Z\",\n    \"is_active\": true,\n    \"scopes\": [\"read\", \"write\"]\n  }\n]\n</code></pre> <p>Note: The actual key value is never returned after creation.</p>"},{"location":"reference/api/#create-api-key","title":"Create API Key","text":"<p>Endpoint: <code>POST /users/keys</code></p> <p>Authentication: Required (JWT or API Key)</p> <p>Creates a new API key for the authenticated user.</p> <p>Request Body:</p> <pre><code>{\n  \"name\": \"My API Key\",\n  \"scopes\": [\"read\", \"write\"]\n}\n</code></pre> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"name\": \"My API Key\",\n  \"key\": \"pk_abcdef123456...\",\n  \"created_at\": \"2024-01-01T12:00:00Z\",\n  \"is_active\": true,\n  \"scopes\": [\"read\", \"write\"]\n}\n</code></pre> <p>Important:</p> <ul> <li>The <code>key</code> field is only returned once during creation</li> <li>Store it securely - it cannot be retrieved again</li> <li>Use the key in the <code>X-API-Key</code> header for authentication</li> </ul>"},{"location":"reference/api/#get-specific-api-key","title":"Get Specific API Key","text":"<p>Endpoint: <code>GET /users/keys/{key_id}</code></p> <p>Authentication: Required (JWT or API Key)</p> <p>Get details of a specific API key by ID.</p> <p>Path Parameters:</p> <ul> <li><code>key_id</code>: UUID of the API key</li> </ul> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"name\": \"My API Key\",\n  \"created_at\": \"2024-01-01T12:00:00Z\",\n  \"is_active\": true,\n  \"scopes\": [\"read\", \"write\"]\n}\n</code></pre>"},{"location":"reference/api/#update-api-key","title":"Update API Key","text":"<p>Endpoint: <code>PATCH /users/keys/{key_id}</code></p> <p>Authentication: Required (JWT or API Key)</p> <p>Update an API key's name or active status.</p> <p>Path Parameters:</p> <ul> <li><code>key_id</code>: UUID of the API key</li> </ul> <p>Request Body:</p> <pre><code>{\n  \"name\": \"Updated Key Name\",\n  \"is_active\": false\n}\n</code></pre> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"name\": \"Updated Key Name\",\n  \"created_at\": \"2024-01-01T12:00:00Z\",\n  \"is_active\": false,\n  \"scopes\": [\"read\", \"write\"]\n}\n</code></pre> <p>Notes:</p> <ul> <li>Both fields are optional in the request</li> <li>Setting <code>is_active</code> to <code>false</code> disables the key without deleting it</li> </ul>"},{"location":"reference/api/#delete-api-key","title":"Delete API Key","text":"<p>Endpoint: <code>DELETE /users/keys/{key_id}</code></p> <p>Authentication: Required (JWT or API Key)</p> <p>Permanently delete an API key.</p> <p>Path Parameters:</p> <ul> <li><code>key_id</code>: UUID of the API key</li> </ul> <p>Response: <code>204 No Content</code></p>"},{"location":"reference/api/#list-user-api-keys-admin","title":"List User API Keys (Admin)","text":"<p>Endpoint: <code>GET /users/keys/by-user/{user_id}</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>List all API keys for a specific user.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of the user</li> </ul> <p>Response: <code>200 OK</code></p> <pre><code>[\n  {\n    \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"name\": \"User's API Key\",\n    \"created_at\": \"2024-01-01T12:00:00Z\",\n    \"is_active\": true,\n    \"scopes\": [\"read\", \"write\"]\n  }\n]\n</code></pre>"},{"location":"reference/api/#update-user-api-key-admin","title":"Update User API Key (Admin)","text":"<p>Endpoint: <code>PATCH /users/keys/by-user/{user_id}/{key_id}</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Update another user's API key.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of the user</li> <li><code>key_id</code>: UUID of the API key</li> </ul> <p>Request Body:</p> <pre><code>{\n  \"name\": \"Admin Updated Name\",\n  \"is_active\": false\n}\n</code></pre> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"name\": \"Admin Updated Name\",\n  \"created_at\": \"2024-01-01T12:00:00Z\",\n  \"is_active\": false,\n  \"scopes\": [\"read\", \"write\"]\n}\n</code></pre>"},{"location":"reference/api/#delete-user-api-key-admin","title":"Delete User API Key (Admin)","text":"<p>Endpoint: <code>DELETE /users/keys/by-user/{user_id}/{key_id}</code></p> <p>Authentication: Required \u26a0\ufe0f Admin Only</p> <p>Delete another user's API key.</p> <p>Path Parameters:</p> <ul> <li><code>user_id</code>: ID of the user</li> <li><code>key_id</code>: UUID of the API key</li> </ul> <p>Response: <code>204 No Content</code></p>"},{"location":"reference/api/#health-endpoints","title":"Health Endpoints","text":""},{"location":"reference/api/#heartbeat","title":"Heartbeat","text":"<p>Endpoint: <code>GET /heartbeat</code></p> <p>Returns a minimal response to confirm the service is up.</p> <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"status\": \"ok\"\n}\n</code></pre>"},{"location":"reference/api/#metrics","title":"Metrics","text":"<p>Endpoint: <code>GET /metrics</code></p> <p>Authentication: None required</p> <p>Exposes Prometheus-compatible metrics for application observability. This endpoint is only available when metrics collection is enabled via the <code>METRICS_ENABLED</code> environment variable.</p> <p>Response: <code>200 OK</code> (text/plain; Prometheus format)</p> <pre><code># HELP api_template_http_requests_total Total number of HTTP requests\n# TYPE api_template_http_requests_total counter\napi_template_http_requests_total{handler=\"/users/\",method=\"GET\",status=\"2xx\"} 1542.0\n\n# HELP api_template_http_request_duration_highr_seconds HTTP request latency\n# TYPE api_template_http_request_duration_highr_seconds histogram\napi_template_http_request_duration_highr_seconds_bucket{handler=\"/users/\",method=\"GET\",le=\"0.01\"} 892.0\napi_template_http_request_duration_highr_seconds_bucket{handler=\"/users/\",method=\"GET\",le=\"0.025\"} 1420.0\napi_template_http_request_duration_highr_seconds_sum{handler=\"/users/\",method=\"GET\"} 18.234\napi_template_http_request_duration_highr_seconds_count{handler=\"/users/\",method=\"GET\"} 1542.0\n\n# HELP api_template_auth_failures_total Total authentication failures\n# TYPE api_template_auth_failures_total counter\napi_template_auth_failures_total{method=\"jwt\",reason=\"expired_token\"} 15.0\napi_template_auth_failures_total{method=\"jwt\",reason=\"invalid_token\"} 8.0\n\n# HELP api_template_login_attempts_total Total login attempts by status\n# TYPE api_template_login_attempts_total counter\napi_template_login_attempts_total{status=\"success\"} 892.0\napi_template_login_attempts_total{status=\"invalid_password\"} 24.0\n</code></pre> <p>Configuration:</p> <p>To enable metrics, set in your <code>.env</code> file: <pre><code>METRICS_ENABLED=true\n</code></pre></p> <p>Available Metrics:</p> <ul> <li>HTTP Performance Metrics:</li> <li><code>{api_title}_http_requests_total</code> - Total HTTP requests (counter)</li> <li><code>{api_title}_http_request_duration_highr_seconds</code> - Request latency (histogram)</li> <li><code>{api_title}_http_requests_inprogress</code> - In-flight requests (gauge)</li> <li><code>{api_title}_http_request_size_bytes</code> - Request body sizes (summary)</li> <li> <p><code>{api_title}_http_response_size_bytes</code> - Response body sizes (summary)</p> </li> <li> <p>Business Metrics:</p> </li> <li><code>{api_title}_auth_failures_total</code> - Authentication failures by reason and method</li> <li><code>{api_title}_api_key_validations_total</code> - API key validation attempts by status</li> <li><code>{api_title}_login_attempts_total</code> - Login attempts by status</li> </ul> <p>Notes:</p> <ul> <li>Metric namespace is derived from your <code>API_TITLE</code> setting (e.g., <code>api_template_</code>)</li> <li>The <code>/metrics</code> and <code>/heartbeat</code> endpoints are excluded from HTTP metrics tracking</li> <li>When disabled (<code>METRICS_ENABLED=false</code>), this endpoint returns 404 Not Found</li> <li>See Metrics and Observability for complete documentation</li> </ul>"},{"location":"reference/api/#authentication-methods","title":"Authentication Methods","text":"<p>The API supports two authentication methods:</p>"},{"location":"reference/api/#1-jwt-bearer-token","title":"1. JWT Bearer Token","text":"<p>Include the JWT token in the Authorization header:</p> <pre><code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n</code></pre> <ul> <li>Token expires after 120 minutes</li> <li>Can be refreshed using refresh token</li> <li>Obtained from <code>/register/</code> or <code>/login/</code> endpoints</li> </ul>"},{"location":"reference/api/#2-api-key","title":"2. API Key","text":"<p>Include the API key in the X-API-Key header:</p> <pre><code>X-API-Key: pk_abcdef123456...\n</code></pre> <ul> <li>Does not expire (currently)</li> <li>Can be created/revoked by users</li> <li>Multiple keys per user supported</li> </ul>"},{"location":"reference/api/#error-responses","title":"Error Responses","text":"<p>All endpoints may return the following error responses:</p>"},{"location":"reference/api/#400-bad-request","title":"400 Bad Request","text":"<p>Invalid request data or parameters.</p> <pre><code>{\n  \"detail\": \"Invalid credentials\"\n}\n</code></pre>"},{"location":"reference/api/#401-unauthorized","title":"401 Unauthorized","text":"<p>Missing or invalid authentication credentials.</p> <pre><code>{\n  \"detail\": \"That token is Invalid\"\n}\n</code></pre>"},{"location":"reference/api/#403-forbidden","title":"403 Forbidden","text":"<p>User lacks required permissions.</p> <pre><code>{\n  \"detail\": \"Not enough permissions\"\n}\n</code></pre>"},{"location":"reference/api/#404-not-found","title":"404 Not Found","text":"<p>Requested resource not found.</p> <pre><code>{\n  \"detail\": \"User not Found\"\n}\n</code></pre>"},{"location":"reference/api/#422-validation-error","title":"422 Validation Error","text":"<p>Request validation failed.</p> <pre><code>{\n  \"detail\": [\n    {\n      \"loc\": [\"body\", \"password\"],\n      \"msg\": \"ensure this value has at least 8 characters\",\n      \"type\": \"value_error.any_str.min_length\"\n    }\n  ]\n}\n</code></pre>"},{"location":"reference/api/#rate-limiting","title":"Rate Limiting","text":"<p>Currently, there is no rate limiting implemented. This is planned for a future release.</p>"},{"location":"reference/api/#interactive-documentation","title":"Interactive Documentation","text":"<p>FastAPI provides automatic interactive API documentation:</p> <ul> <li>Swagger UI: Available at <code>/docs</code></li> <li>ReDoc: Available at <code>/redoc</code></li> </ul> <p>These interfaces allow you to explore and test all API endpoints interactively.</p>"},{"location":"reference/swagger/","title":"Interactive API Docs","text":"<p>The interative API below is auto-generated from the OpenAPI specification for this API.</p> <p>Note</p> <p>There is not a real API or Database backing this, so the 'Try It Out' option is disabled. You can access a working version of this by installing the template and running the FastAPI server, then visiting the <code>/docs</code> path.</p> <p>"},{"location":"usage/add-user/","title":"Add a user to the database","text":"<p>It is possible to add Users to the database using the API itself, but you cannot create an Admin user this way, unless you already have an existing Admin user in the database.</p> <p>This template includes a command-line utility to create a new user and optionally make them Admin at the same time:</p>"},{"location":"usage/add-user/#interactively","title":"Interactively","text":"<pre><code>$ api-admin user create\n</code></pre> <p>You will be asked for the new user's email etc, and if this should be an Admin user (default is to be a standard non-admin User). These values can be added from the command line too, for automated use. See the built in help for details :</p> <pre><code>$ api-admin user create --help\n API Template configuration tool 1.5.0\n\n Usage: api-admin user create [OPTIONS]\n\n Create a new user. This can optionally be an admin user.\n Values are either taken from the command line options, or interactively for\n any that are missing.\n\n  Options\n  *  --email       -e      TEXT  The user's email address [required]\n  *  --first_name  -f      TEXT  The user's first name [required]\n  *  --last_name   -l      TEXT  The user's last name [required]\n  *  --password    -p      TEXT  The user's password [required]\n     --admin       -a            Make this user an Admin\n     --help                      Show this message and exit.\n</code></pre> <p>Note that any user added manually this way will automatically be verified (no need for the confirmation email which will not be sent anyway.)</p>"},{"location":"usage/add-user/#through-command-line-parameters","title":"Through Command-line parameters","text":"<p>You can also specify the required User parameters on the command-line. Any options that are missing will be prompted for (except for Admin, this must be physically specified if wanted) :</p> <pre><code>$ api-admin user create --email testuser@mailserver.com -f Test -l User -p s3cr3tpassw0rd\n</code></pre> <p>In the above case a normal user will be created. You can mix long-form parameters (<code>--first_name</code>) and short-form (<code>-f</code>) in the same command.</p> <p>This would be useful for automation scripts for example.</p>"},{"location":"usage/admin-panel/","title":"Administration Site","text":""},{"location":"usage/admin-panel/#overview","title":"Overview","text":"<p>There is an (optional) administration site included in this template. This is built using the sqladmin package and gives you an easy way to manage your users and API keys.</p> <p>Warning</p> <p>Only existing admin users can access the site, so they need to already exist in the database, created using the API or CLI.</p> <p>It is NOT possible to create new admin users using the admin site.</p>"},{"location":"usage/admin-panel/#enable-the-admin-site","title":"Enable the Admin Site","text":"<p>This admin panel is DISABLED BY DEFAULT and needs to be enabled by setting the <code>ADMIN_PAGES_ENABLED</code> environment variable to <code>true</code> in your <code>.env</code> file or in your environment.</p> <pre><code>ADMIN_PAGES_ENABLED=true\n</code></pre>"},{"location":"usage/admin-panel/#using-the-admin-site","title":"Using the Admin Site","text":"<p>Once enabled, you can access the admin site at <code>/admin</code> on your server. You can then log in using the username and password of an admin user:</p> <p></p> <p>You can view/edit the users and API keys in the database, choose from the sidebar:</p> <p></p> <p>This will then list the table and allow you to view, edit or delete the users or api keys.</p> <p></p>"},{"location":"usage/admin-panel/#customising-the-admin-site","title":"Customising the Admin Site","text":"<p>There are a couple of ENV variables that you can set to customise the admin site:</p> <pre><code># Admin Pages Settings\nADMIN_PAGES_ROUTE=/admin\nADMIN_PAGES_TITLE=\"API Administration\"\nADMIN_PAGES_ENCRYPTION_KEY=change_me_to_a_secret_fernet_key (optional)\nADMIN_PAGES_TIMEOUT=86400\n</code></pre> <p>The above are the defaults for the variables that wil be used if you do not set them in your environment or <code>.env</code> file.</p> <ul> <li><code>ADMIN_PAGES_ROUTE</code> - The route to access the admin site</li> <li><code>ADMIN_PAGES_TITLE</code> - The title of the admin site</li> <li><code>ADMIN_PAGES_ENCRYPTION_KEY</code> - The (OPTIONAL)key used to encrypt the session   data (see below)</li> <li><code>ADMIN_PAGES_TIMEOUT</code> - The timeout for the session data (in seconds,   defaults to 86400 seconds which is 24 hours)</li> </ul>"},{"location":"usage/admin-panel/#session-encryption","title":"Session Encryption","text":"<p>By default, the admin site uses the <code>Fernet</code> encryption method to encrypt the session data. You can set the <code>ADMIN_PAGES_ENCRYPTION_KEY</code> to a secret key to use for this encryption. If you do not set this, a random secure key will be generated for you each time the server is restarted (which will invalidate any current sessions so users just will need to log back in again).</p>"},{"location":"usage/admin-panel/#automatically-generating-a-key","title":"Automatically Generating a Key","text":"<p>To ensure that active sessions will persist after a server restart, you can generate a key using the CLI:</p> <pre><code>api-admin keys -a\n</code></pre> <p>This will generate a secure key, and optionally update the <code>.env</code> file. If you choose not to update the file, you can copy the key from the console output and paste it into the <code>.env</code> file:</p> <pre><code>ADMIN_PAGES_ENCRYPTION_KEY=your_generated_key_here\n</code></pre>"},{"location":"usage/admin-panel/#manually-generating-a-key","title":"Manually Generating a Key","text":"<p>You can also manually generate a key using the <code>Fernet</code> library in Python:</p> <pre><code>from cryptography.fernet import Fernet\nkey = Fernet.generate_key().decode()\nprint(key)\n</code></pre> <p>You can then set this key in your environment or <code>.env</code> file:</p> <pre><code>ADMIN_PAGES_ENCRYPTION_KEY=your_generated_key_here\n</code></pre>"},{"location":"usage/api-keys/","title":"API Keys","text":""},{"location":"usage/api-keys/#overview","title":"Overview","text":"<p>In version <code>0.7.0</code> we implemented API Keys. These can be created by a registered user and (currently) do not expire.</p> <p>These can be used in place of the standard JWT token for API access and are sent using the <code>X-API-Key</code> header (Not the <code>Authorization</code> header like the JWT).</p> <p>For example, to access a protected endpoint using an API Key:</p> <pre><code>curl -H \"X-API-Key: your-api-key-here\" http://localhost:8000/api/v1/protected-endpoint\n</code></pre> <p>Note</p> <p>If you send both an API Key and JWT, the JWT is used. If that is invalid or expired, authentication will fail even if the API key is valid. So, just use the one type!</p>"},{"location":"usage/api-keys/#implementation","title":"Implementation","text":"<p>To use API keys, your routes must use the new <code>get_current_user</code> dependency instead of the <code>oauth2_schema</code> dependency.</p> <p>For example, in your route:</p> <pre><code>from typing import Annotated\n\nfrom fastapi import APIRouter, Depends\nfrom app.managers.security import get_current_user\n\nrouter = APIRouter()\n\n@router.get(\"/protected-endpoint\")\nasync def protected_endpoint(current_user: Annotated[User,Depends(get_current_user)]):\n    return {\"message\": \"Hello World\"}\n</code></pre> <p>Now, you can access this route using an API Key OR a JWT token.</p>"},{"location":"usage/api-keys/#routes","title":"Routes","text":"<p>There are 5 routes for managing API Keys and are USER Specific:</p> <ol> <li>List All API Keys - <code>GET /users/keys/</code></li> <li>Create a new API Key - <code>POST /users/keys/</code></li> <li>Get a single API Key - <code>GET /users/keys/{key_id}</code></li> <li>Update a single API Key - <code>PATCH /users/keys/{key_id}</code></li> <li>Delete a single API Key - <code>DELETE /users/keys/{key_id}</code></li> </ol> <p>There are also 3 related routes that can only be accessed by an admin user:</p> <ol> <li>List API Keys for a specific user - <code>GET /users/keys/by-user/{user_id}</code></li> <li>Update another user's API key - <code>PATCH /users/keys/by-user/{user_id}/{key_id}</code></li> <li>Delete another user's API key - <code>DELETE /users/keys/by-user/{user_id}/{key_id}</code></li> </ol> <p>Danger</p> <p>The <code>POST</code> route will return the API Key in the response. This is the only time the key is shown. If you lose it, you will have to delete and create a new one. The API key is stored hashed in the database and cannot be retrieved by any means.</p> <p>I'll try to start writing more detailed documentation on these routes soon, but for now you can see how they work using the integrated Swagger UI at <code>/docs</code> in the browser. They are pretty self-evident - the update route can change the name and enable/disable the key (or both).</p>"},{"location":"usage/api-keys/#permissions","title":"Permissions","text":"<p>Currently the API keys are just blanket permissions. They can access any endpoint that a registered user can access. We will be adding more granular permissions in the future.</p>"},{"location":"usage/installation/","title":"How to Use this project","text":"<p>Contribute!</p> <p>If you make changes to the existing code, why not create a feature-branch and a Pull-Request to have it included into the Template? \ud83d\ude0a</p> <p>See Contributing for more info.</p>"},{"location":"usage/installation/#installation","title":"Installation","text":""},{"location":"usage/installation/#as-a-github-template","title":"As a GitHub template","text":"<p>Click the 'Use this template' button at the top of the Repository on GitHub. This will create a new repository in your personal GitHub account (Not a Fork) which you can then Clone and start working on.</p> <p>It is assumed that you have at least some knowledge of FastAPI to use this template, there are very good Basic and Advanced User Guides on the FastAPI website .</p>"},{"location":"usage/installation/#as-a-fork","title":"As a Fork","text":"<p>You can also fork this project as usual, which allows you to easily bring it up to date with changes and improvements as they happen. This does have the posibility of conflicts. As long as you stick to adding new models and routes but not modifying the existing base code it should be ok.</p>"},{"location":"usage/installation/#upgrading-from-a-patch-file","title":"Upgrading from a Patch file","text":"<p>In the CHANGELOG.md file, there are links to <code>Patch</code> and <code>Diff</code> files to enable you to upgrade from a previous release. These can be applied by Git and will upgrade the Template code to that release. The same warning applies as above - your changes can cause merge conflicts.</p> <p>If you were a few releases behind, you can apply the patches in ascending version order to get to the latest release.</p> <p>See git apply and git am for more information on how to apply these.</p>"},{"location":"usage/installation/#create-a-virtual-environment-and-install-dependencies","title":"Create a Virtual Environment and Install Dependencies","text":"<p>The project uses uv for managing the virtual environment and dependencies. This is a faster alternative to <code>Poetry</code> which was used previously.</p> <p>To create the virtual environment and install the dependencies, run the following command:</p> <pre><code>uv sync\n</code></pre> <p>This will create a virtual environment in the <code>.venv</code> directory and install all the dependencies from the <code>pyproject.toml</code> file.</p> <p>You can then activate the virtual environment with:</p> <pre><code>source .venv/bin/activate\n</code></pre> <p>Or on Windows:</p> <pre><code>.venv\\Scripts\\activate\n</code></pre>"},{"location":"usage/installation/#set-github-actions-secrets","title":"Set GitHub Actions Secrets","text":"<p>The only secret you need to set for the GitHub Actions is for Codacy which is used for automatic code quality checks and test coverage reports.</p>"},{"location":"usage/installation/#codacy-api-token","title":"Codacy API Token","text":"<p>To use this, you will need to set up a (free) acccount with Codacy to get your project token. You will then need to set the following secrets in your GitHub repository settings (<code>Settings -&gt; Secrets and variables</code>):</p> <ul> <li><code>CODACY_PROJECT_TOKEN</code> - Your Codacy Project Token.</li> </ul> <p>Tip</p> <p>See the next section if you don't want to use Codacy for test coverage.</p> <p>Note that this is the specific repository secrets, not in your profile settings. See the Codacy Docs for more information and how to get your repository token.</p> <p>Important</p> <p>You will need to set the <code>CODACY_PROJECT_TOKEN</code> secret in your GitHub repository settings both for <code>Actions</code> AND <code>Dependabot</code>. Set the same variable and value in both places.</p> <p>If you do not set this, the Codacy checks will fail and Dependabot will not be able to merge Pull Requests.</p>"},{"location":"usage/installation/#disable-test-coverage-reports-optional","title":"Disable Test Coverage Reports (Optional)","text":"<p>If you do not want to use Codacy for test coverage reports, you can disable the uploading of the reports by changing a variable in the <code>.github/workflows/tests.yml</code> file.</p> <p>Change the <code>SKIP_COVERAGE_UPLOAD</code> variable to <code>true</code> in the <code>env</code> section of the <code>tests</code> job. For example:</p> <pre><code>jobs:\n  test:\n    runs-on: ubuntu-latest\n    env:\n      SKIP_COVERAGE_UPLOAD: true\n    strategy:\n</code></pre> <p>To revert this, change it back to <code>false</code>.</p>"},{"location":"usage/metrics/","title":"Metrics and Observability","text":""},{"location":"usage/metrics/#overview","title":"Overview","text":"<p>The FastAPI Template provides opt-in Prometheus metrics collection for application observability. This feature allows you to monitor HTTP performance, track authentication events, and gain insights into API usage patterns.</p> <p>Metrics are exposed via the <code>/metrics</code> endpoint in Prometheus format, making them compatible with Prometheus, Grafana, and other monitoring tools.</p>"},{"location":"usage/metrics/#enabling-metrics","title":"Enabling Metrics","text":"<p>Metrics collection is disabled by default to minimize overhead. To enable:</p> <ol> <li> <p>Add to your <code>.env</code> file:    <pre><code>METRICS_ENABLED=true\n</code></pre></p> </li> <li> <p>Restart your application:    <pre><code>api-admin serve\n</code></pre></p> </li> <li> <p>Access metrics at:    <pre><code>http://localhost:8000/metrics\n</code></pre></p> </li> </ol>"},{"location":"usage/metrics/#available-metrics","title":"Available Metrics","text":"<p>All metrics are prefixed with your <code>API_TITLE</code> setting (converted to snake_case) to prevent naming collisions when running multiple services. For example, with <code>API_TITLE=\"API Template\"</code>, metrics will be prefixed as <code>api_template_</code>.</p>"},{"location":"usage/metrics/#http-performance-metrics","title":"HTTP Performance Metrics","text":"<p>These metrics track all HTTP requests except <code>/metrics</code> and <code>/heartbeat</code> endpoints:</p> <p><code>{api_title}_http_requests_total</code> Total number of HTTP requests.</p> <ul> <li>Labels: <code>method</code> (GET, POST, etc.), <code>handler</code> (route path), <code>status</code> (2xx, 4xx, etc.)</li> <li>Type: Counter</li> <li>Example: <code>api_template_http_requests_total{handler=\"/users/\",method=\"GET\",status=\"2xx\"} 1542</code></li> </ul> <p><code>{api_title}_http_request_duration_highr_seconds</code> Request latency histogram with custom buckets optimized for API response times.</p> <ul> <li>Labels: <code>method</code>, <code>handler</code></li> <li>Type: Histogram</li> <li>Buckets: 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0, 10.0 seconds</li> <li>Use for: P50, P95, P99 latency calculations</li> </ul> <p><code>{api_title}_http_requests_inprogress</code> Current number of in-flight HTTP requests.</p> <ul> <li>Labels: <code>method</code>, <code>handler</code></li> <li>Type: Gauge</li> <li>Use for: Real-time load monitoring</li> </ul> <p><code>{api_title}_http_request_size_bytes</code> Distribution of HTTP request body sizes.</p> <ul> <li>Labels: <code>method</code>, <code>handler</code></li> <li>Type: Summary</li> </ul> <p><code>{api_title}_http_response_size_bytes</code> Distribution of HTTP response body sizes.</p> <ul> <li>Labels: <code>method</code>, <code>handler</code></li> <li>Type: Summary</li> </ul>"},{"location":"usage/metrics/#business-metrics","title":"Business Metrics","text":"<p>Custom application metrics for security and operational insights:</p> <p><code>{api_title}_auth_failures_total</code> Total authentication failures.</p> <ul> <li>Labels:</li> <li><code>reason</code>: <code>expired_token</code>, <code>invalid_token</code>, <code>banned_user</code>, <code>unverified_user</code></li> <li><code>method</code>: <code>jwt</code>, <code>refresh_token</code></li> <li>Type: Counter</li> <li>Use for: Detecting brute force attacks, token abuse patterns</li> </ul> <p><code>{api_title}_api_key_validations_total</code> Total API key validation attempts.</p> <ul> <li>Labels:</li> <li><code>status</code>: <code>valid</code>, <code>invalid_format</code>, <code>not_found</code>, <code>inactive</code>, <code>user_banned</code>, <code>user_unverified</code></li> <li>Type: Counter</li> <li>Use for: Monitoring API key adoption, detecting misconfiguration</li> </ul> <p><code>{api_title}_login_attempts_total</code> Total login attempts.</p> <ul> <li>Labels:</li> <li><code>status</code>: <code>success</code>, <code>invalid_password</code>, <code>not_found</code>, <code>not_verified</code>, <code>banned</code></li> <li>Type: Counter</li> <li>Use for: Security monitoring, UX insights (high password failures may indicate UX issues)</li> </ul>"},{"location":"usage/metrics/#accessing-metrics","title":"Accessing Metrics","text":""},{"location":"usage/metrics/#via-http","title":"Via HTTP","text":"<pre><code>curl http://localhost:8000/metrics\n</code></pre> <p>Example output: <pre><code># HELP api_template_http_requests_total Total number of HTTP requests\n# TYPE api_template_http_requests_total counter\napi_template_http_requests_total{handler=\"/users/\",method=\"GET\",status=\"2xx\"} 1542.0\n\n# HELP api_template_auth_failures_total Total authentication failures by reason and method\n# TYPE api_template_auth_failures_total counter\napi_template_auth_failures_total{method=\"jwt\",reason=\"expired_token\"} 15.0\napi_template_auth_failures_total{method=\"jwt\",reason=\"invalid_token\"} 8.0\n\n# HELP api_template_login_attempts_total Total login attempts by status\n# TYPE api_template_login_attempts_total counter\napi_template_login_attempts_total{status=\"success\"} 892.0\napi_template_login_attempts_total{status=\"invalid_password\"} 24.0\n</code></pre></p>"},{"location":"usage/metrics/#via-prometheus-ui","title":"Via Prometheus UI","text":"<p>For local development and testing, the project includes a pre-configured Prometheus setup:</p> <ol> <li> <p>Navigate to the <code>prometheus-test/</code> directory:    <pre><code>cd prometheus-test/\n</code></pre></p> </li> <li> <p>Start Prometheus:    <pre><code>docker compose up\n</code></pre></p> </li> <li> <p>Access the Prometheus UI:    <pre><code>http://localhost:9090\n</code></pre></p> </li> <li> <p>Your application metrics will be automatically scraped every 15 seconds</p> </li> <li> <p>Example queries to try:    <pre><code># Request rate (per second)\nrate(api_template_http_requests_total[5m])\n\n# 95th percentile latency\nhistogram_quantile(0.95, rate(api_template_http_request_duration_highr_seconds_bucket[5m]))\n\n# Failed login attempts in last hour\nincrease(api_template_login_attempts_total{status=\"invalid_password\"}[1h])\n</code></pre></p> </li> </ol>"},{"location":"usage/metrics/#configuration","title":"Configuration","text":"<p>Metrics behavior is controlled by the <code>METRICS_ENABLED</code> environment variable:</p> <ul> <li><code>true</code> - Metrics collection enabled, <code>/metrics</code> endpoint accessible</li> <li><code>false</code> (default) - Metrics collection disabled, zero performance overhead</li> </ul>"},{"location":"usage/metrics/#metric-namespace","title":"Metric Namespace","text":"<p>The metric namespace is automatically derived from your <code>API_TITLE</code> setting:</p> <ul> <li><code>API_TITLE=\"API Template\"</code> \u2192 <code>api_template_</code></li> <li><code>API_TITLE=\"My Cool API\"</code> \u2192 <code>my_cool_api_</code></li> </ul> <p>This prevents metric name collisions when running multiple services in the same Prometheus instance.</p>"},{"location":"usage/metrics/#excluded-endpoints","title":"Excluded Endpoints","text":"<p>The following endpoints are excluded from HTTP metrics to prevent noise and recursive tracking:</p> <ul> <li><code>/metrics</code> - The metrics endpoint itself</li> <li><code>/heartbeat</code> - Health check endpoint</li> </ul>"},{"location":"usage/metrics/#performance-impact","title":"Performance Impact","text":"<ul> <li>HTTP Metrics: Minimal overhead (&lt;1ms per request) from the optimized   <code>prometheus-fastapi-instrumentator</code> library</li> <li>Business Metrics: Negligible (&lt;1\u03bcs) compared to auth operations (typically 100-300ms)</li> <li>When Disabled: Zero overhead - metrics code is not executed</li> </ul>"},{"location":"usage/metrics/#integration-examples","title":"Integration Examples","text":""},{"location":"usage/metrics/#grafana-dashboard","title":"Grafana Dashboard","text":"<p>Create a dashboard to visualize your metrics:</p> <ol> <li>Add Prometheus as a data source in Grafana</li> <li>Create panels with queries like:    <pre><code># Request rate by endpoint\nsum by(handler) (rate(api_template_http_requests_total[5m]))\n\n# Error rate\nsum(rate(api_template_http_requests_total{status=~\"4..|5..\"}[5m]))\n/ sum(rate(api_template_http_requests_total[5m]))\n</code></pre></li> </ol>"},{"location":"usage/metrics/#alerting-rules","title":"Alerting Rules","text":"<p>Example Prometheus alerting rules:</p> <pre><code>groups:\n  - name: api_template_alerts\n    rules:\n      - alert: HighErrorRate\n        expr: |\n          sum(rate(api_template_http_requests_total{status=~\"5..\"}[5m]))\n          / sum(rate(api_template_http_requests_total[5m])) &gt; 0.05\n        for: 5m\n        annotations:\n          summary: High 5xx error rate detected\n\n      - alert: AuthenticationFailureSpike\n        expr: |\n          rate(api_template_auth_failures_total[5m]) &gt; 10\n        for: 2m\n        annotations:\n          summary: Possible brute force attack detected\n</code></pre>"},{"location":"usage/metrics/#see-also","title":"See Also","text":"<ul> <li>Project Organization - Metrics module structure</li> <li>Configuration Guide - All environment variables</li> <li>Prometheus Documentation</li> </ul>"},{"location":"usage/user-control/","title":"User Control","text":"<p>It is possible to control most of the User functionality through the API as an Admin User, however it's often useful to also do it quickly from the command-line.</p> <p>Watch Out!!</p> <p>These commands don't require an Admin API User to use!</p> <p>Make sure you have a good strong password (or even better use SSH Keys) if your server can be accessed from public networks.</p>"},{"location":"usage/user-control/#add-a-user","title":"Add a User","text":"<p>This is described in the previous page. It is important to note that any user added this way will be automatically verified.</p>"},{"location":"usage/user-control/#list-all-users","title":"List All Users","text":"<p>You can list all registered users in a nice table as shown below:</p> <pre><code>$ api-admin user list\n</code></pre> <p>This will show Id, Email address, First and Last name, Role, and the Verified and Banned Status.</p> <p>Warning</p> <p>This list could be rather large and be produced slowly if you have a very popular site!</p> <p>In future versions I'll add an auto-paging facilty if the numbers are large.</p>"},{"location":"usage/user-control/#list-a-specific-user","title":"List a specific User","text":"<pre><code>$ api-admin user show 23\n</code></pre> <p>This will show the same data as above, but for only one user. You must specify the user ID.</p>"},{"location":"usage/user-control/#verify-a-specific-user","title":"Verify a specific User","text":"<p>You can verify a user as being valid from the CLI. This allows them to login without needing to use the validation email. Useful for testing or adding Users you know exist.</p> <pre><code>$ api-admin user verify 23\n</code></pre>"},{"location":"usage/user-control/#search-for-a-user","title":"Search for a user","text":"<p>You can search for users using various criteria. The search command supports partial matching by default and can search across all fields or a specific field.</p> <p>Basic search (searches all fields):</p> <pre><code>$ api-admin user search \"john\"\n</code></pre> <p>Tip</p> <p>contain spaces. For example, both <code>api-admin user search john</code> and <code>api-admin user search \"john\"</code> are valid.</p> <p>Search in a specific field:</p> <pre><code>$ api-admin user search \"john\" --field first_name\n</code></pre> <p>The available fields are:</p> <ul> <li><code>email</code></li> <li><code>first_name</code></li> <li><code>last_name</code></li> <li><code>all</code> (default)</li> </ul> <p>For exact matching, use the <code>--exact</code> flag:</p> <pre><code>$ api-admin user search \"john.doe@example.com\" --exact\n</code></pre> <p>The search results will be displayed in a table showing the user's Id, Email address, First and Last name, Role, and the Verified and Banned Status.</p>"},{"location":"usage/user-control/#ban-or-unban-a-specific-user","title":"Ban or Unban a specific User","text":"<p>Ban a User so they cannot access the API. You can also <code>unban</code> any user by adding the <code>-u</code> or <code>--unban</code> flag.</p> <pre><code>$ api-admin user ban 23\n</code></pre> <p>or to unban:</p> <pre><code>$ api-admin user ban 23 -u\n</code></pre>"},{"location":"usage/user-control/#make-a-user-an-admin-or-remove-admin-status","title":"Make a User an Admin or Remove Admin Status","text":"<p>Grant admin privileges to a user. You can also remove admin status by adding the <code>-r</code> or <code>--remove</code> flag.</p> <pre><code>$ api-admin user admin 23\n</code></pre> <p>or to remove admin status:</p> <pre><code>$ api-admin user admin 23 -r\n</code></pre>"},{"location":"usage/user-control/#delete-a-specific-user","title":"Delete a specific User","text":"<p>To remove a specific user from the API:</p> <pre><code>$ api-admin user delete 23\n</code></pre> <p>They will no longer be able to access the API, this CANNOT BE UNDONE. It's probably better to BAN a user unless you are very sure.</p> <p>Admin Protection</p> <p>The system includes safeguards to prevent you from locking yourself out of the API by removing all admin users.</p> <p>When using the API directly, the system prevents the last remaining admin user from deleting themselves.</p> <p>When using the CLI (<code>api-admin user delete</code>), the CLI prevents deletion of the last remaining admin user altogether to avoid system lockout. To delete an admin user, you must first ensure there is at least one other admin user in the system.</p>"},{"location":"usage/user-control/#seed-database-with-users-from-a-file","title":"Seed Database with Users from a File","text":"<p>You can import users from a CSV file using the <code>db seed</code> command:</p> <pre><code>$ api-admin db seed users.seed\n</code></pre> <p>This is useful for quickly populating a database with local users.</p> <p>By default, the command looks for a file named <code>users.seed</code> in the current directory, but you can specify a different file path as an argument.</p> <p>The CSV file should have a header row with the following columns:</p> <ul> <li><code>email</code> - User's email address (required)</li> <li><code>password</code> - User's password in PLAIN TEXT (required)</li> <li><code>first_name</code> - User's first name (required)</li> <li><code>last_name</code> - User's last name (required)</li> <li><code>role</code> - User's role, either 'user' or 'admin' (optional, defaults to 'user')</li> </ul> <p>Example <code>users.seed</code> file:</p> <pre><code>email,password,first_name,last_name,role\njohn.doe@example.com,SecurePassword123!,John,Doe,user\njane.smith@example.com,AnotherPassword456!,Jane,Smith,admin\nalex.wilson@example.com,StrongPassword789!,Alex,Wilson,user\n</code></pre> <p>Important</p> <p>This seed file has passwords in PLAIN TEXT and should not be added to source control, ESPECIALLY if they are stored in an external service like GitHub.</p> <p>The command will:</p> <ul> <li>Create new users from the CSV file</li> <li>Skip users with email addresses that already exist in the database</li> <li>Report any errors that occur during the import process</li> <li>Display a summary of created users, skipped duplicates, and errors</li> </ul> <p>You can use the <code>--force</code> or <code>-f</code> flag to skip the confirmation prompt:</p> <pre><code>$ api-admin db seed users.seed --force\n</code></pre> <p>All users created with this command are automatically verified and can log in immediately.</p>"},{"location":"usage/user-control/#populate-database-with-test-users","title":"Populate Database with Test Users","text":"<p>You can quickly populate your database with random test users using the <code>db populate</code> command:</p> <pre><code>$ api-admin db populate\n</code></pre> <p>This will create 5 users by default (4 regular users and 1 admin). You can specify a different number of users with the <code>--count</code> or <code>-c</code> flag:</p> <pre><code>$ api-admin db populate --count 10\n</code></pre> <p>The command will automatically create admin users based on the total count:</p> <ul> <li>1 admin per 5 users (rounded up)</li> <li>Maximum of 3 admin users</li> <li>If only 1 user is requested, it will be a regular user</li> </ul> <p>For example:</p> <ul> <li>5 users = 4 regular + 1 admin</li> <li>10 users = 8 regular + 2 admins</li> <li>20 users = 17 regular + 3 admins (maximum admins)</li> </ul> <p>All users are created with the default password <code>Password123!</code> and are automatically verified. The command generates realistic email addresses using various patterns and common email domains.</p>"},{"location":"usage/user-management/","title":"User Management","text":""},{"location":"usage/user-management/#overview","title":"Overview","text":"<p>This template provides multiple ways to manage users:</p> <ul> <li>CLI Tools - For administrative tasks via command line</li> <li>API Endpoints - For programmatic user management</li> </ul> <p>Both approaches offer full user management capabilities, but with different use cases and trade-offs.</p>"},{"location":"usage/user-management/#cli-user-management","title":"CLI User Management","text":"<p>The command-line interface provides powerful administrative tools for managing users directly on the server.</p>"},{"location":"usage/user-management/#creating-users","title":"Creating Users","text":"<p>See: Add a User for detailed instructions on creating users via CLI using the <code>api-admin user create</code> command.</p> <p>Quick example: <pre><code># Create an admin user interactively\napi-admin user create --admin\n\n# Create a regular user with all details\napi-admin user create -e user@example.com -f John -l Doe -p SecurePass123\n</code></pre></p>"},{"location":"usage/user-management/#managing-existing-users","title":"Managing Existing Users","text":"<p>See: User Control via CLI for comprehensive CLI operations including:</p> <ul> <li>Listing users - View all users in a table</li> <li>Searching users - Find users by email, name, or all fields</li> <li>Verifying users - Manually verify user email addresses</li> <li>Banning/unbanning users - Restrict or restore user access</li> <li>Making users admin - Grant or remove admin privileges</li> <li>Deleting users - Permanently remove users (with safeguards)</li> <li>Seeding from CSV - Import users from a CSV file</li> <li>Populating with test data - Generate random test users</li> </ul>"},{"location":"usage/user-management/#api-user-management","title":"API User Management","text":"<p>The REST API provides programmatic access to user management, enabling remote administration and frontend integration.</p>"},{"location":"usage/user-management/#available-endpoints","title":"Available Endpoints","text":"<p>The API provides comprehensive user management capabilities. See API Reference - User Management Endpoints for complete documentation of:</p> <ul> <li><code>GET /users/me</code> - Get current user profile</li> <li><code>GET /users/</code> - List all users (admin only)</li> <li><code>GET /users/search</code> - Search users with filters (admin only)</li> <li><code>PUT /users/{user_id}</code> - Edit user profile</li> <li><code>POST /users/{user_id}/password</code> - Change password</li> <li><code>POST /users/{user_id}/make-admin</code> - Grant admin role (admin only)</li> <li><code>POST /users/{user_id}/ban</code> - Ban user (admin only)</li> <li><code>POST /users/{user_id}/unban</code> - Unban user (admin only)</li> <li><code>DELETE /users/{user_id}</code> - Delete user (admin only)</li> </ul>"},{"location":"usage/user-management/#authentication","title":"Authentication","text":"<p>API endpoints require authentication via:</p> <ul> <li>JWT Bearer Token - Obtained from <code>/login/</code> endpoint</li> <li>API Key - Created via <code>/users/keys</code> endpoint</li> </ul> <p>See the Quick Start Guide for authentication setup.</p>"},{"location":"usage/user-management/#cli-vs-api-comparison","title":"CLI vs API Comparison","text":"Operation CLI Command API Endpoint Create user <code>api-admin user create</code> <code>POST /register/</code> List users <code>api-admin user list</code> <code>GET /users/</code> Search users <code>api-admin user search</code> <code>GET /users/search</code> Get user details <code>api-admin user show {id}</code> <code>GET /users/?user_id={id}</code> Edit user N/A (delete + recreate) <code>PUT /users/{id}</code> Change password N/A <code>POST /users/{id}/password</code> Verify user <code>api-admin user verify {id}</code> N/A (automatic via email) Make admin <code>api-admin user admin {id}</code> <code>POST /users/{id}/make-admin</code> Remove admin <code>api-admin user admin {id} -r</code> N/A Ban user <code>api-admin user ban {id}</code> <code>POST /users/{id}/ban</code> Unban user <code>api-admin user ban {id} -u</code> <code>POST /users/{id}/unban</code> Delete user <code>api-admin user delete {id}</code> <code>DELETE /users/{id}</code>"},{"location":"usage/user-management/#cli-advantages","title":"CLI Advantages","text":"<ul> <li>Quick administrative tasks - Ideal for one-off operations</li> <li>No authentication required - Direct database access</li> <li>Users automatically verified - Skip email verification step</li> <li>Batch operations - Seed from CSV, populate with test data</li> <li>Server access only - Must have shell/SSH access</li> </ul>"},{"location":"usage/user-management/#api-advantages","title":"API Advantages","text":"<ul> <li>Programmatic access - Automate user management</li> <li>Remote management - No server access required</li> <li>Frontend integration - Build admin panels and UIs</li> <li>Authentication/authorization - Role-based access control</li> <li>Distributed systems - Manage users across multiple services</li> </ul>"},{"location":"usage/user-management/#next-steps","title":"Next Steps","text":"<ul> <li>Add a User - Create your first user via CLI</li> <li>User Control via CLI - Learn all CLI user management commands</li> <li>API Reference - Explore the complete API documentation</li> <li>Quick Start Guide - Get started with the template</li> </ul>"},{"location":"usage/configuration/database/","title":"Setup the application database","text":""},{"location":"usage/configuration/database/#migrate-the-database","title":"Migrate the Database","text":"<p>Make sure you have configured the database. Then run the following command to set it up, applying all the required migrations:</p> <pre><code>$ api-admin db init\n</code></pre> <p>(this is the same as running <code>alembic upgrade head</code>, though it will downgrade to the base structure and delete all data as well)</p>"},{"location":"usage/configuration/database/#update-the-database-structure","title":"Update the Database structure","text":"<p>Everytime you add or edit a model, create a new migration as shown below. You will be asked for a commit message. This will create and apply the migration in the same step:</p> <pre><code>$ api-admin db revision\nEnter the commit message for the revision: Added email to the users model\n\n  Generating ..._added_email_to_the_users_model.py ...  done\n</code></pre> <p>This is the same as running the below commands, it is provided for ease of use:</p> <pre><code>alembic revision --autogenerate -m \"Commit message\"\nalembic upgrade head\n</code></pre> <p>Check out the Alembic repository for more information on how to use (for example how to revert migrations).</p>"},{"location":"usage/configuration/database/#clear-or-initialise-the-database","title":"Clear or Initialise the database","text":"<p>If you wish clear or reset the database you can do this with <code>api-admin db drop</code>. This will drop all tables and reset the database, destroying all data. Note that you will need to either run <code>api-admin db upgrade</code> or <code>api-admin db init</code> again before the database is usable.</p>"},{"location":"usage/configuration/database/#cli-options-for-the-database","title":"CLI options for the Database","text":"<p>Look at the built-in help for more details :</p> <pre><code>$ api-admin db --help\nUsage: api-admin db [OPTIONS] COMMAND [ARGS]...\n\n Control the Database.\n\nOptions:\n  --help          Show this message and exit.\n\nCommands:\n  drop            Drop all tables and reset the Database\n  init            Re-Initialise the database using Alembic.\n  revision        Create a new revision.\n  upgrade         Apply the latest Database Migrations.\n</code></pre>"},{"location":"usage/configuration/environment/","title":"Environment Variables","text":""},{"location":"usage/configuration/environment/#set-up-the-env-file","title":"Set up the <code>.env</code> file","text":"<p>Database (and other) settings can be read from environment variables or from a <code>.env</code> file in the project root. See the <code>.env.example</code> file for how to use, in fact you can just copy this file to <code>.env</code> and edit the settings as required.</p> <p>Info</p> <p>The Database (and test database if you are running the tests) and User must already exist in your Postgres system!</p> <p>Note that if you are using the Docker container, this is done automatically.</p>"},{"location":"usage/configuration/environment/#set-the-base-url","title":"Set the Base URL","text":"<p>The Base URL is the hostname and path to the ROOT of the API on your hosting system. Knowing this allows the API to build paths in responses and internally.</p> <pre><code>BASE_URL=https://api.my-server.com\n</code></pre>"},{"location":"usage/configuration/environment/#set-the-frontend-url-optional","title":"Set the Frontend URL (Optional)","text":"<p>If you have a custom frontend application (React, Vue, Angular, etc.), you can configure the API to redirect password reset requests to your frontend instead of displaying the built-in HTML form.</p> <pre><code>FRONTEND_URL=https://app.my-server.com\n</code></pre> <p>When this is set:</p> <ul> <li>Users clicking password reset links in emails will be redirected to your   frontend</li> <li>The redirect URL will be: <code>{FRONTEND_URL}/reset-password?code={token}</code></li> <li>Your frontend should handle the <code>/reset-password</code> route, extract the <code>code</code>   query parameter, and display a custom password reset form</li> <li>The form should POST to the backend API <code>/reset-password/</code> endpoint with JSON</li> </ul> <p>When not set:</p> <ul> <li>Users will see the built-in password reset form</li> <li>Works standalone without any frontend configuration</li> <li>Useful for APIs without a custom frontend</li> </ul> <p>Flexible Integration</p> <p>This setting provides the best of both worlds: standalone functionality when not configured, and seamless custom frontend integration when configured.</p>"},{"location":"usage/configuration/environment/#set-the-api-root-prefix-optional","title":"Set the API Root Prefix (Optional)","text":"<p>If you want to add a prefix to all the routes, you can set it here. This is useful if you are running multiple APIs on the same server and want to avoid route conflicts, or for versioning.</p> <pre><code>API_ROOT=/api/v1\n</code></pre> <p>This will prefix all routes with <code>/api/v1</code>, so <code>/users</code> becomes <code>/api/v1/users</code> and so on. If this is not set, the API will use the root <code>/</code> as the prefix. Do not add a trailing <code>/</code> to the prefix, though if present it will be stripped anyway.</p>"},{"location":"usage/configuration/environment/#disable-the-root-route","title":"Disable the Root Route","text":"<p>By default, the root route <code>/</code> is enabled and returns an HTML page with a welcome message if accessed through a browser or a JSON response if accessed directly. If you want to disable this, set the below variable to <code>False</code>.</p> <pre><code>NO_ROOT_ROUTE=True\n</code></pre> <p>If the variable is not set, or set to <code>False</code>, the root route will be enabled as usual. If set to <code>True</code>, the root route will return a 404 error and a JSON message.</p> <p>API Root Prefix</p> <p>This works in conjunction with the <code>API_ROOT</code> setting, so if the root route is disabled and the API Root is set to <code>/api/v1</code>, the API will return a 404 error and a JSON message when accessing <code>/api/v1</code>.</p>"},{"location":"usage/configuration/environment/#configure-the-database-settings","title":"Configure the database Settings","text":"<p>Edit the below part of the <code>.env</code> file to configure your database. If this is incorrect, the API will clear all routes and only display an error.</p> <pre><code>DB_USER=dbuser\nDB_PASSWORD=my_secret_passw0rd\nDB_ADDRESS=localhost\nDB_PORT=5432\nDB_NAME=my_database_name\n</code></pre> <p>For testing, also set the name of the test database:</p> <pre><code>TEST_DB_NAME=my_test_database_name\n</code></pre> <p>Database Setup</p> <p>The database user, and both the prod and test database must already exist, and the <code>DB_USER</code> must have the correct permissions to access them. The API will not create the database for you.</p> <p>If you don't intend to run the tests (ie running on a production server), you don't need to create the test database.</p>"},{"location":"usage/configuration/environment/#change-the-secret_key","title":"Change the SECRET_KEY","text":"<p>Do not leave this as default, generate a new unique key for each of your projects! This key is used to sign the JWT tokens and should be kept secret, and be unique for each project.</p>"},{"location":"usage/configuration/environment/#through-the-cli","title":"Through the CLI","text":"<p>You can do this by running the below command in the root of the project:</p> <pre><code>api-admin keys -s\n</code></pre> <p>This will generate a new key and optionally update the <code>.env</code> file with the new value. If you choose not to do the update automatically, you can copy the key from the console output and paste it into the <code>.env</code> file.</p> <pre><code>SECRET_KEY=d0d83c7ac2f3e4dfa205dc3c51b4952ad57fa8a842c8417168dc46bc07fbc1f8\n</code></pre>"},{"location":"usage/configuration/environment/#manually","title":"Manually","text":"<p>If you prefer to do this manually, you can generate a new key using the below commands:</p> <p>To generate a good secret key you can use the below command on Linux or Mac:</p> <pre><code>$ openssl rand -base64 32\nxtFhsNhbGOJG//TAtDNtoTxV/hVDvssC79ApNm0gs7w=\n</code></pre> <p>or a one-liner using Python:</p> <pre><code>$ python -c 'import secrets; print(secrets.token_hex(32))'\nd0d83c7ac2f3e4dfa205dc3c51b4952ad57fa8a842c8417168dc46bc07fbc1f8\n</code></pre> <p>Then replace the default value in the <code>.env</code> file as so:</p> <pre><code>SECRET_KEY=d0d83c7ac2f3e4dfa205dc3c51b4952ad57fa8a842c8417168dc46bc07fbc1f8\n</code></pre>"},{"location":"usage/configuration/environment/#token-expiry-setting","title":"Token Expiry Setting","text":"<p>This is how long (in minutes) before the access (Bearer) Token expires and needs to be refreshed. Default is 120 minutes.</p> <pre><code>ACCESS_TOKEN_EXPIRE_MINUTES=120\n</code></pre>"},{"location":"usage/configuration/environment/#check-cors-settings","title":"Check CORS Settings","text":"<p>Cross-Origin Resource Sharing (CORS) is an HTTP-header based mechanism that allows a server to indicate any origins (domain, scheme, or port) other than its own from which a browser should permit loading resources.</p> <p>For a PUBLIC API (unless its going through an API gateway!), set <code>CORS_ORIGINS=*</code>, otherwise list the domains (and ports) required. If you use an API gateway of some nature, that will probably need to be listed.</p> <pre><code>CORS_ORIGINS=*\n</code></pre> <p>If the database is not configured or cannot be reached, the Application will disable all routes, print an error to the console, and return a a 500 status code with a clear JSON message for all routes. This saves the ugly default \"Internal Server Error\" from being displayed.</p>"},{"location":"usage/configuration/environment/#change-the-email-server-settings","title":"Change the Email Server settings","text":"<p>The API will currently only send an email when a new user registers (though we will make more use of this in future), so you need to have valid email account details entered into the <code>.env</code> file.</p> <p>For development and testing, I can recommend using Mailtrap to avoid filling up your mailbox with development spam (note that the Unit/Integration tests will automatically disable the mail functionality for this reason).</p> <p>MailTrap offers a free Email capture service with a virtual web-based Inbox. Its great for developing and manually testing code that includes email sending, I can't recommend it highly enough.</p> <p>Once you have the email settings, replace the default values in the <code>.env</code> file:</p> <pre><code>MAIL_USERNAME=emailuser\nMAIL_PASSWORD=letmein\nMAIL_FROM=my_api@provider.com\nMAIL_PORT=587\nMAIL_SERVER=smtp.mailserver.com\nMAIL_FROM_NAME=\"FastAPI Template\"\n</code></pre>"},{"location":"usage/configuration/environment/#configure-admin-pages-optional","title":"Configure Admin Pages (Optional)","text":"<p>The API includes an optional admin panel for managing users and API keys through a web interface. It's disabled by default and must be explicitly enabled.</p> <p>Admin Panel Access</p> <p>Only existing admin users can access the admin panel. See the Admin Panel Documentation for details on usage and features.</p>"},{"location":"usage/configuration/environment/#enable-admin-pages","title":"Enable Admin Pages","text":"<p>Set this to <code>True</code> to enable the admin panel web interface:</p> <pre><code>ADMIN_PAGES_ENABLED=True\n</code></pre> <p>When enabled, the admin panel will be accessible at the route specified in <code>ADMIN_PAGES_ROUTE</code>. When disabled (default), the admin routes return a 404 error.</p>"},{"location":"usage/configuration/environment/#customize-admin-pages-route","title":"Customize Admin Pages Route","text":"<p>The admin panel is accessible at <code>/admin</code> by default. You can customize this:</p> <pre><code>ADMIN_PAGES_ROUTE=/admin\n</code></pre> <p>You can change this to any route you prefer, for example <code>/management</code> or <code>/dashboard</code>. The route must start with a forward slash (<code>/</code>).</p>"},{"location":"usage/configuration/environment/#customize-admin-panel-title","title":"Customize Admin Panel Title","text":"<p>The title shown in the browser tab and page header:</p> <pre><code>ADMIN_PAGES_TITLE=\"API Administration\"\n</code></pre> <p>Customize this to match your application name or branding.</p>"},{"location":"usage/configuration/environment/#session-encryption-key","title":"Session Encryption Key","text":"<p>Critical Security Setting</p> <p>This key encrypts admin session tokens. Treat it like your SECRET_KEY - keep it secret, unique per environment, never commit to version control, and regenerate if compromised.</p> <p>The encryption key for admin session tokens:</p> <pre><code>ADMIN_PAGES_ENCRYPTION_KEY=\n</code></pre> <p>Behavior:</p> <ul> <li>Empty (default): Auto-generates a new key on each server startup</li> <li>Sessions are invalidated when the server restarts</li> <li>Admins must re-login after each restart</li> <li>Fine for development</li> <li>Set with a key: Persistent sessions across server restarts</li> <li>Admins stay logged in through restarts</li> <li>Required for production</li> </ul> <p>Generate a persistent key:</p> <p>Using the CLI (recommended):</p> <pre><code>$ api-admin keys -a\n</code></pre> <p>Or manually with Python:</p> <pre><code>$ python -c 'from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())'\nbXlfc2VjcmV0X2VuY3J5cHRpb25fa2V5X2V4YW1wbGU=\n</code></pre> <p>Then add to your <code>.env</code>:</p> <pre><code>ADMIN_PAGES_ENCRYPTION_KEY=bXlfc2VjcmV0X2VuY3J5cHRpb25fa2V5X2V4YW1wbGU=\n</code></pre> <p>Production Recommendation</p> <p>Always set ADMIN_PAGES_ENCRYPTION_KEY in production to maintain persistent sessions. Use different keys for dev/staging/production environments.</p>"},{"location":"usage/configuration/environment/#session-timeout","title":"Session Timeout","text":"<p>How long (in seconds) before admin sessions expire:</p> <pre><code>ADMIN_PAGES_TIMEOUT=86400\n</code></pre> <p>Default is 86400 seconds (24 hours). Adjust based on your security requirements:</p> <ul> <li>Higher values: Better user experience, less re-authentication</li> <li>Lower values: Better security, more frequent re-authentication</li> </ul> <p>Common values:</p> <ul> <li><code>43200</code> - 12 hours</li> <li><code>86400</code> - 24 hours (default)</li> <li><code>604800</code> - 7 days</li> </ul>"},{"location":"usage/configuration/environment/#complete-admin-pages-example","title":"Complete Admin Pages Example","text":"<pre><code># Enable admin panel\nADMIN_PAGES_ENABLED=True\nADMIN_PAGES_ROUTE=/admin\nADMIN_PAGES_TITLE=\"My API Administration\"\nADMIN_PAGES_ENCRYPTION_KEY=your_generated_encryption_key_here\nADMIN_PAGES_TIMEOUT=86400\n</code></pre>"},{"location":"usage/configuration/environment/#configure-logging-optional","title":"Configure Logging (Optional)","text":"<p>The API uses loguru for structured logging with rotation, retention, and category-based filtering. Logging provides debugging, monitoring, and compliance capabilities.</p> <p>Note</p> <p>\"Console Logging\" FastAPI/Uvicorn already log to console. The file-based logging configured here is in addition to that and provides persistent, categorized logs.</p>"},{"location":"usage/configuration/environment/#log-output-directory","title":"Log Output Directory","text":"<p>Directory where log files are written:</p> <pre><code>LOG_PATH=./logs\n</code></pre> <p>Default is <code>./logs</code> (relative to project root). The directory must be writable by the application process. You can use absolute paths for production:</p> <pre><code>LOG_PATH=/var/log/myapi\n</code></pre>"},{"location":"usage/configuration/environment/#logging-level","title":"Logging Level","text":"<p>Controls which log messages are captured:</p> <pre><code>LOG_LEVEL=INFO\n</code></pre> <p>Available levels (from most to least verbose):</p> Level Description Use Case DEBUG All messages including debug output Development/troubleshooting INFO Normal operations and events Production (recommended) WARNING Issues that may need attention Production monitoring ERROR Error conditions Production (minimal) CRITICAL Severe system failures Production (minimal) <p>Higher levels include all messages from lower levels (ERROR includes CRITICAL, INFO includes WARNING/ERROR/CRITICAL, etc.).</p>"},{"location":"usage/configuration/environment/#log-file-rotation","title":"Log File Rotation","text":"<p>When to rotate (start a new) log file:</p> <pre><code>LOG_ROTATION=1 day\n</code></pre> <p>Prevents log files from growing unbounded. Supported formats:</p> <p>Size-based rotation:</p> <ul> <li><code>\"100 MB\"</code>, <code>\"500 MB\"</code>, <code>\"1 GB\"</code></li> </ul> <p>Time-based rotation:</p> <ul> <li><code>\"1 day\"</code>, <code>\"1 week\"</code>, <code>\"1 month\"</code>, <code>\"1 year\"</code></li> </ul> <p>Examples by scenario:</p> <ul> <li>High-traffic API: <code>\"100 MB\"</code> or <code>\"6 hours\"</code></li> <li>Standard API: <code>\"1 day\"</code> (default)</li> <li>Low-traffic API: <code>\"1 week\"</code></li> </ul>"},{"location":"usage/configuration/environment/#log-file-retention","title":"Log File Retention","text":"<p>How long to keep old rotated log files:</p> <pre><code>LOG_RETENTION=30 days\n</code></pre> <p>Old log files are automatically deleted after this period. Examples:</p> <ul> <li>Development: <code>\"7 days\"</code></li> <li>Production: <code>\"30 days\"</code> or <code>\"90 days\"</code></li> <li>Compliance requirements: <code>\"1 year\"</code> or more</li> </ul> <p>Balance storage costs with compliance and debugging needs.</p>"},{"location":"usage/configuration/environment/#log-file-compression","title":"Log File Compression","text":"<p>Compression format for rotated log files:</p> <pre><code>LOG_COMPRESSION=zip\n</code></pre> <p>Options:</p> <ul> <li><code>\"zip\"</code> - ZIP compression (recommended, widely compatible)</li> <li><code>\"gz\"</code> - gzip compression (smaller than zip)</li> <li><code>\"bz2\"</code> - bzip2 compression (smaller than gz, slower)</li> <li><code>\"\"</code> or omit - No compression (not recommended)</li> </ul> <p>Compression saves significant disk space for archived logs, especially with high verbosity.</p>"},{"location":"usage/configuration/environment/#logging-categories","title":"Logging Categories","text":"<p>Fine-grained control over what gets logged:</p> <pre><code>LOG_CATEGORIES=ALL\n</code></pre> <p>Special values:</p> <ul> <li><code>ALL</code> - Log everything (development/debugging)</li> <li><code>NONE</code> - Disable all logging (except critical errors)</li> </ul> <p>Individual categories (combine with commas):</p> Category What It Logs Recommended For REQUESTS HTTP request/response logging Debugging, monitoring AUTH Authentication, login, token ops Production (security) DATABASE Database CRUD operations Debugging queries EMAIL Email sending operations Production (if using email) ERRORS Error conditions and exceptions Production (always) ADMIN Admin panel operations Production (audit) API_KEYS API key operations Production (security) <p>Configuration examples:</p> <pre><code># Development: log everything\nLOG_CATEGORIES=ALL\n\n# Production: security-focused\nLOG_CATEGORIES=ERRORS,AUTH,ADMIN,EMAIL\n\n# Production: minimal logging\nLOG_CATEGORIES=ERRORS\n\n# Debugging database issues\nLOG_CATEGORIES=ERRORS,DATABASE,REQUESTS\n\n# Comprehensive monitoring\nLOG_CATEGORIES=ERRORS,AUTH,ADMIN,EMAIL,DATABASE\n\n# Disable all logging\nLOG_CATEGORIES=NONE\n</code></pre> <p>Production Recommendation</p> <p>For production, use <code>LOG_CATEGORIES=ERRORS,AUTH,ADMIN,EMAIL</code> with <code>LOG_LEVEL=INFO</code>. This provides security monitoring (AUTH/ADMIN), error tracking (ERRORS), and email operation logging (EMAIL) while keeping log files manageable.</p> <p>How combinations work:</p> <ul> <li>Comma-separated values are combined (bitwise OR)</li> <li>Order doesn't matter: <code>AUTH,ERRORS</code> = <code>ERRORS,AUTH</code></li> <li>Case-insensitive: <code>auth</code> = <code>AUTH</code></li> <li>Whitespace is trimmed: <code>AUTH, ERRORS</code> works fine</li> </ul>"},{"location":"usage/configuration/environment/#log-filename","title":"Log Filename","text":"<p>Custom filename for the log file:</p> <pre><code>LOG_FILENAME=api.log\n</code></pre> <p>Default is <code>api.log</code>. The filename cannot contain path separators (<code>/</code> or <code>\\</code>) - use <code>LOG_PATH</code> to set the directory.</p> <p>Useful for separating logs by environment:</p> <pre><code># In .env for production\nLOG_FILENAME=api.log\n\n# In test config\nLOG_FILENAME=test_api.log\n</code></pre> <p>The full log path will be: <code>{LOG_PATH}/{LOG_FILENAME}</code></p>"},{"location":"usage/configuration/environment/#console-logging","title":"Console Logging","text":"<p>Enable console output in addition to file logging:</p> <pre><code>LOG_CONSOLE_ENABLED=false\n</code></pre> <p>Duplicate Console Output</p> <p>FastAPI/Uvicorn already log to console. Setting this to <code>true</code> causes duplicate console output - each log message appears twice in the console. Only enable if you have a specific reason (e.g., custom log formatting, Docker/Kubernetes setups).</p> <p>When to use:</p> <ul> <li>\u2705 Custom log formatting requirements</li> <li>\u2705 Centralized logging systems that only capture console</li> <li>\u2705 Docker/Kubernetes environments without file access</li> </ul> <p>When NOT to use:</p> <ul> <li>\u274c Local development (already has console output)</li> <li>\u274c High-traffic APIs (performance impact)</li> <li>\u274c Default installations (causes confusion)</li> </ul>"},{"location":"usage/configuration/environment/#complete-logging-configuration-examples","title":"Complete Logging Configuration Examples","text":"<p>Development configuration:</p> <pre><code>LOG_PATH=./logs\nLOG_LEVEL=DEBUG\nLOG_ROTATION=1 day\nLOG_RETENTION=7 days\nLOG_COMPRESSION=zip\nLOG_CATEGORIES=ALL\nLOG_FILENAME=api.log\nLOG_CONSOLE_ENABLED=false\n</code></pre> <p>Production configuration (security-focused):</p> <pre><code>LOG_PATH=/var/log/myapi\nLOG_LEVEL=INFO\nLOG_ROTATION=1 day\nLOG_RETENTION=90 days\nLOG_COMPRESSION=zip\nLOG_CATEGORIES=ERRORS,AUTH,ADMIN,EMAIL\nLOG_FILENAME=api.log\nLOG_CONSOLE_ENABLED=false\n</code></pre> <p>Production configuration (minimal):</p> <pre><code>LOG_PATH=/var/log/myapi\nLOG_LEVEL=ERROR\nLOG_ROTATION=1 day\nLOG_RETENTION=30 days\nLOG_COMPRESSION=zip\nLOG_CATEGORIES=ERRORS\nLOG_FILENAME=api.log\nLOG_CONSOLE_ENABLED=false\n</code></pre>"},{"location":"usage/configuration/environment/#troubleshooting-logging","title":"Troubleshooting Logging","text":"<p>Log files not created:</p> <ul> <li>Check <code>LOG_PATH</code> directory exists and is writable</li> <li>Check file permissions on the directory</li> <li>Verify the application process has write access</li> </ul> <p>Log files filling disk:</p> <ul> <li>Adjust <code>LOG_ROTATION</code> to rotate more frequently</li> <li>Reduce <code>LOG_RETENTION</code> to delete old logs sooner</li> <li>Use <code>LOG_COMPRESSION</code> to save space</li> <li>Reduce <code>LOG_LEVEL</code> to ERROR or WARNING</li> <li>Limit <code>LOG_CATEGORIES</code> to only what you need</li> </ul> <p>Missing expected logs:</p> <ul> <li>Check <code>LOG_CATEGORIES</code> includes the category you're looking for</li> <li>Verify <code>LOG_LEVEL</code> isn't filtering out messages</li> <li>Check logs are being written to the correct file path</li> <li>Ensure the operation you're logging is actually executing</li> </ul> <p>Duplicate console output:</p> <ul> <li>Set <code>LOG_CONSOLE_ENABLED=false</code> (this is the default)</li> </ul>"},{"location":"usage/configuration/environment/#example-full-env-file","title":"Example full <code>.env</code> file","text":"<p>Below is a full .env file. This can also be found in the root of the API as <code>.env.example</code>.</p> <pre><code># The Base API Url. This is where your API wil be served from, and can be read\n# in the application code. It has no effect on the running of the applciation\n# but is an easy way to build a path for API responses. Defaults to\n# http://localhost:8000\nBASE_URL=http://localhost:8000\n\n# Optional: Frontend URL for custom frontend integration. If set, password reset\n# links will redirect to your frontend instead of showing the built-in form.\n# Leave commented/unset to use the built-in password reset form.\n# FRONTEND_URL=https://app.example.com\n\n# The root path for the API. This is the path that the API will be served from,\n#defaults to '' (empty string). If you want to serve the API from a subpath,\n# change this to the subpath, eg: /api/v1\n# API_ROOT=/api/v1\n\n# Set to True to disable the root route, and return a 404 for the root path. If\n# not set, defaults to False.\nNO_ROOT_ROUTE=False\n\n# Database Settings - REQUIRED\n# These must be changed to match your PostgreSQL setup.\n# The database must already exist before running the application.\nDB_USER=your_database_username\nDB_PASSWORD=your_secure_database_password\nDB_ADDRESS=localhost\nDB_PORT=5432\nDB_NAME=my_database_name\n\n# Database settings to use for testing. These must be changed to match your\n# setup. Note that User/Pass and Server/Port are the same as above, but the\n# database name should be different to avoid conflicts. This database needs to\n# already exist.\nTEST_DB_NAME=my_database_name_tests\n\n# JWT Secret Key - CRITICAL SECURITY SETTING\n# Generate with one of these commands:\n#   openssl rand -hex 32\n#   python -c 'import secrets; print(secrets.token_hex(32))'\n# Must be 32+ characters. DO NOT use the example below!\nSECRET_KEY=CHANGE_ME_generate_with_command_above\n\n# How long the access token is valid for, in minutes. Defaults to 120 (2 hours)\nACCESS_TOKEN_EXPIRE_MINUTES=120\n\n# List of origins that can access this API, separated by a comma, eg:\n# CORS_ORIGINS=http://localhost,https://www.gnramsay.com\n# If you want all origins to access (the default), use * or comment out:\nCORS_ORIGINS=*\n\n# Email Settings - OPTIONAL for development, REQUIRED for production\n# Set these for password reset and notification emails to work\n# Leave empty for local development (email features will be disabled)\nMAIL_USERNAME=your_smtp_username\nMAIL_PASSWORD=your_smtp_password\nMAIL_FROM=noreply@yourdomain.com\nMAIL_PORT=587\nMAIL_SERVER=smtp.yourmailprovider.com\nMAIL_FROM_NAME=\"FastAPI Template\"\n\n# Admin Pages Settings\nADMIN_PAGES_ENABLED=True\nADMIN_PAGES_ROUTE=/admin\nADMIN_PAGES_TITLE=\"API Administration\"\n# Optional: Generate with: python -c 'from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())'\n# Leave empty to auto-generate on startup (regenerates each restart)\nADMIN_PAGES_ENCRYPTION_KEY=\nADMIN_PAGES_TIMEOUT=86400\n\n# Common Email Settings\nMAIL_STARTTLS=True\nMAIL_SSL_TLS=False\nMAIL_USE_CREDENTIALS=True\nMAIL_VALIDATE_CERTS=True\n\n# Logging Configuration\n# Directory where log files will be written (must be writable by the application)\nLOG_PATH=./logs\n\n# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL\n# DEBUG shows all messages, INFO shows normal operations, WARNING and above show only issues\nLOG_LEVEL=INFO\n\n# When to rotate log files: \"500 MB\", \"1 day\", \"1 week\", etc.\nLOG_ROTATION=1 day\n\n# How long to keep old log files: \"7 days\", \"30 days\", \"1 month\", etc.\nLOG_RETENTION=30 days\n\n# Compression format for rotated logs: \"zip\", \"gz\", \"bz2\", or empty for no compression\nLOG_COMPRESSION=zip\n\n# What to log - choose one or combine with commas:\n#   ALL                    - Log everything (recommended for development/debugging)\n#   NONE                   - Disable logging\n#   REQUESTS               - HTTP request/response logging\n#   AUTH                   - Authentication, login, token operations\n#   DATABASE               - Database CRUD operations\n#   EMAIL                  - Email sending operations\n#   ERRORS                 - Error conditions (always recommended)\n#   ADMIN                  - Admin panel operations\n#   API_KEYS               - API key operations\n#\n# Examples:\n#   LOG_CATEGORIES=ALL                      # Log everything\n#   LOG_CATEGORIES=ERRORS,AUTH,DATABASE     # Only log errors, auth, and database operations\n#   LOG_CATEGORIES=REQUESTS,ERRORS          # Only log requests and errors\nLOG_CATEGORIES=ALL\n\n# Set the log filename (default: api.log)\n# Useful for separating logs in different environments (e.g., test_api.log for tests)\nLOG_FILENAME=api.log\n\n# Enable console logging (default: false)\n# Set to true if you want loguru to also log to console\n# Note: FastAPI/Uvicorn already logs to console, so this is usually not needed\n# and will cause duplicate console output\nLOG_CONSOLE_ENABLED=false\n\n# Metrics and Observability\n# Enable Prometheus metrics collection (default: false)\n# When enabled, exposes metrics at /metrics endpoint in Prometheus format\n# Includes HTTP performance metrics and custom business metrics\n# See: docs/usage/metrics.md for details\nMETRICS_ENABLED=false\n</code></pre>"},{"location":"usage/configuration/setup/","title":"Install Dependencies","text":""},{"location":"usage/configuration/setup/#set-up-a-virtual-environment","title":"Set up a Virtual Environment","text":"<p>It is always a good idea to set up dedicated Virtual Environment when you are developing a Python application. If you use <code>uv</code> or <code>Poetry</code>, this will be done automatically for you.</p> <p>Tip</p> <p>I recommend using uv for this project as that is how it has been developed. Also, <code>uv</code> can install a version of Python for you, and will automatically set up a Virtual Environment for you and install the <code>api-admin</code> command (see later)</p> <p>Otherwise, Pyenv has a virtualenv plugin which is very easy to use.</p> <p>Also, check out this freeCodeCamp tutorial or a similar RealPython one for some great info. If you are going this (oldschool!) way, I'd recommend using Virtualenv instead of the built in <code>venv</code> tool (which is a subset of this).</p>"},{"location":"usage/configuration/setup/#install-required-dependencies","title":"Install required Dependencies","text":"<p>The project has been set up using uv to organize and install dependencies. If you have <code>uv</code> installed, simply run the following to install all that is needed.</p> <pre><code>$ uv sync\n</code></pre> <p>If you do not (or cannot) have <code>uv</code> installed, I have provided an auto-generated<code>requirements.txt</code> in the project root which you can use as normal:</p> <pre><code>$ pip install -r requirements.txt\n</code></pre> <p>The above will install <code>production</code> dependencies only. If you want to install <code>development</code> dependencies as well, use the following instead:</p> <pre><code>$ pip install -r requirements-dev.txt\n</code></pre> <p>Warning</p> <p>If you are NOT using <code>uv</code>, the <code>api-admin</code> command will not be available. However, you can run the same command using the following from the project root:</p> <pre><code>$ python app/api-admin.py\n</code></pre> <p>I definately recommend using <code>uv</code> if you can though, it makes dealing with updates and conflicts very easy.</p> <p>If using <code>uv</code> or another virtual environment, you now need to activate the VirtualEnv:</p> <pre><code>$ source .venv/bin/activate\n</code></pre> <p>Under Windows, the command is slightly different:</p> <pre><code>$ .venv\\Scripts\\activate\n</code></pre>"},{"location":"usage/configuration/setup/#install-git-pre-commit-hooks","title":"Install Git Pre-Commit hooks","text":"<p>This stage is optional but recommended (however it is compulsory if you are submitting a Pull Request). It will install a git hook to run linting and sanity checks on each Git commit.</p> <pre><code>$ prek install\nprek installed at .git/hooks/pre-commit\n</code></pre> <p>This will ensure that all code meets the required linting standard before being committed.</p>"},{"location":"usage/configuration/setup/#run-the-pre-commit-hooks-manually","title":"Run the pre-commit hooks manually","text":"<p>You can run these checks manually on all files using the below command :</p> <pre><code>$ poe pre\n</code></pre> <p>This is a good sanity check to run regularly while developing.</p>"}]}